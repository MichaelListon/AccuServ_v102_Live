{"id":"e531dde6-a467-4882-a3d1-95c4c54f0a1f","version":"1.0.2","icon":"other","splash":"other","splashdata":{"img":"accuserv-splash.png","bg":"#ffffff"},"settings":{"router":{"mode":"single","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false},"wp":{"enabled":false}},"provisioning":{"enabled":false,"manifest":"","poll":2,"manual":false,"wifionly":true},"crashReporting":{"enabled":false,"androidEnabled":false,"iosEnabled":false,"splunkAndroidApiKey":"","splunkIosApiKey":"","splunkExtraData":""},"kioskMode":{"enabled":false},"loading-message":false,"logging":{"enabled":true,"bufferFrequency":100,"defaultRootLogLevel":"warn","defaultMaxFileSizeKilobyte":1000,"defaultMaxFiles":5,"appEnabled":true,"appUseDefault":true,"appRootLogLevel":"error","appMaxFileSizeKilobyte":1000,"appMaxFiles":5,"clientEnabled":true,"clientUseDefault":true,"clientRootLogLevel":"error","clientMaxFileSizeKilobyte":1000,"clientMaxFiles":5,"nativeEnabled":true,"nativeUseDefault":true,"nativeRootLogLevel":"error","nativeMaxFileSizeKilobyte":1000,"nativeMaxFiles":5},"plugins":{"builtIn":{"cordova-plugin-whitelist@1.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-battery-status@1.1.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-console@1.0.3":{"override":false,"used":true,"enabled":true},"cordova-plugin-contacts@2.1.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-device@1.1.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-device-motion@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-device-orientation@1.0.3":{"override":false,"used":false,"enabled":false},"cordova-plugin-file@4.2.0":{"override":false,"used":true,"enabled":true},"cordova-plugin-geolocation@2.2.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-globalization@1.0.3":{"override":false,"used":true,"enabled":true},"commontime-cordova-plugin-inappbrowser@1.6.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-network-information@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-splashscreen@3.2.2":{"override":true,"used":true,"enabled":false},"cordova-plugin-vibration@2.1.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-statusbar@1.0.1":{"override":false,"used":true,"enabled":true},"cordova-plugin-camera@2.3.1":{"override":true,"used":false,"enabled":true,"PHOTOLIBRARY_USAGE_DESCRIPTION":"This app would like to access your photo library.","CAMERA_USAGE_DESCRIPTION":"AccuMobile would like to use the camera."},"phonegap-plugin-barcodescanner@6.0.4":{"override":true,"used":true,"enabled":true},"com.commontime.cordova.thumbnail@1.4.8":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.fileimporter@1.0.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.beacon@1.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.notification@1.0.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.audio@0.9.10":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.media-properties@1.2.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splitscreen@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.preferences@1.0.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.authentication@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.urlhandler@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.securesettings@1.0.2":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.geofence@0.5.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-transfer@1.5.5":{"override":true,"used":false,"enabled":false},"com.commontime.cordova.public.provisioning@0.0.13":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.insomnia@0.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splunk-mint@1.0.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.kiosk@1.0.11":{"override":false,"used":false,"enabled":false},"cordova-android-movetasktoback@0.1.3":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.logging@1.0.20":{"override":false,"used":true,"enabled":true},"cordova-plugin-email-composer":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.38":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.file-opener@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.24":{"override":false,"used":true,"enabled":true},"cordova-plugin-email":{"override":true,"used":true,"enabled":false},"com.commontime.cordova.public.messaging@0.0.44":{"override":false,"used":true,"enabled":true}},"customPlugins":{}},"minimise-on-back-button":true},"language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"metadata":{"applicationkey":"accu-mobile-rr-app","googleapikey":"AIzaSyBwRT_044Cf1uL00BiGs4GMqjiIVe3cHus","accuservurl":"https://fix360.yourhousinggroup.co.uk/accuservrestv01/"},"name":"AccuServ_v102_Live","packageId":"com.internetalia.accuserv.yhglive","schemaVersion":22,"minimumStudioVersion":"3.1.0","pages":[{"start":false,"name":"AppSettings","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"ea9f4917-ceaa-4820-b353-48412681a345","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.AppSettings === undefined) {\n  cti.store.pages.AppSettings = {};\n}\n\nif(cti.store.pages.AppSettings.accuservAPIAddress === undefined) {\n  cti.store.pages.AppSettings.accuservAPIAddress = \"\";\n}\n\ncti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;"},"_auto_id_":"b042f6b5-35f1-4f76-a434-bca9b8961b6d"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"74ccf48f-7bc7-48c2-b2af-d5530007eca7","content":"<h4 class=\"title\">AccuMobile Settings</h4>","expressions":{}}],"_auto_id_":"15be7feb-567f-478e-be64-aa4f314a2ed5","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"apiQRcode","type":"capture","item-type":"qrcode","_auto_id_":"c0e8dd5d-a13a-44a5-802e-d7d947bb73e2","label":"QR Code: ","required":false,"display-value":true,"validators":[],"actions":[],"expressions":{}},{"name":"apiQRcodeSave","type":"button","item-type":"button","_auto_id_":"09e27daf-610c-47e9-b646-0d2254645b6b","content":"Save QR Code","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var code = cti.store.pages.AppSettings.apiQRcode;\nvar apis = cti.store.webService.apiUrls;\nvar exist = false;\n\nif(code) {\n  for(var i in apis) {\n    if(apis[i].value == code) {\n      exist = true;\n      break;\n    }\n  }\n\n  if(exist) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"app_odometer\",\n        \"item-type\": \"app-notification\",\n        \"style\": \"Warning\",\n        \"title\": \"Warning\",\n        \"text\": \"This Web Service URL has already been scanned to this device. Please check the list below.\"\n      }\n    );\n  } else {\n    apis.push({\"value\" : code});\n    cti.store.schema.metadata.accuservurl = code;\n    cti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;\n    cti.store.pages.AppSettings.apiQRcode = undefined;\n  } \n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning\",\n      \"text\": \"Please scan a QR Code before attempting to save.\"\n    }\n  );\n}"},"_auto_id_":"4986b521-1e37-422d-8b3a-d212f6d531fe","actions":[]}],"classes":"confirm-bar-btn"},{"name":"urlSwitch","type":"choice","item-type":"select","_auto_id_":"9966bdaf-e468-4566-be73-ef5ef742b13e","label":"Web Services:","required":false,"options":[{"label":"Option 1","value":"https://fix360.yourhousinggroup.co.uk/accuservrestv01/"},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"option-source":"$store.webService.apiUrls","label-property":"value","value-property":"value","expressions":{},"message":"This is a required field","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.store.schema.metadata.accuservurl = cti.store.pages.AppSettings.urlSwitch.value;\ncti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;"},"_auto_id_":"b01b2791-3c3a-4c75-a7be-678c95dd4872","actions":[]}],"validators":[],"group-property":""},{"name":"accuservAPIAddress","type":"user-input","item-type":"text","_auto_id_":"bd7c6f1d-ee21-4360-90ac-c9b2736b279a","label":"AccuServ API address","required":false,"multiline":false,"debounce":250,"description":"","left-icon":"fa-cloud","expressions":{"show":"0"},"modelLocationOverride":"","validators":[],"actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"b07c165a-3335-460f-b4d7-7ee7b266e6e3","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"681d14cd-8b1c-480a-b1bd-cb11339330ff","content":"Back","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"Login\" });"},"_auto_id_":"24a91646-728d-45b5-a745-0cfe40edcb9f","actions":[]}],"expressions":{},"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"0e14a0bc-03e5-4cf5-831e-a00ed6d5ca18","expressions":{}}]},{"start":false,"name":"SupportInfo","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"db05b6f2-5e82-485b-80c0-79bd7428d070","content":"<h4 class=\"title\">Support Information</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3eb89f71-655b-486d-bc88-d0a69cbf336e","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"SupportInfo","componentInstanceId":"b80156f5-e728-405a-b2a1-d3756de75fb7","function":"open"},"_auto_id_":"c2768c93-1c35-4f9a-8e5a-2730273791b2"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"b54d2053-70c0-422b-9555-066e71bf8bd0","content":"Logout","theme":"default","expressions":{"show":"$store.variables.jobStarted == false","disabled":"$store.variables.pauseTask === true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"acd777c3-1bd5-4b4c-a2dc-3ff21604e64a"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"b80156f5-e728-405a-b2a1-d3756de75fb7","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"8ca96d7e-46d7-4684-ac69-b04b87cc47c1","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_jobaccessdetail","type":"content","item-type":"html","_auto_id_":"e98c4971-c390-4cb0-a1a3-cb78b7f061a2","content":"<h4 style=\"font-weight:bold;\">Current user information</h4>\n<div>\n\t<p>Current user: {{'$store.currentProfile.username'|store}}</p>\n\t<p>Login token expires: {{'$store.variables.supportInfo.tokenExpiry'|store}}</p>\n\t<p>Session expires: {{'$store.variables.supportInfo.sessionExpiry'|store}}</p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Application information</h4>\n<div>\n\t<p>Version: {{'$store.schema.version'|store}}</p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Event history</h4>","expressions":{}},{"name":"list_eventLog","type":"content","item-type":"list","_auto_id_":"fce89f14-b343-41aa-9f96-cd444990fe39","search":"","classes":"","model":"$store.log","actions":[],"expressions":{},"theme":"bootstrap","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_eventLog_html","_auto_id_":"3985ab9b-7a39-4e7a-88da-af9c7d235e91","content":"<div class=\"list-item-container\">\n  <div class=\"list-item-head\">{{$data.$item.time}} <span class=\"log-{{$data.$item.type}}\"><b>{{$data.$item.type}}</b></span></div>\n  <div class=\"list-item-detail\">{{$data.$item.message}}</div>\n</div>"}],"pagination":true,"paginationItemsPerPage":10,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationFirstLast":false,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":5},{"name":"html_hardreset","type":"content","item-type":"html","_auto_id_":"c6b27e52-7065-4670-ad6c-92e6561fe82a","content":"<hr>\n<h4 style=\"font-weight:bold;\">Reset Application</h4>\n<p>If you have encounted a serious error with the application, or are experiencing issues that are blocking you from progressing through the Job or the app, please take a screenshot of the above log stream and select the <span style=\"color:blue\">Reset</span> button below.</p>\n<p><span style=\"color:red\"><strong>WARNING:</strong></span> Once you have selected the <span style=\"color:blue\">Reset</span> option, you will lose any data you currently have on device related to the current Job.</p>","expressions":{}},{"name":"btnReset","type":"button","item-type":"button","_auto_id_":"38320148-6444-4838-bb8e-9619b0f047eb","content":"RESET","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"b845d86a-8d8e-4d76-a189-f96e5511e119"}],"classes":"deletephoto-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"1efb4de1-db93-473a-b568-8b2b355d6372","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"ce841f1c-2423-4668-b2c1-cf405a62773b","content":"Back","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.supportInfo;\ncti.utils.callAction('go-to-page', { \"name\": cti.store.variables.supportInfoLastPage });"},"_auto_id_":"8c19da4b-90cd-4413-af80-da7e85e8db26","actions":[]}],"expressions":{},"classes":"button-bar-btn"},{"name":"clear_btn","type":"button","item-type":"button","_auto_id_":"908a9b64-3252-4dde-8084-bbc420f6bf7a","content":"Clear Logs","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.clear();\ncti.store.log = [];\ncti.utils.updatePage();"},"_auto_id_":"0bf90c5d-b277-46cc-8c46-c93f1aacfc4c","actions":[]}],"expressions":{},"classes":"deletephoto-btn"}],"expressions":{}}],"_auto_id_":"b391b6bf-a61d-44d9-905d-a565c36510c2"}]},{"start":false,"name":"PauseTask","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"3b8da5dc-6249-4e34-a915-aad726dd9d85","content":"<h4 class=\"title\">Pause Task</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"a3c8a077-b540-4e0a-ae19-fe9fb74e5e30","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobSummary","componentInstanceId":"8d90cb58-e520-45ee-a2b4-c0cd80d61a7f","function":"open"},"_auto_id_":"3f55575c-48b8-4138-bc6e-b8cc9030fed6"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"64b315f9-3be1-4937-914e-39f208893b0c","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"814a28c5-fc8c-42bb-bd56-1be1bdc2c0c0"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"e5e89e85-b4b7-4b78-ba3a-fb0ddbb476ec","content":"Job List","theme":"default","expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"471ad90d-6ce1-43ef-84ae-485587e3d854"}],"left-icon":"fa-list"},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"5759d230-51e9-4d71-adc0-b1c31eb7afe9","content":"Logout","theme":"default","expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"ea63e62e-b6fc-46a8-8ef6-7a0463addea2"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"ac30798e-d588-4eee-826d-6ce93b7c8703","attributes":{},"expressions":{}}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"8d90cb58-e520-45ee-a2b4-c0cd80d61a7f","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"1eb72501-7bf9-443c-a706-453b8ec8dfd9","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"pauseTaskInfo","type":"content","item-type":"html","_auto_id_":"6df38217-f250-4a0e-b6d7-4df521004ceb","content":"<p>Please select the Pause Task button below if you would like to record Non-Productive time (i.e. lunch break)</p>","expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"}},{"name":"activityCategory","type":"choice","item-type":"select","_auto_id_":"1685a1c2-1a73-40b1-8f62-302aeb708cbe","label":"Activity Category:","required":true,"options":[{"label":"BREAK","value":"BREAK"}],"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field"},{"name":"activityType","type":"choice","item-type":"select","_auto_id_":"2af03d18-d3fe-413a-a3f8-585ad7ca8df5","label":"Activity Type:","required":true,"options":[{"label":"LUNCH","value":"LUNCH"}],"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field"},{"name":"activityDuration","type":"choice","item-type":"select","_auto_id_":"d2f5ec6b-1f7f-4c15-aa4a-a640271e9879","label":"Estimated Duration:","required":true,"options":[{"label":"00:15","value":"15"},{"label":"00:30","value":"30"},{"label":"00:45","value":"45"},{"label":"01:00","value":"60"},{"label":"01:15","value":"75"},{"label":"01:30","value":"90"},{"label":"01:45","value":"105"},{"label":"02:00","value":"120"}],"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field","actions":[]},{"name":"operativeComments","type":"user-input","item-type":"text","_auto_id_":"eb27f2ad-c9ac-4a38-954b-f38ab3025495","label":"Operative Comments:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field"},{"name":"pauseTask","type":"button","item-type":"button","_auto_id_":"69090794-f83f-42d3-81fe-316738227321","content":"Pause Task","theme":"default","expressions":{"disabled":"$form.invalid","show":"$store.payloads.pauseTask.bPauseTask != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.pauseTask = true;\ncti.store.payloads.pauseTask = {\n  \"bPauseTask\" : true,\n  \"dtPauseDateTime\" : moment().locale('en').format('HH:MM DD-MM-YYYY'),\n  \"dtEndDateTime\" : \"\",\n  \"sActivityCategory\" : cti.store.pages.PauseTask.activityCategory.value,\n  \"sActivityType\" : cti.store.pages.PauseTask.activityType.value,\n  \"tEstimatedTime\" : cti.store.pages.PauseTask.activityDuration.value,\n  \"sComments\" : cti.store.pages.PauseTask.operativeComments\n};\n\n// TODO - Send on break message\ncti.utils.updatePage();"},"_auto_id_":"25e37402-79c0-468b-8f8e-3617153e3460"}],"classes":"getmethere-btn"},{"name":"onPause","type":"content","item-type":"html","_auto_id_":"b8088957-64df-4758-b323-3bfb936b5114","content":"<div class=\"pauseicon\">\n\t<i class=\"fa fa-coffee\"></i>\n</div>\n<h4 class=\"pauseheader\">You are currently on {{'$store.payloads.pauseTask.sActivityType'|store}}</h4>\n<p style=\"text-align:center\">Time {{'$store.payloads.pauseTask.sActivityType'|store}} Started: <span style=\"color:#0072C6\">{{'$store.payloads.pauseTask.dtPauseDateTime'|store}}</span></p>\n<p style=\"text-align:center\">Estimated Duration: <span style=\"color:#0072C6\">{{'$store.payloads.pauseTask.tEstimatedTime'|store}} minutes</span></p>\n<p style=\"text-align:center\">Comments: <span style=\"color:#0072C6\">{{'$store.payloads.pauseTask.sComments'|store}}</span></p>\n<hr>","expressions":{"show":"$store.payloads.pauseTask.bPauseTask == true"}},{"name":"endTask","type":"button","item-type":"button","_auto_id_":"455259b0-ca12-4ed3-a13a-29a4afdfcae1","content":"End Task","theme":"default","expressions":{"show":"$store.payloads.pauseTask.bPauseTask == true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var endTask = {\n  \"bPauseTask\" : false,\n  \"dtPauseDateTime\" : cti.store.payloads.pauseTask.dtPauseDateTime,\n  \"dtEndDateTime\" : moment().locale('en').format('HH:MM DD-MM-YYYY'),\n  \"sActivityCategory\" : cti.store.payloads.pauseTask.sActivityCategory,\n  \"sActivityType\" : cti.store.payloads.pauseTask.sActivityType,\n  \"tEstimatedTime\" : cti.store.payloads.pauseTask.tEstimatedTime,\n  \"sComments\" : cti.store.payloads.pauseTask.sComments\n};\n  \ncti.store.payloads.pauseTask = endTask;\ndelete cti.store.variables.pauseTask;\n\ncti.utils.destroyPageData('PauseTask');\n\n// TODO - Send off break message\ndelete cti.store.payloads.pauseTask;\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"12e01378-6453-4c7c-80d4-e66ef8016e44"}],"classes":"getmethere-btn"}],"_auto_id_":"aab815b9-84ba-4695-9342-9603db8da414"}]},{"start":false,"name":"PhotoDetail","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"4faf97c0-41bb-4693-bff1-38ff3f1507d1","content":"<h4 class=\"title\">Edit Photo Detail</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"f06812c9-e934-4041-a8c7-4dd04ce2aee7","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"PhotoDetail","componentInstanceId":"c21c91f7-d865-48ea-b460-7398a8104970","function":"open"},"_auto_id_":"c0ac1c79-3adc-4ade-b118-8bd822eb1f79"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bccb2add-699c-4675-b816-27016256bd18","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"0b3a461b-dd25-4e3a-94c0-ee6df726834d"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"f186bd8d-ccc6-4edd-b8bc-ca20094e97c8","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"36703178-a0dc-4f23-9f17-7aaefd194e3a"}],"left-icon":"fa-list"},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"ae244d9c-abd4-4826-a14c-c5f8698f314a","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"d11eae06-4553-41b2-8397-3aeef64c18b3"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"c21c91f7-d865-48ea-b460-7398a8104970","attributes":{},"expressions":{}}],"_auto_id_":"67b1ba3e-79c5-488f-9642-ea6000777a7d","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"a3813843-2b05-4e25-a5c7-c9fc9111966d","attributes":{},"expressions":{}},{"name":"htmlPhotoDetail","type":"content","item-type":"html","_auto_id_":"0d6a5d8b-e490-48da-9d76-8bc7b143962b","content":"<h4 style=\"font-weight:bold;\">Current user information</h4>\n<div>\n\t<p>Photo taken: {{'$store.variables.selectedPhoto.date'|store}}</p>\n\t<p>Category: {{'$store.variables.selectedPhoto.category'|store}}</p>\n\t<p>Internal ID: {{'$store.variables.selectedPhoto.id'|store}}</p>\n</div>\n<hr>\n","expressions":{}},{"name":"Description","type":"user-input","item-type":"text","_auto_id_":"b66cb409-b2d1-428e-b0f7-2c08c474e929","label":"Description","required":false,"multiline":true,"debounce":250,"placeholder":"add any notes you have for this photo","maxlength":200,"validators":[],"actions":[],"expressions":{}},{"name":"htmlImage","type":"content","item-type":"html","_auto_id_":"b1961303-936a-4859-9409-b82c455c4d7e","content":"<h4 style=\"font-weight:bold;\">Photo</h4>\n<div class=\"photo-review-container\">\n<img class=\"photo-review\" src=\"{{'$store.variables.selectedPhoto.src'|store}}\"></img>\n</div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"ca8a6f5c-4b80-446b-9007-74b4cc24c150","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnDeletePhoto","type":"button","item-type":"button","_auto_id_":"fce69563-c80c-493d-805b-fbf444804142","content":"Delete photo","theme":"default","left-icon":"fa-trash","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Deleting Photo...');\ncti.fnDeleteSelectedPhoto();"},"_auto_id_":"6beedca4-fbd9-4c11-b6a6-098d337f54c6"}],"classes":"deletephoto-btn"},{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"8266f642-e417-4377-883b-c88b5785cbdf","content":"Save","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if (cti.store.pages.PhotoDetail !== undefined && cti.store.pages.PhotoDetail.Description !== undefined) {\n  for (var k in cti.store.variables.selectedPhotoList) {\n    if (cti.store.variables.selectedPhotoList[k].id == cti.store.variables.selectedPhoto.id) {\n      cti.store.variables.selectedPhotoList[k].description = cti.store.pages.PhotoDetail.Description;\n      break;\n    }\n  }\n\n  delete cti.store.pages.PhotoDetail.Description;\n}\n\ncti.store.variables.fromPhotoDetail = true;\n\nvar lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastPhotoDetailPage));\ncti.utils.callAction(\"go-to-page\", { \"name\" : lastPage });\ndelete cti.store.variables.lastPhotoDetailPage;"},"_auto_id_":"d015e2b8-c10e-468f-8eb5-b33646eafc89"}],"expressions":{},"classes":"confirm-bar-btn"}],"expressions":{}}],"_auto_id_":"332dd5fb-8b67-4a4b-afa3-661334f59f40"}]},{"start":false,"name":"JobMap","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"ca7b259d-2a2e-43eb-b601-be088e9d4bae","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(typeof google === 'object' && typeof google.maps === 'object') {\n  window.appManager.logEvent('Google Maps API initialised.', 'info');\n} else {\n  window.appManager.logEvent('Google Maps API not loaded, initialising...', 'info');\n  var googleMaps = document.createElement('script');\n  googleMaps.id = 'google';\n  googleMaps.src = 'https://maps.googleapis.com/maps/api/js?key=' + cti.store.schema.metadata.googleapikey;\n  document.body.appendChild(googleMaps);\n  window.appManager.logEvent('Google Maps API initialised successfully.', 'info');\n}\n\n$success();"},"_auto_id_":"4153b7c9-ce0c-497f-8c19-be12884c248e","actions":[{"event":"success","type":"start-timer","data":{"name":"tmFetchMapData"},"_auto_id_":"3aba0419-1ede-4b4f-a693-a88cafd43747"}]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"6839e908-fd3e-4e1b-8dfd-d82484bdbd42","content":"<h4 class=\"title\">Job Map</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"5043a972-5171-4cc7-a04e-0cabb219bb30","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobMap","componentInstanceId":"805709d7-a18c-4b26-bd3d-503f530307dd","function":"open"},"_auto_id_":"1e4c4a35-9010-49e3-a090-1f45f057873a"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"fd90a757-274c-4d9c-b651-7475a494aa58","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"b94a4d6c-73d5-4bab-8a61-298bb24698d6"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"ecb62534-c052-4689-bf78-7262f4d239c1","content":"Job List","theme":"default","expressions":{"show":"$store.variables.jobStarted == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"a0cd961b-bd37-4d14-9e57-0cbbdef170ac"}],"left-icon":"fa-list"},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"20007b03-a2a4-42bd-898c-ff0a5af388ca","content":"Logout","theme":"default","expressions":{"show":"$store.variables.jobStarted == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"dcf3e5a4-162e-4c4e-ab36-b96064f13b46"}],"left-icon":"fa-sign-out"}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"805709d7-a18c-4b26-bd3d-503f530307dd","attributes":{},"expressions":{}}],"_auto_id_":"743aa177-212f-4683-a670-40935ed26224","expressions":{},"classes":""},{"name":"staticMap","type":"area","item-type":"static","_auto_id_":"3619ce97-b1e5-44fb-a5e0-5b2abba228b0","content":[{"name":"html_map","type":"content","item-type":"html","_auto_id_":"be6e1442-ec49-47da-8bc4-5299c2410a4c","content":"<div id=\"map\"></div>","expressions":{}}],"expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"1bdbbbab-9a85-4897-9330-e10e7038e64d","content":[{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"cc520891-6922-4b87-9099-d23178968e1a","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"00a55b29-ae27-4937-ac05-8f22cf25816a","content":"Back","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobs = [];\ncti.store.variables.showFullJobs = false;\n\nfor(var i in cti.store.jobs.jobListShort) {\n  if(i == \"0\" || i == \"1\") {\n    jobs.push(cti.store.jobs.jobListShort[i]);\n  }\n}\n\ncti.store.jobs.jobListShort = JSON.parse(JSON.stringify(jobs));\n\nvar lastPage = cti.store.variables.lastJobMapPage;\n\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"c03fccbc-30e2-463e-b1b2-be1bb3f0cfc4"}],"classes":"button-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobSummary","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"95979699-fffa-496e-9b4e-e43594f05b3f","content":"<h4 class=\"title\">Job Summary</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3b25945b-a8e3-4066-abb4-1a9f94a3a58d","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobSummary","componentInstanceId":"eb98358e-6473-4194-8ef3-b875ddf1e574","function":"open"},"_auto_id_":"5fefdbe0-5171-484e-8695-7694d1a21b0d"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"8f6fc3e1-e36e-4fa4-a6a1-7942d676c003","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"d3a6e483-79b1-4fac-b47c-7c5eb39c94f2"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"6a45964a-c4ed-49a9-a75f-08d35b8ab794","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"462634e1-5d94-4a0b-9683-f970c8b3a540"}],"left-icon":"fa-list"},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"892230e6-e129-4240-b757-0b3f9f32dc2e","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"c0fd4a9b-cd7b-4af3-aed6-036e05788530"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"79e02329-f7a9-4bef-b00d-1f2c12dbea55","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"bee412eb-b4ce-4a71-b5ea-670c88ebc934"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"139c2d9e-c08f-42aa-8a34-20b10dbfce25","attributes":{},"expressions":{}}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"eb98358e-6473-4194-8ef3-b875ddf1e574","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"e91910b8-6464-42b1-9722-3c8df3d2fc0a","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_jobaccessdetail","type":"content","item-type":"html","_auto_id_":"3d57da57-54a0-4bac-904a-5bd26ed5fec7","content":"<h4 style=\"font-weight:bold;\">AccuServ Job ID Details</h4>\n<div>\n\t<p>Job Number: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aAccuServJobID.sJobNo'|store}}</span></p>\n  \t<p>Client Order No: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aAccuServJobID.sOriginatorID'|store}}</span></p>\n  \t<p>Operative ID: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aOperativeDetail.sOperativeName'|store}}</span></p>\n  \t<p>Contract: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sContract'|store}}</span></p>\n  \t<p>Priority: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sPriority'|store}}</span></p>\n  \t<p>Status: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sStatus'|store}}</span></p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Tenant Details</h4>\n<div>\n\t<p>Name: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sTenant_Name'|store}}</span></p>\n\t<p>Home: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sHome_No'|store}}</span></p>\n\t<p>Mob:  <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sMobile_No'|store}}</span></p>\n  \t<p>Address: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sAddress_1'|store}}</span></p>\n\t<p>         <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sAddress_4'|store}}</span></p>\n\t<p>         <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sPostcode'|store}}</span></p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Job Detail</h4>\n<div>\n  <p>{{'$store.jobs.jobSummary.sProblemSummary'|store}} - {{'$store.jobs.jobSummary.sProblemDetail'|store}}</p>\n  <p>Expected Duration: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sExpected_Duration'|store}} minutes</span></p>\n  <p>Attend On Date/Time: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.dAttendOnDate'|store}} - {{'$store.jobs.jobSummary.iAttendOnHrs'|store}}:{{'$store.jobs.jobSummary.iAttendOnMins'|store}}</span></p>\n  <p>Appointment Slot: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sAssignedType'|store}}</span></p>\n  <p>Job Target Date/Time: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.dJobTargetDate'|store}} - {{'$store.jobs.jobSummary.iJobTargetHrs'|store}}:{{'$store.jobs.jobSummary.iJobTargetMins'|store}}</span></p>\n</div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"e0d1d281-6e54-4f44-9cd5-720a14d8376a","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"08ebb057-b61b-4520-9694-8976905dc9a9","content":"Back","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.jobSummaryLastPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });\ndelete cti.store.jobs.jobSummary;"},"_auto_id_":"444d1ed9-ca69-44bc-888e-46e72c98f364","actions":[]}],"expressions":{},"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"f4aab90f-952e-4431-aee1-f5060adb9932"}]},{"start":false,"name":"JobHistoryDetail","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"bf3eed2f-1847-4ced-a876-52a4a62ede57","content":"<h4 class=\"title\">Job: {{'$store.jobs.jobHistorySelected.jobNumber'|store}}</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"f4cb7ab5-df3c-4ee7-92d6-ea9ffc639992","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobHistoryDetail","componentInstanceId":"f3e9d0fb-01c5-4c07-b054-4239245bd397","function":"open"},"_auto_id_":"d3b90ca9-62d9-4242-894d-47da5c112f9b"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"2d0c1c9b-3a98-496d-a187-6486f45d5669","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"f924e3e4-76fc-4a52-bf4b-84ed78b468db"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"6e5b9fb2-f8e4-4d9f-b834-db254ccadc2e","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"34a43567-fa03-4fd6-8798-4dce43fd0686"}],"left-icon":"fa-list"},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"553b3c6c-38e4-44c4-bd54-230d78eb61b9","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"5cb04ee6-d570-4c81-a3ef-6ba2a1e630bd"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"16bdcea7-5ac9-4351-ac45-5d203d87e342","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"15cf3004-8baa-4763-b50d-827bf0c81dd3"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"f3e9d0fb-01c5-4c07-b054-4239245bd397","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"c521a29d-3d84-4a6e-970c-12321c63b565","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"1276c892-1767-40ac-a985-d67bebd947d8","content":[{"name":"html_jobdetails","type":"content","item-type":"html","_auto_id_":"6e906a93-846b-4604-8cfd-d93620ea4f70","content":"<h5 style=\"font-weight:bold;\">Operative</h5>\n<p>{{'$store.jobs.jobHistorySelected.operativeId'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Attend On Date</h5>\n<p>{{'$store.jobs.jobHistorySelected.attendOnDate'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Attend On Time</h5>\n<p>{{'$store.jobs.jobHistorySelected.attendOnTime'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Problem Detail</h5>\n<p>{{'$store.jobs.jobHistorySelected.problemDetail'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Result Detail</h5>\n<p>{{'$store.jobs.jobHistorySelected.resultDetail'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Access Detail</h5>\n<p>{{'$store.jobs.jobHistorySelected.accessDetail'|store}}</p>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"7f5c9f91-8b53-4f14-a4bd-142823a01f26","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"5e343e8c-dca3-4278-b5ef-676c889cb8e9","content":"Previous","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"JobHistory\" });"},"_auto_id_":"3597c714-a73f-4bc4-ab51-9e3db9fe973d"}],"classes":"button-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobHistory","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"36a92679-1aeb-4722-859f-d803f9eb56cb","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.jobHistory === undefined) {\n  cti.store.jobs.jobHistory = [];\n}\n\nif(cti.store.jobs.jobHistory.length === 0) {\n  cti.store.variables.historyData = false;\n} else {\n  cti.store.variables.historyData = true;\n}\n\ncti.utils.updatePage();"},"_auto_id_":"c27da681-29dd-414c-8ad2-7ce6d4ec9961"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"e2465277-a6f9-4c4b-bd01-87bcdefc4982","content":"<h4 class=\"title\">Job History</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"a8a3c267-ee7e-4066-a174-fe9ef48e7cb8","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobHistory","componentInstanceId":"13390535-dcb5-4721-a25c-8e6408309c69","function":"open"},"_auto_id_":"23b1b6c7-4347-4b15-8499-c9c8fee1d5e5"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"9c5cd508-6e01-4021-bded-1c7991e89cb1","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"b58a1b0b-f2ab-4006-9cb6-0786d8e19ffb"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"9b908b18-08bf-4fcb-b067-3efb4f5087f3","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"f7786d18-dbad-4d3c-ae6f-faa510c0ec24"}],"left-icon":"fa-list"},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"02c0faba-acaa-4a1b-ae6e-e8f4f21c1c43","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"98210aac-4a08-4556-acd3-7c2f9d5e17c6"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"5a7251d3-cd58-4547-a72e-03c643821b93","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"41bea5a7-9227-434d-9f9a-002c7f5fe0cc"}],"left-icon":"fa-sign-out"}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"13390535-dcb5-4721-a25c-8e6408309c69","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"5c8e5486-4cee-4136-a41c-d564cc17a55e","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"ae91e55c-f00d-4ec9-9688-dc3bdc4c2812","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"edab0934-55e3-4084-ab1f-922349f62c87","attributes":{},"expressions":{}},{"name":"html_nojobhistory","type":"content","item-type":"html","_auto_id_":"724b432b-811d-463e-9cc7-68a43807cb59","content":"<h4 class=\"centered-text\">No Results Found.</h4><p class=\"centered-text\">Currently there are no results for this Property returned. Please contact your Supervisor or re-try by tapping the below icon.</p>\n<div class=\"retry-job\" onclick=\"cti.utils.callAction('call-actionflow',{'name':'GetJobHistory'});\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.historyData === false"}},{"name":"list_jobhistory","type":"content","item-type":"list","_auto_id_":"c5d5b06e-6631-468f-a0b4-feb13c696b3f","search":"","classes":"","expressions":{"show":"$store.variables.historyData === true"},"model":"$store.jobs.jobHistory","theme":"bootstrap","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Remove previous jobHistorySelected object\ndelete cti.store.jobs.jobHistorySelected;\n\n// Package selected job\nvar jobSelected = {{$data.$item}};\n\n// Create jobHistorySelected object with selected job data\ncti.store.jobs.jobHistorySelected = {\n  \"jobNumber\" : jobSelected.aAccuServJobID.sJobNo,\n  \"operativeId\" : jobSelected.aOperativeDetail.sOperativeID + \" - \" + jobSelected.aOperativeDetail.sOperativeName,\n  \"attendOnDate\" : jobSelected.dAttendOnDate,\n  \"attendOnTime\" : jobSelected.iAttendOnHrs + \":\" + jobSelected.iAttendOnMins,\n  \"problemDetail\" : jobSelected.sProblemDetail,\n  \"resultDetail\" : jobSelected.sResultDetail,\n  \"accessDetail\" : jobSelected.sAccessDetail\n}\n\n//Navigate to history detail page\ncti.utils.callAction('go-to-page', { \"name\": \"JobHistoryDetail\" });"},"_auto_id_":"d6ffe524-021c-4c26-8918-b57cef4c4bd3"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_jobhistory_html","_auto_id_":"27c450f5-ca22-47b2-87d0-0225ad5922fe","content":"<div class=\"joblist-container\">\n  <div class=\"joblist-column-1 joblist-status\">\n    <div class=\"joblist-slot\">{{$data.$item.sAssignedType}}</div>\n    <div class=\"joblist-day\">{{$data.$item.sDay}}</div>\n    <div class=\"joblist-month\">{{$data.$item.sMonth}}</div>\n  </div>\n  <div class=\"joblist-column-2\">\n    <div class=\"joblist-contract\">{{$data.$item.sProblemDetail}}</div>\n    <br>\n    <div class=\"joblist-priority\">{{$data.$item.aAccuServJobID.sJobNo}}</div>\n    <div class=\"joblist-priority\">{{$data.$item.aOperativeDetail.sOperativeName}}</div>\n    <div class=\"joblist-address\"></div>\n  </div>\n  <div class=\"joblist-column-3\"></div>\n</div>"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"bbba253a-a936-4c0f-b44a-dc33346fdcb0","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"e54b248f-c25d-4d40-9b3c-99bc44d1041f","content":"Back","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.lastJobHistoryPage;\ndelete cti.store.jobs.jobHistorySelected;\ndelete cti.store.variables.historyData;\n\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"828f8966-e46c-44e3-90a9-5ab6ea3c05e5"}],"classes":"button-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"RaiseIncident","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"f1e8fb9a-37fd-41b5-a045-e9c6c8a49e35","attributes":{},"expressions":{}},{"name":"html_header","type":"content","item-type":"html","_auto_id_":"7ef61cc4-c084-4336-b507-4b77b92b98e1","content":"<h4 class=\"title\">Raise an Incident</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3422f16c-1b77-4bf0-8cf3-96755b03e37c","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"38be2975-be85-4cd9-969a-e84a2137f728","function":"open"},"_auto_id_":"ded14090-e3ce-4c92-9f91-72f6c41667a9"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"c785c392-5f1d-4372-8f5a-b6b405057820","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"faac681c-8965-4c25-b108-50bcfaaa7192"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"0d0f5a62-af4d-4248-bf2d-a38f888f6c3b","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"b06466ce-a118-4edc-a7e5-0cdb5a422fcb"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"48d897f5-922d-4032-9645-f9ddd9fe76f3","content":"Job Map","theme":"default","expressions":{"show":"$store.jobs.jobList.length > 0"},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"7d114864-2772-4b8e-98fc-f15b10c6b806"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"ff8c420c-3c9e-432f-8854-fdb146167597","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"5d6d7ed6-3fb2-4dd2-a70f-8cbcdb6a24a8"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"38be2975-be85-4cd9-969a-e84a2137f728","attributes":{},"expressions":{}}],"_auto_id_":"478bcf19-611b-4162-b440-40fe6e848955","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"0efaa3c5-daac-4d6c-bed9-2d5a26666c74","content":[{"name":"html_override","type":"content","item-type":"html","_auto_id_":"8e9cda38-3a0d-4e1e-a6c4-8897d7f7a783","content":"<p>In order to raise either a Customer or a Property related Incident, please fill in the form below before submitting.</p>\n<hr>","expressions":{}},{"name":"incidentType","type":"choice","item-type":"select","_auto_id_":"aec83ea1-0cd7-4d96-a718-da54cb9b870f","label":"Incident Type:","required":false,"options":[{"label":"CUSTOMER","value":"CUSTOMER"},{"label":"PROPERTY","value":"PROPERTY"}],"expressions":{}},{"name":"incidentCustomerType","type":"choice","item-type":"select","_auto_id_":"6b7e793a-250c-4d99-8680-787e38089fd5","label":"Customer Type:","required":false,"options":[{"label":"DISABILITY","value":"DISABILITY"},{"label":"VULNERABILITY","value":"VULNERABILITY"},{"label":"OTHER","value":"OTHER"}],"expressions":{"show":"$store.pages.RaiseIncident.incidentType.value == \"CUSTOMER\""}},{"name":"incidentPropertyType","type":"choice","item-type":"select","_auto_id_":"0fe967f0-feef-4b43-b567-f8ee74f8b9c9","label":"Property Type:","required":false,"options":[{"label":"ASBESTOS","value":"ASBESTOS"},{"label":"DAMP","value":"DAMP"},{"label":"HEALTH AND SAFETY","value":"HEALTH AND SAFETY"},{"label":"DIRTY PROPERTY","value":"DIRTY PROPERTY"},{"label":"INFESTATION","value":"INFESTATION"},{"label":"TENENT DAMAGE","value":"TENENT DAMAGE"},{"label":"RECHARGE","value":"RECHARGE"},{"label":"OTHER","value":"OTHER"}],"expressions":{"show":"$store.pages.RaiseIncident.incidentType.value == \"PROPERTY\""}},{"name":"incidentDescription","type":"user-input","item-type":"text","_auto_id_":"732b9050-1eee-4631-a804-4903cdc73c7a","label":"Description:","required":true,"multiline":true,"debounce":250,"expressions":{},"message":"This is a required field"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"7bbbe2f4-174b-4bc3-b6ad-bd6748953b00","extends":{"type":"area","item-type":"row"},"content":[{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"f2e44f32-fe0e-4862-ab51-815f1933f404","content":"Cancel","theme":"default","expressions":{},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('RaiseIncident');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"2f669735-22f0-4bae-a2e6-1ecb375cf8f1"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"12a78677-cbaf-4e38-935e-ee31182a6b9c","content":"Submit","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.lastJobEvent === undefined) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_nopreviousjob\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warnings\",\n      \"title\" : \"Warning: No previous Job completed\",\n      \"text\" : \"You can not Raise an Incident as you have yet to complete any Jobs today. Please complete a Job before Raising an Incident.\"\n    }\n  );\n} else {\n  cti.fnOpenSpinner('Raising Incident...');\n  \n  var incidentType = cti.store.pages.RaiseIncident.incidentType.value;\n  var incidentDescription = cti.store.pages.RaiseIncident.incidentDescription;\n  var subType = \"\";\n\n  if(incidentType == \"CUSTOMER\") {\n    subType = cti.store.pages.RaiseIncident.incidentCustomerType.value;\n  } else {\n    subType = cti.store.pages.RaiseIncident.incidentPropertyType.value;\n  }\n\n  var lastJob = cti.store.jobs.lastJobEvent;\n  \n  cti.store.payloads.raiseIncidentPayload = {\n    \"jobID\": lastJob.aAccuServJobID,\n    \"incident\": {\n      \"sIncidentType\": incidentType,\n      \"sIncidentSubType\": subType,\n      \"sIncidentDescription\": incidentDescription,\n      \"sPropertyID\": lastJob.sPropertyID,\n      \"sOperativeID\": lastJob.sOperativeID\n    }\n  }\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"RaiseIncident\" });\n}"},"_auto_id_":"ff9ba457-c468-474a-9479-894b8097494f"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"RequestJob","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"8386b0d6-1656-4d6d-84a8-816a66948b77","attributes":{},"expressions":{}},{"name":"html_header","type":"content","item-type":"html","_auto_id_":"d3cf2ee9-e15b-47ca-86c3-028794ce3a04","content":"<h4 class=\"title\">Request OOH Job</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"a304d9ee-bb89-46b3-aad1-aff77953f87f","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"f236482b-55e8-476e-9473-ac8ef18c16a6","function":"open"},"_auto_id_":"14eb5977-c16b-4583-8daa-85e0f66de157"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"e34245a1-0a55-4663-bb34-bfb61356766d","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"454493c0-c9dd-418b-8efe-84075fd9150b"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"6e84d5d8-22a5-4245-8fe8-607652814699","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"9cea2767-f5cd-4f01-aeb9-b539c3e06c1b"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"e4588a8c-d210-4e91-b6d4-063ad76a8b2b","content":"Job Map","theme":"default","expressions":{"show":"$store.jobs.jobList.length > 0"},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6a60cb77-3a99-475d-9f55-a3447825e8f5"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"bd925d0d-eee7-4cfb-a759-a1ce172080a2","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"0a216438-83e0-4c99-a880-14ac06ee4cef"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"f236482b-55e8-476e-9473-ac8ef18c16a6","attributes":{},"expressions":{}}],"_auto_id_":"b17fd20a-3d8c-461d-a4cb-5508a9196b53","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"dafeff07-1e20-4da7-8327-f1712ba1923b","content":[{"name":"html_override","type":"content","item-type":"html","_auto_id_":"0f32b424-e2e5-4983-84da-f2859132cce0","content":"<p>In order to request an OOH, please fill in the form below before submitting.</p>\n<hr>","expressions":{}},{"name":"clientOrderNumber","type":"user-input","item-type":"text","_auto_id_":"f92ceaab-d9fd-44eb-8b03-04b88ff9319f","label":"Client Order Number:","required":true,"multiline":false,"debounce":250,"message":"This is a required field","expressions":{}},{"name":"addressLineOne","type":"user-input","item-type":"text","_auto_id_":"099981f1-4052-46d3-a282-ae63d61296de","label":"Address Line One:","required":true,"multiline":false,"debounce":250,"message":"This is a required field","expressions":{}},{"name":"addressLineTwo","type":"user-input","item-type":"text","_auto_id_":"1cd238b4-844c-4107-b810-fd5112ffff21","label":"Address Line Two:","required":true,"multiline":false,"debounce":250,"expressions":{},"message":"This is a required field"},{"name":"postcode","type":"user-input","item-type":"text","_auto_id_":"abd80040-c2be-4fa7-9751-2e268c4f1df8","label":"Postcode:","required":true,"multiline":false,"debounce":250,"expressions":{},"message":"This is a required field"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"34f39d0c-bd57-40a2-b3c5-d795772a25bf","extends":{"type":"area","item-type":"row"},"content":[{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"df28a75e-aa44-4cce-98f6-48101dbc24ba","content":"Cancel","theme":"default","expressions":{},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('RequestJob');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"ce15c084-5366-40a5-830e-cb014e3930ca"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"0283ba2f-d553-4de9-b786-6a51a9bb498d","content":"Submit","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Requesting OOH Job...');\n\ncti.store.payloads.requestJobPayload = {\n  \"sOperativeID\": cti.store.currentProfile.username,\n  \"sAddressLine1\": cti.store.pages.RequestJob.addressLineOne,\n  \"sAddressLine2\": cti.store.pages.RequestJob.addressLineTwo,\n  \"sPostCode\": cti.store.pages.RequestJob.postcode,\n  \"sClientCode\": cti.store.pages.RequestJob.clientOrderNumber\n};\n\ncti.utils.callAction('call-actionflow', { \"name\": \"RequestJob\" });"},"_auto_id_":"2600e218-0d05-486c-81a8-5ed5f55172ae"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"AdHocPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"2b2554eb-3f9d-4b63-8a2d-444584b24431","content":"<h4 class=\"title\">Ad Hoc Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"f99cd704-a5e9-4867-9990-857c91ae7aae","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecks","componentInstanceId":"a2a699db-99da-40f0-b2e9-69da9c128dfa","function":"open"},"_auto_id_":"2c708b71-1212-4bdb-9da1-b1b95ad1d4cc"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"693c6280-fa28-4c52-9097-f91156266928","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"fc1309e8-219f-43f0-8c02-7e90b5b9481b"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"7bb17d56-4c9d-4376-8385-f2aa33c9ac25","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"2addf9bd-48b7-447b-80ff-43202950cce7"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"a2a699db-99da-40f0-b2e9-69da9c128dfa","attributes":{},"expressions":{}}],"_auto_id_":"96d1770c-9559-4472-8d46-826fd148fdec","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"6d959ccd-3307-4f7a-bb7e-802aff00a79a","attributes":{},"expressions":{}},{"name":"html_adhocphotos","type":"content","item-type":"html","_auto_id_":"306814e6-68c5-4c0b-9310-acbf71684dde","content":"<h4>Ad Hoc Photos</h4>\n<p>If you wish to take any photos throughout the course of the Job (per Ad-Hoc), then please do so here. Below is a list of all photos associated with this job. Photos added from this page will be tagged under the Ad-Hoc Category.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('AdHocPhotos','c2020a1f-3c4e-4df4-8a81-8e653f63a509')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{}},{"name":"takePhoto_btn","type":"button","item-type":"button","_auto_id_":"6e352a61-78b0-4f3e-8440-73421fb82b76","content":"Take Photo","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"AdHocPhotos","componentInstanceId":"19464af6-7034-4f06-a235-4f45278447f1","function":"takePhoto"},"_auto_id_":"e23ac294-9d6d-4999-9f3a-13b032288705"}],"classes":"takephoto-btn"},{"name":"AdHocPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"f509b6fb-7881-4012-8019-6a75ad689441","_auto_id_":"19464af6-7034-4f06-a235-4f45278447f1","attributes":{"captureCategory":"Ad Hoc","displayCategory":"Ad Hoc","maxPhotos":3},"expressions":{},"actions":[{"event":"maxPhotosTaken","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"app_genericwarning","title":"Photos","text":"You have taken the maximum number of photos for pre-work evidence."},"_auto_id_":"44ed119c-0257-4f0c-b5de-107f0af86430"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"0345796f-6a93-4c6a-bed3-5134607cc01f","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"0d4f0d36-385d-4541-b776-f9390d218b83","content":"Back","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.fromPhotoDetail;\nvar lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastTakePhotoPage));\ndelete cti.store.variables.lastTakePhotoPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"440d7037-f30a-461a-b415-40f4df1e5ed2","actions":[]}]}],"expressions":{}}],"_auto_id_":"f7c96006-f8e7-4e54-89a7-6104ce7f27f4","expressions":{}}]},{"start":false,"name":"Completion","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"318055f2-6e28-4203-897c-189d5404d311","content":"<h4 class=\"title\">Complete Job</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"5c7f6d2c-a774-4d6a-ae5b-07da7f3ab1d6","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"Completion","componentInstanceId":"44525fdb-d384-4a6f-9a39-2b8de7826d61","function":"open"},"_auto_id_":"80c16c90-54a6-4bc3-ab99-db90180a4640"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"01ab1481-3dcc-4a26-b1a6-8acb66b47632","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"c7c53453-6b5e-4c39-9216-8d2083d7b4bf"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"36082088-4bab-45b2-9af2-0ba3cadbf179","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3c402b2c-b9b5-4583-92a8-8586d000fb6b"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"593892ad-ffdc-4fdf-9a5c-e9eb1fb7dfc2","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"2423e20e-1e42-4585-9cd0-fa029b860e88"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"701a9b69-96a6-4429-93a5-ec9343287244","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9d20f2f6-fbf1-4496-94f6-34df2dce8b8d"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"6aee6ce5-5f80-4474-95b3-6e9f36cf77ae","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"134ebe0a-ebb3-48c8-8c3c-c93bf890e268"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"44525fdb-d384-4a6f-9a39-2b8de7826d61","attributes":{},"expressions":{}}],"_auto_id_":"1a835c05-6c20-4f2d-927e-74f8f64055cf","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"f256e40c-89ec-42d9-8937-dbdc66fa1c69","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"e96f3406-d27d-457c-bda9-d1bd5b067d5e","attributes":{},"expressions":{}},{"name":"operativeComments","type":"user-input","item-type":"text","_auto_id_":"2fbfd2ac-9e97-4961-a4b6-d2e23c7c62ec","label":"Operative Comments:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.variables.confirmJobComplete != true"},"message":"This is a required field"},{"name":"operativeSignature","type":"user-input","item-type":"signature","_auto_id_":"4b2de8e8-aaef-432f-92e9-7b657f41e073","label":"Signature: ","required":true,"expressions":{"show":"$store.variables.confirmJobComplete != true"},"message":"This is a required field"},{"name":"confirmJobCompletion","type":"content","item-type":"html","_auto_id_":"b2e065c9-818c-415f-a4c4-a6b67e48d7bd","content":"<h3 style=\"\n    text-align: center;\n    margin-top: 20px;\n    color: green;\n\">Confirmation</h3>\n<p style=\"\n    text-align: center;\n    color: green;\n\">The task is now complete and ready to be sent. Once sent, no further changes can be made.</p>\n<p style=\"\n    text-align: center;\n    color: green;\n    font-weight: bold;\n\">Are you sure you wish to send the task?</p>","expressions":{"show":"$store.variables.confirmJobComplete == true"}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"cc751a07-1be0-4d29-8017-2381f76bbc4f","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"14eaa806-0915-4cc1-a7b3-1d3b75dffe50","content":"Previous","theme":"default","expressions":{"show":"$store.variables.confirmJobComplete != true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigatePO(cti.store.state.currentPage);"},"_auto_id_":"cf6c4492-766b-4295-abf5-523c363b1607"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"84c19890-bfa1-41e5-afa7-52502bf320d4","content":"Complete Job","theme":"default","expressions":{"disabled":"$form.invalid","show":"$store.variables.confirmJobComplete != true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.confirmJobComplete = true;\ncti.utils.updatePage();"},"_auto_id_":"54d742a5-638a-4a84-b59f-2c42baa056ac"}]},{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"5fc62714-2b5a-4738-98ee-c27498f24614","content":"No","theme":"default","expressions":{"show":"$store.variables.confirmJobComplete == true"},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.confirmJobComplete = undefined;\ncti.utils.updatePage();"},"_auto_id_":"398af473-4540-4e87-8435-2ea3676448e7"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"2293a1d5-0a3f-4433-93e1-97a33eb09d44","content":"Yes","theme":"default","expressions":{"show":"$store.variables.confirmJobComplete == true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.jobEventStatus = \"jobcomplete\";\ncti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });"},"_auto_id_":"fac99290-9e51-4d56-b0ce-6e893a63bd8c"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"OTCCodes","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"cd7b5f3e-f1ef-4ee8-93b4-54580b0a0967","actions":[{"event":"onload","type":"call-function","data":{"name":"fnSearchPanel","params":{"menuOption":"{{$store.variables.menuOption}}"}},"_auto_id_":"65a838cd-0e05-468c-89dc-af93405e4774"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"af569d53-a990-4e9f-af19-9a2cca4d28e6","content":"<h4 class=\"title\">Purchase Order Stock</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"c08cc327-5071-4fab-a35e-b0ae3c0d5496","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"OTCCodes","componentInstanceId":"36cd77bb-0d20-425f-9c7d-5b72f79756f4","function":"open"},"_auto_id_":"704e4477-20e1-4d49-a382-ebc8bb91b70c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"872f8bb9-cfad-4011-8504-7fede419b0b5","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"dd5bc977-e132-448b-9e18-131a6aff4479"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"12a14f6e-3089-40fb-831d-49dcc957e72a","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"a84468d4-3b2e-4038-87a3-8b4ccb878c1b"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"e2bc2add-4833-46c9-a875-7b5e072f2c69","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ba5e1b50-0780-4ca2-a1aa-75828b7e2dc8"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"02961028-f60f-4e01-ac0e-61b9adf3e6a1","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"Warnings","componentInstanceId":"f02d27fa-60c2-493a-bc05-24b29914989e","function":"show"},"_auto_id_":"a84e2cb6-9112-4c32-a86e-87c896120ee6"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3e4fa750-f954-4b28-9e8a-c9aabf0df9ce"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"6baf48b2-6a0d-48f3-9a0a-c2af16aa3233","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"910b1a0c-0b14-4aad-8e67-d9972927102b"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"51e9e13a-8398-49b0-a12e-fc32d628097e","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"a934ed16-0d08-420a-8d7b-6f080dd48663"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"d8479581-d503-47ee-987c-fe96f3132b6e","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"3b763ef8-bd7f-4486-be7e-12a4f2e5b817"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"36cd77bb-0d20-425f-9c7d-5b72f79756f4","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"ac6bd1a8-20f1-4f2b-8186-3b829552c5eb","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_otcstocklocation","type":"content","item-type":"html","_auto_id_":"88a5ee13-dea4-4e8f-825e-704fc9055295","content":"<h4>Purchase Order Stock Location: <span style=\"color:#0072C6;\">{{'$store.variables.selectedLocation.sLocation'|store}}</span></h4>\n<hr>\n<div id=\"panel\" class=\"sor-schedules-panel\">\n  <div id=\"schedules\" class=\"sor-schedules-schedules\" onclick=\"cti.fnSearchPanel('schedules');\">PO Stock</div>\n  <div id=\"search\" class=\"sor-schedules-search\" onclick=\"cti.fnSearchPanel('search');\">Search</div>\n</div>","expressions":{}},{"name":"SearchAllOTCStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"c3341eb8-461e-4b21-89e2-0a4547054eea","_auto_id_":"bf1a9790-c23a-4ce0-8150-8ea44582bff0","attributes":{"sourceObjectArrayName":"","displayArrayName":"cti.store.variables.otcStockSearchResults","displayListIfNoSearch":0,"maxResults":50,"minCharacters":3,"locationFilter":"","pouchDB":"otc"},"expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[]},{"name":"htmlSearchHint","type":"content","item-type":"html","_auto_id_":"ea6496a6-6b44-43ea-9291-6f7c7bd21116","content":"<p style=\"padding-top:10px;\">Please use the search facility above to find Purchase Order Stock codes that your require. The search facility is free text.</p>","expressions":{"show":"($store.variables.otcStockSearchResults===undefined || $store.variables.otcStockSearchResults.length==0) && $store.variables.menuOption === \"search\""}},{"name":"list_otcstock","type":"content","item-type":"list","_auto_id_":"465c68d2-06c1-4d92-b31b-fd45267ee917","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Adding OTC Stock...');\n\nif(cti.store.jobs.selectedJob.aOTCStock == undefined) {\n  cti.store.jobs.selectedJob.aOTCStock = [];\n}\n\nvar otcStock = cti.store.jobs.selectedJob.aOTCStock;\nvar code = {{$data.$item}};\nvar exisits = false;\n\nvar codeObj = code;\ncodeObj.sLocation = cti.store.variables.selectedLocation.sLocation || \"NOLOCATION\";\ncodeObj.nOrderQty = 1;\n\nfor(var i in otcStock) {\n  if(otcStock[i].sCode == codeObj.sCode) {\n    if(otcStock[i].sLocation == codeObj.sLocation) {\n      exisits = true;\n      break;\n    }\n  }\n}\n\nif(!exisits) {\n  otcStock.unshift(codeObj);\n  \n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodeadded\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"success\",\n      \"title\" : \"OTC Stock Added\",\n      \"text\" : \"You have successfully added this Over The Counter item to your Purchase Order.\"\n    }\n  );\n\n  cti.utils.callAction('call-component-function', { \"page\" : \"OTCCodes\",\"componentInstanceId\":\"07983c39-233d-4152-9809-2d67d24e1054\",\"function\":\"bind\"});\n  cti.utils.updatePage();\n  \n  cti.store.variables.menuOption = \"schedules\";\n  cti.fnSearchPanel(cti.store.variables.menuOption);\n} else {\n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have already added this OTC Stock Item to the Purchase Order.\"\n    }\n  );\n}"},"_auto_id_":"deb562bf-4574-4038-8be4-0b86bbed083a"}],"model":"$store.variables.otcStockSearchResults","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_otcstock_html","_auto_id_":"2fe39364-9e14-4636-96ee-4b2e952355bb","content":"<div style=\"display:block;width:100%;padding-bottom:10px;\">\n  <div style=\"font-weight:bold;\">Catalogue Stock Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>\n<div style=\"display:block;width:100%\">\n  <div>Cost Price: {{$data.$item.sCostPrice}}</div>\n  <div>Sell Price: {{$data.$item.sSellPrice}}</div>\n</div>"}],"pagination":true,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":3},{"name":"SearchJobOTCStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"c3341eb8-461e-4b21-89e2-0a4547054eea","_auto_id_":"b5cd45d2-f668-4e1d-a486-bbf581b5a8ac","attributes":{"sourceObjectArrayName":"cti.store.jobs.selectedJob.aOTCStock","displayArrayName":"cti.store.variables.otcStockJobSearchResults","displayListIfNoSearch":1,"maxResults":30,"minCharacters":3,"locationFilter":"cti.store.variables.selectedLocation.sLocation"},"expressions":{"show":"$store.variables.menuOption === \"schedules\""},"actions":[]},{"name":"html_otcstockcodesadded","type":"content","item-type":"html","_auto_id_":"0d9a09b5-0a7f-46e6-8d49-25ff91ee52fc","content":"<br>\n<p style=\"padding-top:10px\">Please confirm quantities for the below Purchase Order Stock codes added to this PO.</p>","expressions":{"show":"$store.variables.menuOption === \"schedules\""}},{"name":"list_otcstocksummary","type":"content","item-type":"list","_auto_id_":"495e8a03-18fb-47ce-91aa-f35fe2e278c7","search":"","classes":"","expressions":{"show":"$store.variables.menuOption === \"schedules\""},"theme":"bootstrap","model":"$store.variables.otcStockJobSearchResults","actions":[],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_otcstocksummary_html","_auto_id_":"f95a4d58-ccde-46d3-87ca-2cfed0c9a698","content":"<div style=\"display:block;width:100%\">\n  <div style=\"font-weight:bold;margin-bottom:15px;\">Catalogue Stock Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>\n<hr>"},{"name":"HeaderQuantityDone","type":"content","item-type":"html","_auto_id_":"6bcbb033-7ca2-44a1-a26f-170c6093c0a6","content":"<div style=\"display:inline-block;width:100%\">\n  <div style=\"display:inline-block;float:right;\">Cost Price: {{$data.$item.sCostPrice}}</div>\n  <div style=\"display:inline-block;float:left;\">Sell Price: {{$data.$item.sSellPrice}}</div>\n</div>\n<div class=\"sor-list-header\">Quantity Required</div>","expressions":{},"classes":""},{"name":"qntyDoneRow","type":"area","item-type":"row","_auto_id_":"b0cef1ab-e1bf-40b0-9cc0-616f22bac4b7","content":[{"name":"btnUsedMinus","type":"button","item-type":"button","_auto_id_":"a4e3383f-81b5-4b54-873e-439f95acb5eb","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQuantity <1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nOrderQty = $data.$item.nOrderQty - 1;"},"_auto_id_":"e7fd00e0-8520-4d93-85e7-104228e3d691"}]},{"name":"QuantityDone","type":"content","item-type":"html","_auto_id_":"4303843b-4ff8-4b90-955a-a9a960bfaa8f","content":"{{$data.$item.nOrderQty}}","expressions":{},"classes":"sor-value"},{"name":"btnUsedPlus","type":"button","item-type":"button","_auto_id_":"bf95cc5a-a71b-4716-90f8-10ffb149b8d7","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nOrderQty = $data.$item.nOrderQty + 1;"},"_auto_id_":"d90c7fab-d0c6-4e18-83c5-a4e3a3ebdf72"}]}],"expressions":{}}]},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"13600f5f-1d95-47f8-8789-582496954851","content":"Save","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ndelete cti.store.variables.otcStockSearchResults;\ndelete cti.store.variables.otcStockJobSearchResults;\ndelete cti.store.variables.selectedLocation;\ndelete cti.store.variables.menuOption;\n\ncti.utils.callAction('go-to-page', { \"name\": \"OTCLocationSelect\" });"},"_auto_id_":"b1610c2e-750f-4f7a-9402-354543e5c4ad"}],"classes":"confirm-bar-btn"}],"_auto_id_":"07c7ea1e-0f65-4e70-a52f-2df2b5a7fd75","expressions":{}}]},{"start":false,"name":"OTCLocationSelect","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"567fa278-ea97-4316-825d-ec953a4f2858","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"$( \"#otcLocationFetch\" ).click(function() {\n  cti.utils.callAction('call-actionflow',{'name':'OnlineStockLocations'});\n});\n\ncti.fnOrderOTCLocations();\n$success();"},"_auto_id_":"3cc70d1b-ce9b-4bc5-90e8-f2904b95490f"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"205e77e2-4f43-459a-9eec-aee89b821073","content":"<h4 class=\"title\">Purchase Order Location</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"a62429fa-3d57-49af-ad40-4b6ee7d19246","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"OTCLocationSelect","componentInstanceId":"26ead421-692b-48af-b5b2-62d7c286d05d","function":"open"},"_auto_id_":"1fa8efc2-51a3-4991-b401-69d29e5c07f4"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"cf0b8ac0-78c5-4833-b373-14bac371092d","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"5fcf7ea1-6112-452b-b2d1-f304de7b9b79"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"ed1b933d-1e6f-4227-a59c-3b04a1ce275f","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"0372315a-2a23-4548-a673-3a1a4f900845"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"7bcead56-6a7b-4c23-afd2-64d13eb1854b","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6da411a9-a79e-4218-80fe-eb690d3ee8f8"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"f8393f82-6f8f-46ff-9936-96afcc49088d","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"Warnings","componentInstanceId":"f02d27fa-60c2-493a-bc05-24b29914989e","function":"show"},"_auto_id_":"f865bce5-cd6e-444d-9269-a1f37ebf4eea"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"24c63685-19c4-4557-a5e3-f241084f69d3"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"08307d33-ff9f-4382-bfd2-e86caa76dd69","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"aef2893f-7e72-4c44-8fc0-10dcb76385ad"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"c87b7c3e-d398-4fb0-8154-35638edb50df","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"a7b581fa-2d2e-4b80-9f4b-8e3cd107acb5"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"1d0658ae-46a7-46b9-9fe8-ce38485f24da","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"8dca7e00-89ba-4353-bf73-5e2a8b211fcf"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"26ead421-692b-48af-b5b2-62d7c286d05d","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"75df5bd4-03f8-4497-9832-83e26b504365","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"c65e07a9-417f-41fb-8e7a-e7f85ee67d27","attributes":{},"expressions":{}},{"name":"html_otcheader","type":"content","item-type":"html","_auto_id_":"143ed1ce-fd34-43b5-9c35-00ea2f8dc92f","content":"<div class=\"codes-icon\">\n\t<i class=\"fa fa-file-powerpoint-o\"></i>\n</div>\n<h4 class=\"codes-icon-header\">Order Catalogue Stock Codes</h4>","expressions":{}},{"name":"jobLocationsEmpty","type":"content","item-type":"html","_auto_id_":"6f2ece08-72da-4bdc-917f-fed8e866001c","content":"<h4 style=\"text-align:center;\">Failed to Download Purchase Order Stock</h4><p style=\"text-align:center;\">Currently you do not have any available Purchase Order Stock on device. Please contact your Supervisor or try downloading the Purchase Order Stock by tapping the below icon.</p>\n<div style=\"color:#0072C6;text-align:center;font-size:30pt;width:100%\" id=\"otcLocationFetch\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.jobLocations == false"}},{"name":"list_location","type":"content","item-type":"list","_auto_id_":"410b5571-51b4-4521-a346-b0b8169a2b4a","search":"","classes":"","theme":"bootstrap","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Loading Order Catalogue...');\n\ncti.store.variables.selectedLocation = {{$data.$item}};\n\nwindow.appManager.loadFromDatabase('otcdatafull', function (doc) {\n  var fullStock = doc.data;\n  var stock = [];\n  var filter = cti.store.variables.supplierOTCFilter;\n  \n  for(var i in fullStock) {\n    var stockItem = fullStock[i].sAttrib1.trim();\n    \n    if(filter === \"\" || filter === undefined) {\n      stock.push(fullStock[i]);\n    } else if(stockItem === filter) {\n      stock.push(fullStock[i]);\n    }\n  }\n\n  window.appManager.saveToDatabase(\"otcdata\", stock, function(rev) {\n      window.appManager.loadFromDatabase('otcdata', function (doc) {\n        var otcStock = cti.store.jobs.selectedJob.aOTCStock;\n        var selectedLocation = cti.store.variables.selectedLocation;\n        \n        var exists = false;\n\n        for(var i in otcStock) {\n          if(otcStock[i].sLocation == selectedLocation.sLocation) {\n            exists = true;\n            break;\n          }\n        }\n\n        if(exists) {\n          cti.store.variables.menuOption = \"schedules\";\n        } else {\n          if(selectedLocation.sOTCStockQuantity != 0) {\n            cti.store.variables.menuOption = \"schedules\";\n          } else {\n            cti.store.variables.menuOption = \"search\";\n          }\n        }\n\n        cti.store.variables.otcStockSearchResults = [];\n        var count = 50;\n\n        for(var i in doc.data) {\n          if(count === 0) {\n            break;\n          } else {\n            count--;\n            cti.store.variables.otcStockSearchResults.push(doc.data[i]);\n          }\n        }\n        \n        cti.utils.callAction('go-to-page', { \"name\": \"OTCCodes\" });\n\n        $success();\n      }, function (reason, err) {\n        cti.fnCloseSpinner();\n        cti.utils.callAction('call-actionflow', { \"name\": \"OnlineOTCCodes\" });\n      });\n      $success();\n    }, function(reason, e) {\n      window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n      $success();\n  });\n}, function (reason, err) {\n  cti.fnCloseSpinner();\n  cti.utils.callAction('call-actionflow', { \"name\": \"OnlineOTCCodes\" });\n});"},"_auto_id_":"4ad58d1c-c7d1-4349-b13c-f34b8c401f13","actions":[]}],"model":"$store.jobs.locationsOTCStock","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_location_html","_auto_id_":"cf848975-3ab0-433e-85a1-ce531f5c47d7","content":"<div class=\"list-item-container\">\n  <div class=\"list-location\">{{$data.$item.sDescription}} <span style=\"color:#0072C6\">{{$data.$item.sOTCStockQuantity}}</span></div>\n  <div class=\"{{$data.$item.sLocationClass}}\"></div>\n</div>"}]},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"97ee6080-87ac-4de1-9497-64da1fc114e0","content":"Show More","theme":"default","expressions":{"show":"$store.variables.showFullLocations === false || $store.variables.showFullLocations === undefined"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = true;\ncti.fnOrderOTCLocations();"},"_auto_id_":"67cf689e-20fe-48ab-be86-aa0482d58cd7"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"958036fd-553a-442a-95cb-80c1aeba2472","content":"Show Less","theme":"default","expressions":{"show":"$store.variables.showFullLocations === true"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ncti.fnOrderOTCLocations();"},"_auto_id_":"08638220-70f6-4224-bd66-5d9ed0dfd578"}],"classes":"showlist-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"3990b30d-21d4-4ed8-8512-0ba4787bf7e6","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"619d68d6-71ef-42f6-b024-49ee35a596c8","content":"Back","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.showFullLocations;\ndelete cti.store.variables.jobLocations;\n\ncti.utils.callAction('go-to-page', { \"name\": \"OTCPurchases\" });"},"_auto_id_":"3899ee7d-c84a-4291-85f4-0a85d5a8c005"}],"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"ca01e8c8-8a28-413a-a66f-1f0999457f61","expressions":{}}]},{"start":false,"name":"OTCPurchases","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"736a5e7b-caaf-4304-90b6-2d8749d2d3eb","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var job = cti.store.jobs.selectedJob;\n\nif(job.aOTCStock === undefined) {\n  job.aOTCStock = [];\n}\n\nif(job.aOTCStock.length > 0) {\n  cti.store.variables.poStock = true;\n} else {\n  cti.store.variables.poStock = false;\n}\n\ncti.utils.updatePage();"},"_auto_id_":"9068cc92-8fb4-41d9-a623-a515436a15c0"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"78471a76-b01e-4a5f-8cff-a5d9d76e0b7a","attributes":{},"expressions":{},"actions":[]},{"name":"html_header","type":"content","item-type":"html","_auto_id_":"b59e36d3-648f-43a9-8614-5ebb397a00e1","content":"<h4 class=\"title\">Purchase Order</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"b7bd3696-a413-4a69-b2a3-32aedbcbc928","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"SpecialPurchases","componentInstanceId":"d1f25039-1709-49a3-966b-d7f144884945","function":"open"},"_auto_id_":"9e235a90-201c-4225-9299-793de22cdb6c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"570fd3f0-39b4-446a-9884-4b852eea2015","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"371a248a-7afb-4f87-aa9a-3d86a24d2f3e"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"c74565e1-c00a-4c84-8fa7-e87db822faca","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"66645b8a-b250-4b60-9fe3-140aa15ccd63"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"96a8f613-9066-4f95-a0ba-48409be921e7","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a7c3aea3-700a-48b6-b2cb-a615cd1e7b8e"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"006c4ad0-9f39-4f76-ba2f-4d389222672c","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"2855b578-dd11-44c4-b430-0500ea41848f"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"ac292ba9-0068-4380-b9e2-09e35a0c159c","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d081b694-0d82-4309-b85b-eb7e702d19b5"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"6c250f3f-0415-4bc3-be81-8feae66912eb","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"cda81cac-1cae-481a-b60c-7be98c565965"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"b336be3b-10e2-41dd-a9b3-82844b158bee","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"eaa76d17-d190-4136-afdd-1de34c0cc7f1"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"d1f25039-1709-49a3-966b-d7f144884945","attributes":{},"expressions":{}}],"_auto_id_":"6db85e53-64c5-4954-8fe6-d276bfad4089","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"2f1a4fe1-e192-44da-8686-b34c17a23259","content":[{"name":"html_specialorderheader","type":"content","item-type":"html","_auto_id_":"5c2c86e2-d0f2-47a5-8ac5-c2f7ae12a54d","content":"<p>If you require a part to complete the job, please raise a PO for it here. You can add as many stock codes to the order as you wish, but can only submit 1 PO per job. Once the PO has been raised you can not raise another.</p>\n<hr>","expressions":{}},{"name":"html_poraised","type":"content","item-type":"html","_auto_id_":"a83b86cd-7876-4027-a7dc-e48515666327","content":"<div class=\"purchase-order\">\n\t<i class=\"fa purchase-order-icon\"></i>\n</div>\n<h4 class=\"purchase-order-header\">Purchase Order Raised</h4>","expressions":{"show":"$store.variables.poRaised === true"}},{"name":"specialorder_btn","type":"button","item-type":"button","_auto_id_":"180ff295-d2ae-410b-8cc6-bd3865522e66","content":"Raise Purchase Order","theme":"default","expressions":{"show":"$store.variables.specialOrder != true && $store.variables.poRaised != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.specialOrder = true;\ncti.utils.updatePage();"},"_auto_id_":"b15ebdad-f48d-4dc8-85e4-69da3be494bf"}],"classes":"travel-btn"},{"name":"html_jobnumber","type":"content","item-type":"html","_auto_id_":"c00fa977-f12f-4afa-ad28-2a00bba9efa9","content":"<h4>Job No. {{'$store.jobs.selectedJob.aAccuServJobID.sJobNo'|store}}</h4>","expressions":{"show":"$store.variables.specialOrder == true"}},{"name":"orderSupplier","type":"choice","item-type":"select","_auto_id_":"25bfd4d0-f13a-461f-9a56-9420226134ec","label":"Supplier:","required":true,"options":[],"expressions":{"show":"$store.variables.specialOrder == true"},"message":"This is a required field","option-source":"$store.staticData.stockSuppliers","label-property":"sName","value-property":"sName","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"var suppliers = cti.store.staticData.stockSuppliers;\nvar selectedSupplier = cti.store.pages.OTCPurchases.orderSupplier.value.replace(/ /g,'');\nvar deliveryMethod = cti.store.pages.OTCPurchases.orderDeliveryMethod;\nvar depots = [];\n\nfor(var i in suppliers) {\n  var thisSupplier = suppliers[i];\n  var supplierName = thisSupplier.sName.replace(/ /g,'');\n\n  if(supplierName === selectedSupplier) {\n    var depotsOnSupplier = thisSupplier.aSupplierDepots;\n\n    if(depotsOnSupplier.length > 0) {\n      for(var x in depotsOnSupplier) {\n        var thisDepot = depotsOnSupplier[x];\n        \n        var depot = {\n          \"sAddressLine1\" : thisDepot.sAddressLine1.trim() + ', ' + thisDepot.sPostcode.trim(),\n          \"sDepNo\" : thisDepot.sDepNo.replace(/ /g,'')\n        }\n        \n        depots.push(depot);\n      }\n    } else {\n      var dummyDepot = {\n        \"sAddressLine1\" : \"NO DEPOTS AVAILABLE\",\n        \"sDepNo\" : \"0\"\n      }\n\n      depots.push(dummyDepot);\n    }\n    break;\n  }\n}\n\ncti.store.staticData.stockSupplierDepots = depots;\ncti.store.pages.OTCPurchases.orderDepot = undefined;\n\ncti.utils.updatePage();"},"_auto_id_":"6b703920-39ba-4ac6-96d7-8c2998f892ad"}]},{"name":"orderDepot","type":"choice","item-type":"select","_auto_id_":"b8f12e43-3d21-45d0-a0ca-ffff5de86292","label":"Branch:","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"expressions":{"show":"$store.variables.specialOrder == true && $store.pages.OTCPurchases.orderSupplier != undefined"},"option-source":"$store.staticData.stockSupplierDepots","label-property":"sAddressLine1","value-property":"sDepNo","actions":[],"message":"This is a required field"},{"name":"orderDeliveryMethod","type":"choice","item-type":"select","_auto_id_":"aa7085a7-b887-4916-a4d6-af442c5c2418","label":"Delivery Method:","required":true,"options":[{"label":"COLLECTION","value":"COLLECTION"},{"label":"DELIVERY TO SITE","value":"DELIVERY TO SITE"},{"label":"CONTRACT OPERATIVE","value":"CONTRACT OPERATIVE"}],"expressions":{"show":"$store.variables.specialOrder == true && $store.pages.OTCPurchases.orderDepot != undefined"},"message":"This is a required field","actions":[]},{"name":"orderDeliveryDate","type":"user-input","item-type":"date","_auto_id_":"a4a9730f-4aef-4e8c-94f6-27c7fc0c7c38","label":"Requested Delivery Date: ","required":false,"left-icon":"fa-calendar","options":{"min":"current","selectYears":false,"selectMonths":false,"max":""},"validators":[],"actions":[],"expressions":{"show":"$store.variables.specialOrder == true"}},{"name":"orderDescription","type":"user-input","item-type":"text","_auto_id_":"1652aec7-d7c2-4118-8e17-9a31bf69834a","label":"Order Description:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.variables.specialOrder == true"},"message":"This is a required field"},{"name":"addStock_btn","type":"button","item-type":"button","_auto_id_":"b388d5e0-62ed-49e3-9747-1f44111eeeeb","content":"Add Stock","theme":"default","expressions":{"show":"$store.variables.specialOrder == true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var suppliers = cti.store.staticData.stockSuppliers;\nsupplierSelected = \"\";\n\nif(cti.store.pages.OTCPurchases != undefined) {\n  if(cti.store.pages.OTCPurchases.orderSupplier != undefined) {\n\tvar value = cti.store.pages.OTCPurchases.orderSupplier.value;\n    supplierSelected = value.replace(/ /g,'');\n  }\n}\n\nfor(var i in suppliers) {\n  var thisSupplier = suppliers[i];\n  var thisSupplierName = thisSupplier.sName.replace(/ /g,'');\n  \n  if(thisSupplierName === supplierSelected) {\n    cti.store.variables.supplierOTCFilter = thisSupplier.sAttrib1.trim();\n    break;\n  }\n}\n\n\nif(cti.store.variables.supplierOTCFilter != undefined) {\n  cti.utils.callAction('go-to-page', { \"name\": \"OTCLocationSelect\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You must select a Supplier from the list above before adding any Catalogue stock to your Purchase Order.\"\n    }\n  );\n}"},"_auto_id_":"d580e98c-a257-40e9-a089-bb3d2a31a4ea"}]},{"name":"html_nostock","type":"content","item-type":"html","_auto_id_":"11e9b093-847c-4ad3-83c6-a15852fad937","content":"<div class=\"purchases-area\"><h4 class=\"centered-text\">You have 0 Stock Items added to the Purchase Order</h4><p class=\"centered-text\">Currently you do not have any Stock Codes added to your Purchase Order. Please add at least 1 code before continuing with the Purchase Order.</p>\n</div>","expressions":{"show":"$store.variables.specialOrder === true && $store.variables.poStock === false"}},{"name":"orderStock","type":"content","item-type":"list","_auto_id_":"aa5ee341-9b7d-465b-b8cd-b680e6284c11","search":"","classes":"","expressions":{"show":"$store.variables.specialOrder === true && $store.variables.poStock === true"},"theme":"bootstrap","model":"$store.jobs.selectedJob.aOTCStock","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"orderStock_html","_auto_id_":"33d929d2-28f6-4a5c-a24a-ebe6b4cf572b","content":"<div style=\"display:block;width:100%\">\n  <div style=\"font-weight:bold;\">Catalogue Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>\n<hr>\n<div style=\"display:block;width:100%\">\n  <div>Cost Price: {{$data.$item.sCostPrice}}</div>\n  <div style=\"float:right;\">Quantity: {{$data.$item.nOrderQty}}</div>\n  <div>Sell Price: {{$data.$item.sSellPrice}}</div>\n</div>"}],"actions":[]},{"name":"button_bar_nav","type":"area","item-type":"button-bar","_auto_id_":"56b28299-d63b-4664-b63b-cd1852337bc5","extends":{"type":"area","item-type":"row"},"content":[{"name":"cancel_btn","type":"button","item-type":"button","_auto_id_":"bf23c4c9-156e-4d36-91d1-e91a6f53cdfb","content":"Cancel","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.jobs.selectedJob.aOTCStock;\ndelete cti.store.jobs.selectedJob.aPurchaseOrder;\n\ncti.utils.destroyPageData('OTCPurchases');\ncti.store.variables.specialOrder = false;\ncti.utils.updatePage();"},"_auto_id_":"3bf5c440-fd53-41aa-9e81-a8d2a708cdf4"}],"classes":"deletephoto-btn"},{"name":"placeorder_btn","type":"button","item-type":"button","_auto_id_":"18e88bca-4f02-48b9-a0fa-e74e7dfabf03","content":"Raise PO","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.aPurchaseOrder == undefined) {\n  cti.store.jobs.selectedJob.aPurchaseOrder = {};\n}\n\nif(cti.store.jobs.selectedJob.aOTCStock == undefined) {\n  cti.store.jobs.selectedJob.aOTCStock = [];\n}\n\nvar job = cti.store.jobs.selectedJob;\nvar selectedSupplier = cti.store.pages.OTCPurchases.orderSupplier.value.replace(/ /g,'');\nvar suppliers = cti.store.staticData.stockSuppliers;\n\nfor(var i in suppliers) {\n  if(selectedSupplier == suppliers[i].sName.replace(/ /g,'')) {\n    var supplierCode = suppliers[i].sAccountCode1.replace(/ /g,'');\n    break;\n  }\n}\n\nvar purchaseOrder = {\n  \"sOperativeID\": job.aOperativeDetail.sOperativeID,\n  \"sSupplierCode\": supplierCode,\n  \"dOrderDate\": moment().format('YYYY-MM-DD'),\n  \"dDeliveryDate\": moment(cti.store.pages.OTCPurchases.orderDeliveryDate).format('YYYY-MM-DD'),\n  \"sDeliveryMethod\": cti.store.pages.OTCPurchases.orderDeliveryMethod.value,\n  \"sSpecicalInstructions\": cti.store.pages.OTCPurchases.orderDescription,\n  \"sCollectionDepNo\": cti.store.pages.OTCPurchases.orderDepot.value,\n  \"aAccuServJobID\": job.aAccuServJobID,\n  \"aAccuServPOItems\": job.aOTCStock\n};\n\n\nif(purchaseOrder.aAccuServPOItems.length > 0) {\n  cti.store.jobs.selectedJob.aPurchaseOrder = purchaseOrder;\n  cti.store.payloads.purchaseOrderPayload = purchaseOrder;\n  cti.utils.callAction('call-actionflow', { \"name\": \"PurchaseOrder\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You must add at least 1 OTC Stock Item to the Purchase Order.\"\n    }\n  );\n}"},"_auto_id_":"5c3fabb8-31bd-4e7d-a1ac-76597db27396"}],"classes":"confirm-bar-btn"}],"expressions":{"show":"$store.variables.specialOrder == true && $store.jobs.selectedJob.bJobStartWork === true"}},{"name":"button_bar_order","type":"area","item-type":"button-bar","_auto_id_":"2ecc3ab6-1983-4ad1-8a4f-55fafb5b17e7","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"27b8f2a5-e425-47c6-9774-388f4bbd2c84","content":"Back","theme":"default","expressions":{"show":"$store.variables.poNav === false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.lastPOPage;\n\nif(lastPage == \"VanLocationSelect\") {\n  cti.fnNavigateVanStock(cti.store.state.currentPage);\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": lastPage });\n}"},"_auto_id_":"7f558f4e-db4d-456d-844f-dd7e03934122"}],"classes":"button-bar-btn"},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"02a6af1c-c422-47c0-bf1a-2ecc7e80c9b2","content":"Previous","theme":"default","expressions":{"show":"$store.variables.poNav === true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigateVanStock(cti.store.state.currentPage);"},"_auto_id_":"9b2bd23a-ab06-40bf-8f9d-79158de47b69"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"7ac77eca-b878-4327-856a-728aa477826f","content":"Next","theme":"default","expressions":{"disabled":"$store.variables.specialOrder === true","show":"$store.variables.poNav === true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"go-to-page","data":{"name":"Completion","isConditional":false},"_auto_id_":"74a0fe95-216a-4bae-9ee0-4c5625b2049f"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"VanStockCodes","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"e9a0bc13-c4b6-4d00-934f-53ec746ed303","actions":[{"event":"onload","type":"call-function","data":{"name":"fnSearchPanel","params":{"menuOption":"{{$store.variables.menuOption}}"}},"_auto_id_":"7037b14b-936e-4f46-87d6-d6468a49903e"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"92d0cdea-a8dd-43e1-a901-6c5538b180c0","content":"<h4 class=\"title\">Van Stock</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"f4cfa9ce-8679-4edb-aa07-a37eb7b3a2b3","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"14915f6c-b371-45e9-a988-10617e0a1182","function":"open"},"_auto_id_":"e9954d8c-b7c6-4805-aad8-ff31d55ab79d"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"33226882-98b0-4164-945a-a9cf8f4dfb41","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"061a08ff-1035-456d-8aa7-390a0817f445"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"566731af-c2ff-43d9-8b74-6e3f9352c598","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"95ad6276-80d9-4bd7-886a-b9466b8e7426"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"a1bdf780-5e50-439c-8615-fff93aa2b379","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ef1063ff-c64e-4b49-a0d6-fc41b980de49"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"1087977f-78cd-496c-8fdd-45ae18b440a7","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"VanStockCodes","componentInstanceId":"e2a907b0-27ed-4ddf-9c28-70bdd3b09fc1","function":"show"},"_auto_id_":"649720bc-9af1-416e-ac6a-e5b4615a9f6c"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ba854e6e-eda8-487e-b913-6ef4066edc6c"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"c45f8aea-122c-4e42-a840-37bcea628cb6","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e91fde8b-17b4-44f7-8764-fa85bef9278a"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"efdd9640-532b-4144-9809-8bee0a82d10e","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"9f77415c-d796-464e-8061-096a825820ca"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"dc7598ab-0ad8-47f6-b332-19cfcc2310cb","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"cbc9f116-93af-4cf1-9910-497beb334526"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"e2a907b0-27ed-4ddf-9c28-70bdd3b09fc1","attributes":{},"expressions":{}}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"14915f6c-b371-45e9-a988-10617e0a1182","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"865aee22-63b6-43ec-9fe1-b9ea9174c09d","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_vanstocklocation","type":"content","item-type":"html","_auto_id_":"31b63351-65d0-4ab9-90b6-0b4bc0265789","content":"<h4>Van Stock Location: <span style=\"color:#0072C6;\">{{'$store.variables.selectedLocation.sLocation'|store}}</span></h4>\n<hr>\n<div id=\"panel\" class=\"sor-schedules-panel\">\n  <div id=\"schedules\" class=\"sor-schedules-schedules\" onclick=\"cti.fnSearchPanel('schedules');\">Van Stock</div>\n  <div id=\"search\" class=\"sor-schedules-search\" onclick=\"cti.fnSearchPanel('search');\">Search</div>\n</div>","expressions":{}},{"name":"SearchAllVanStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"c3341eb8-461e-4b21-89e2-0a4547054eea","_auto_id_":"316b5155-b496-4c4f-acbe-61a4fdbb6d57","attributes":{"sourceObjectArrayName":"cti.store.offlineApi.AccuServOffline.vanstock.aOperativeVanStock","displayArrayName":"cti.store.variables.vanStockSearchResults","displayListIfNoSearch":0,"maxResults":30,"minCharacters":3,"locationFilter":""},"expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[]},{"name":"htmlSearchHint","type":"content","item-type":"html","_auto_id_":"ba1887b1-410c-415a-9107-ff7e81986bee","content":"<br>\n<p>Please use the search facility above to find Van Stock codes that your require. The search facility is free text.</p>","expressions":{"show":"($store.variables.vanStockSearchResults===undefined || $store.variables.vanStockSearchResults.length==0) && $store.variables.menuOption === \"search\""}},{"name":"list_vanstock","type":"content","item-type":"list","_auto_id_":"dfdee3bb-f889-4518-adf2-47baac8959a2","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Adding Van Stock...');\n\nif(cti.store.jobs.selectedJob.aVanStock == undefined) {\n  cti.store.jobs.selectedJob.aVanStock = [];\n}\n\nvar vanStock = cti.store.jobs.selectedJob.aVanStock;\nvar code = {{$data.$item}};\nvar exisits = false;\n\nvar codeObj = code;\ncodeObj.sLocation = cti.store.variables.selectedLocation.sLocation || \"NOLOCATION\";\ncodeObj.nQtyUsed = 1;\n\nfor(var i in vanStock) {\n  if(vanStock[i].sStockCode == codeObj.sStockCode) {\n    if(vanStock[i].sLocation == codeObj.sLocation) {\n      exisits = true;\n      break;\n    }\n  }\n}\n\nif(!exisits) {\n  vanStock.unshift(codeObj);\n  \n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodeadded\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"success\",\n      \"title\" : \"Van Stock Added\",\n      \"text\" : \"You have successfully added this Van Stock item to the Job.\"\n    }\n  );\n\n  cti.utils.callAction('call-component-function', { \"page\" : \"VanStockCodes\",\"componentInstanceId\":\"8d742a88-9c0d-4b70-b7bd-1b8ef96568eb\",\"function\":\"bind\"});\n  cti.utils.updatePage();\n  \n  cti.store.variables.menuOption = \"schedules\";\n  cti.fnSearchPanel(cti.store.variables.menuOption);\n} else {\n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have already added this Van Stock Code to the Job.\"\n    }\n  );\n}"},"_auto_id_":"df2bcc99-1d74-485a-b4b1-d33381c52699"}],"model":"$store.variables.vanStockSearchResults","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_vanstock_html","_auto_id_":"2a880337-e3b0-476f-b58a-31bad47262d5","content":"<div style=\"display:block;width:100%\">\n  <div style=\"padding-bottom:10px;font-weight:bold;\">Van Stock Code: {{$data.$item.sStockCode}}</div>\n  <div>{{$data.$item.sStockDescription}}</div>\n</div>","expressions":{}}],"pagination":true,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":3},{"name":"SearchJobVanStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"c3341eb8-461e-4b21-89e2-0a4547054eea","_auto_id_":"d49e3779-7d34-43ac-a697-aa39b805f4c5","attributes":{"sourceObjectArrayName":"cti.store.jobs.selectedJob.aVanStock","displayArrayName":"cti.store.variables.vanStockJobSearchResults","displayListIfNoSearch":1,"maxResults":30,"minCharacters":3,"locationFilter":"cti.store.variables.selectedLocation.sLocation"},"expressions":{"show":"$store.variables.menuOption === \"schedules\""},"actions":[]},{"name":"html_vanstockcodesadded","type":"content","item-type":"html","_auto_id_":"143883a4-6c75-4344-90e0-e19ba827d0d6","content":"<br>\n<p>Please confirm quantities for the below Van Stock codes added to this job.</p>","expressions":{"show":"$store.variables.menuOption === \"schedules\""}},{"name":"list_vanstocksummary","type":"content","item-type":"list","_auto_id_":"2eb0dfd6-f28c-41c9-bcb3-63339170509c","search":"","classes":"","expressions":{"show":"$store.variables.menuOption === \"schedules\""},"theme":"bootstrap","model":"$store.variables.vanStockJobSearchResults","actions":[],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_vansummary_html","_auto_id_":"d643b310-ed84-421a-b595-9a95b69ff1ee","content":"<div class=\"inlineblock-outer\">\n    <div class=\"inlineblock-outer\">\n        <div class=\"sor-header\">{{$data.$item.sStockCode}}</div>\n    </div>\n    <div>{{$data.$item.sStockDescription}}</div>\n</div>\n<hr>","expressions":{}},{"name":"HeaderQuantityDone","type":"content","item-type":"html","_auto_id_":"3124ae25-5190-4215-83a8-40f696ea0e79","content":"<div class=\"sor-list-header\">Quantity Done</div>","expressions":{},"classes":""},{"name":"qntyDoneRow","type":"area","item-type":"row","_auto_id_":"45adf09f-15c1-46bc-843b-910e9b8550f5","content":[{"name":"btnUsedMinus","type":"button","item-type":"button","_auto_id_":"6a10c996-484d-47e9-b39d-c7aff752c7cd","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQtyDoneThisVisit<1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyUsed = $data.$item.nQtyUsed - 1;"},"_auto_id_":"36fcf44d-5579-4d96-8b02-20baf71da803"}]},{"name":"QuantityDone","type":"content","item-type":"html","_auto_id_":"63f87ceb-6d8f-418a-89b3-4398439935fe","content":"{{$data.$item.nQtyUsed}}","expressions":{},"classes":"sor-value"},{"name":"btnUsedPlus","type":"button","item-type":"button","_auto_id_":"4deb2fd9-06b5-4b90-8a1b-a3c38a7ea168","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyUsed = $data.$item.nQtyUsed + 1;"},"_auto_id_":"5eca91d4-d1bb-4fd5-a010-a8b7f5a369c5"}]}],"expressions":{}}]},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"c202d979-0685-4943-a1ff-5c8ed09d6f85","content":"Save","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ndelete cti.store.variables.vanStockSearchResults;\ndelete cti.store.variables.vanStockJobSearchResults;\ndelete cti.store.variables.selectedLocation;\ndelete cti.store.variables.menuOption;\n\ncti.utils.callAction('go-to-page', { \"name\": \"VanLocationSelect\" });"},"_auto_id_":"5fe4b423-a1c8-493c-9c3e-92138fdbda25"}],"classes":"confirm-bar-btn"}],"_auto_id_":"0e9ce7c9-d348-4d1c-99ba-f397bfebecc8","expressions":{}}]},{"start":false,"name":"VanLocationSelect","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"ec7b99f0-8a66-4efb-9874-9f4cfd96b5ea","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"$( \"#vanLocationFetch\" ).click(function() {\n  cti.utils.callAction('call-actionflow',{'name':'OnlineStockLocations'});\n});\n\ncti.fnOrderVanLocations();\n$success();"},"_auto_id_":"e9ddc450-31ba-44a4-be39-6d19494b9078"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"f0463c4a-e48f-40a5-bb49-6b763e509e23","content":"<h4 class=\"title\">Van Stock Select Location</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"b2ff6d5f-686d-44c6-9d83-5c234c89015e","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"7ea4ba23-f4a2-46be-8356-0ecfb8524dbd","function":"open"},"_auto_id_":"7073b4ab-5403-4f7b-9e57-04a897aeb01a"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bffca8a1-9fa1-4445-8007-b0fd51a6175c","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"8bc2feef-5551-4996-b40a-48891bfc7a9f"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"b0a50e22-a323-44fd-9146-3ef44db2050e","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"79a9c870-428a-4ab3-b8e3-45cebb4ed6c5"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"42370bca-9729-48f8-af54-e89c6a1d09cd","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"bdec95b8-02ff-4ab2-9207-347cf110bbd8"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"3671f5bf-239e-47e0-95a2-86ca18cf3594","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"VanLocationSelect","componentInstanceId":"5532bb0c-dcdb-48c6-bbe6-5e1c24bea4c2","function":"show"},"_auto_id_":"f28506bc-fc4c-43d3-a432-191cf82aec3c"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"414581eb-0d6e-4701-a786-7a2d082ba96c"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"81410008-2004-4ba9-86ed-0a79f1af1b0a","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"dd0ba75c-899a-4af8-b47c-606e6bdf5be3"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"4d75a6b4-fb12-490b-add2-8e6b95813a3a","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"5fde1ff6-9c42-4c5a-9e5c-87661939b65b"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"c5e6376c-878a-4428-8d64-8dd6bf7bc705","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"b0e6ff12-3ac5-42eb-a388-d0dabdc78534"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"7ea4ba23-f4a2-46be-8356-0ecfb8524dbd","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"693f640a-5c12-41b3-a847-bd23eaf6fc26","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"5532bb0c-dcdb-48c6-bbe6-5e1c24bea4c2","attributes":{},"expressions":{}},{"name":"html_vanheader","type":"content","item-type":"html","_auto_id_":"61d216e8-5293-4ab3-bb7a-f0adc9c8d752","content":"<div class=\"codes-icon\">\n\t<i class=\"fa fa-truck\"></i>\n</div>\n<h4 class=\"codes-icon-header\">Van Stock Codes</h4>","expressions":{}},{"name":"jobLocationsEmpty","type":"content","item-type":"html","_auto_id_":"7adb9657-f2d7-408f-8af3-5e1aa50b99ca","content":"<h4 style=\"text-align:center;\">Failed to Download Van Stock Locations</h4><p style=\"text-align:center;\">Currently you do not have any available Van Stock Locations on device. Please contact your Supervisor or try downloading the Stock by tapping the below icon.</p>\n<div style=\"color:#0072C6;text-align:center;font-size:30pt;width:100%\" id=\"vanLocationFetch\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.jobLocations == false"}},{"name":"vanStockEmpty","type":"content","item-type":"html","_auto_id_":"453752ca-ded8-4299-a6c4-8b7f5a27c47c","content":"<h4 style=\"text-align:center;\">No Van Stock for Current Operative</h4><p style=\"text-align:center;\">{{'$store.variables.noVanStock'|store}}</p><p style=\"text-align:center;\">Currently you do not have any available Van Stock assigned to your operative ID. Please contact your Supervisor immediately.</p>","expressions":{"show":"$store.variables.noVanStock != undefined"}},{"name":"list_location","type":"content","item-type":"list","_auto_id_":"d94fed79-8fad-4991-9849-69edf696e601","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.noVanStock === undefined"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Loading Van Stock...');\n\ncti.store.variables.selectedLocation = {{$data.$item}};\n\nif(cti.store.offlineApi.AccuServOffline.vanstock != undefined) {\n  var stock = cti.store.offlineApi.AccuServOffline.vanstock.aOperativeVanStock;\n  var vanStock = cti.store.jobs.selectedJob.aVanStock;\n  var selectedLocation = cti.store.variables.selectedLocation;\n  var exists = false;\n\n  for(var i in vanStock) {\n    if(vanStock[i].sLocation == selectedLocation.sLocation) {\n      exists = true;\n      break;\n    }\n  }\n\n  if(exists) {\n    cti.store.variables.menuOption = \"schedules\";\n  } else {\n    if(selectedLocation.sVanStockQuantity != 0) {\n      cti.store.variables.menuOption = \"schedules\";\n    } else {\n      cti.store.variables.menuOption = \"search\";\n    }\n  }\n\n  cti.store.variables.vanStockSearchResults = [];\n  var count = 10;\n  \n  for(var i in stock) {\n    if(count === 0) {\n      break;\n    } else {\n      count--;\n      cti.store.variables.vanStockSearchResults.push(stock[i]);\n    }\n  }\n  \n  cti.utils.callAction('go-to-page', { \"name\": \"VanStockCodes\" });\n\n  $success();\n} else {\n  cti.utils.callAction('call-actionflow', { \"name\": \"OnlineVanCodes\" });\n}\n\ncti.fnCloseSpinner();"},"_auto_id_":"be4d9298-3aba-45ca-8925-a9f95b3e643a","actions":[]}],"model":"$store.jobs.locationsVanStock","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_location_html","_auto_id_":"02428367-0ef1-42e2-9132-451d7e2ba6eb","content":"<div class=\"list-item-container\">\n  <div class=\"list-location\">{{$data.$item.sDescription}} <span style=\"color:#0072C6\">{{$data.$item.sVanStockQuantity}}</span></div>\n  <div class=\"{{$data.$item.sLocationClass}}\"></div>\n</div>"}]},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"69513f08-1be7-44a2-93a9-323f699a8355","content":"Show More","theme":"default","expressions":{"show":"($store.variables.showFullLocations === false || $store.variables.showFullLocations === undefined) && $store.variables.noVanStock === undefined"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = true;\ncti.fnOrderVanLocations();"},"_auto_id_":"c1e2a0a9-2f90-46ab-9867-1fb5e4a90065"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"ae891a02-3fa5-433a-a40b-daab1f4bbf5d","content":"Show Less","theme":"default","expressions":{"show":"$store.variables.showFullLocations === true && $store.variables.noVanStock === undefined"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ncti.fnOrderVanLocations();"},"_auto_id_":"4cc5c884-f88e-4ed1-9b45-f54e66865dc5"}],"classes":"showlist-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"63d2a732-46dc-4c06-9c3b-44f51b45fa9e","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"e42b50d0-4d43-4992-b5a4-644d2c5558b7","content":"Back","theme":"default","expressions":{"show":"$store.variables.vanNav === false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.lastVanStockPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"1280307c-da9e-4e53-bc8b-e104d07240cd"}],"classes":"button-bar-btn"},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"d5ce5b01-8aec-482e-998d-8bca70976cf0","content":"Previous","theme":"default","expressions":{"show":"$store.variables.vanNav === true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigateSORCodes(cti.store.state.currentPage, true);"},"_auto_id_":"25df00fd-f16d-4111-9777-d655876ebe4a"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"c9727bab-c214-49af-a2a7-73bc037dc511","content":"Complete","theme":"default","expressions":{"show":"$store.variables.vanNav === true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigatePO(cti.store.state.currentPage);"},"_auto_id_":"248093e4-e31b-4e1f-8790-00ac1e3fee19"}]}],"expressions":{}}],"_auto_id_":"8ed9dbdd-d19f-4bb0-adcb-5d929bd9aebb","expressions":{}}]},{"start":false,"name":"SORCodes","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"ef36dc52-f702-4bd3-b565-e8c8c9561ddc","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"// Example of setting up handlers do deal with quantity changes from the numeric-toggler components\nfunction valueChangeHandler(e) {\n \te = e || window.event;\n\tvar targ = e.target || e.srcElement;\n    console.log(targ.id + ' has new value = ' + targ.quantity);\n}\n\nvar togglers = document.getElementsByTagName(\"numeric-toggler\");\nfor (var i = 0; i < togglers.length; i++) {\n  togglers[i].removeEventListener('changed', valueChangeHandler);\n  togglers[i].addEventListener('changed', valueChangeHandler, true);\n}\n$success();"},"_auto_id_":"111bd572-b1c7-4834-8089-a9f8eee76a0b","actions":[]},{"event":"onload","type":"call-function","data":{"name":"fnSearchPanel","params":{"menuOption":"{{$store.variables.menuOption}}"}},"_auto_id_":"c914d67a-cf48-4ab1-acf8-b45f1da3ef18"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"3a0475c2-3d48-4dd8-a0a0-09e409134060","content":"<h4 class=\"title\">SOR Codes: <span style=\"color:#0072C6;\">{{'$store.variables.selectedLocation.sDescription'|store}}</span></h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"207c8e55-bdbc-4647-a5ab-c77831519c4f","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"980a4bb5-2aae-4536-9fa0-5f707ea295a3","function":"open"},"_auto_id_":"38a5e7b6-dd2a-42c2-afab-e8092cb49c31"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"feeb45cc-af02-420a-b365-b1ebdc134cf2","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle"},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"e6da74a4-78ee-428a-afb0-f0c4dc602f0e","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"2295eb4d-f4a2-4524-b64c-e06984823c4c"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"18aceffe-49c3-428a-a01e-46a58e055b8a","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a4f3b7dd-f3a6-4936-be51-d44793a553d9"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"6b83a3ec-e027-47cd-95a4-b5c5abccb0db","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"SORCodes","componentInstanceId":"dd4b1c58-4b27-4180-88f0-1c5e0e071522","function":"show"},"_auto_id_":"528aec5e-8c8e-415d-b005-87379c118f06"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b71028e4-413c-4385-b1ad-7578ec518081"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"213ba608-255f-4c0e-8045-e9b0aabdb875","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f16cde9c-9728-4386-83a1-575c283cff94"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"73fd420e-920b-46f8-9225-54be2c9d17d6","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"1b61803c-9d7c-481b-8c0c-dbc6fed30a2f"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"d2e89bfe-7ddc-45e1-b5fb-9b492f114ff5","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"deb7a88f-cebe-428b-8afe-8cdb54a7c604"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"dd4b1c58-4b27-4180-88f0-1c5e0e071522","attributes":{},"expressions":{}}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"980a4bb5-2aae-4536-9fa0-5f707ea295a3","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"09c266b6-a383-43f9-b65c-8822f29b20d5","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_sorlocation","type":"content","item-type":"html","_auto_id_":"f0ef0752-8b68-4dd9-8d03-7a2808884de3","content":"<div id=\"panel\" class=\"sor-schedules-panel\">\n  <div id=\"schedules\" class=\"sor-schedules-schedules\" onclick=\"cti.fnSearchPanel('schedules');\">Schedules</div>\n  <div id=\"search\" class=\"sor-schedules-search\" onclick=\"cti.fnSearchPanel('search');\">Search</div>\n</div>","expressions":{}},{"name":"SearchAllSORCodes","type":"component","item-type":"web-component","content":[],"componentId":"c3341eb8-461e-4b21-89e2-0a4547054eea","_auto_id_":"9db595b8-1e71-4e15-9de0-3ea5d862e2ea","attributes":{"sourceObjectArrayName":"","displayArrayName":"cti.store.variables.sorCodeSearchResults","displayListIfNoSearch":0,"maxResults":50,"minCharacters":3,"locationFilter":""},"expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[],"classes":"sors-all"},{"name":"htmlSearchHint","type":"content","item-type":"html","_auto_id_":"8e3abbc7-ebb3-48f5-beb7-2fad56c1b55c","content":"<br>\n<p>Please use the search facility above to find Schedule Of Rates codes that your require. The search facility is free text.</p>","expressions":{"show":"($store.variables.sorCodeSearchResults===undefined || $store.variables.sorCodeSearchResults.length==0) && $store.variables.menuOption === \"search\""}},{"name":"list_sorcodes","type":"content","item-type":"list","_auto_id_":"16297cff-a343-424d-b349-9a8d11f502e1","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var exceededBand = cti.fnSORAlgorithms(false, false);\ncti.store.variables.exceededBand = exceededBand;\n\nif(cti.store.variables.exceededBand) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have exceeded Band C for the Job Cost Variation Bandings. You are not permitted to add any more SOR codes, or increase the quanitity of your current SOR codes until you are back within Band B.\"\n    }\n  );\n} else {  \n  cti.fnOpenSpinner('Adding SOR Code...');\n\n  var sorCodes = cti.store.jobs.selectedJob.aItemGroups;\n  var code = {{$data.$item}};\n  var exists = false;\n\n  var codeObj = code;\n  codeObj.sLocation = cti.store.variables.selectedLocation.sLocation || \"NOLOCATION\";\n  codeObj.nQtyRequired = 1;\n  codeObj.nQtyDoneThisVisit = 0;\n  codeObj.nQtyRemaining = 1;\n  codeObj.bAccuServCode = false;\n\n  for(var i in sorCodes) {\n    if(sorCodes[i].sCode == codeObj.sCode) {\n      if(sorCodes[i].sLocation == codeObj.sLocation) {\n        exists = true;\n        break;\n      }\n    }\n  }\n\n  if(!exists) {\n    sorCodes.unshift(codeObj);\n\n    cti.fnCloseSpinner();\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodeadded\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"success\",\n        \"title\" : \"SOR Code Added\",\n        \"text\" : \"You have successfully added this SOR Code to the Job.\"\n      }\n    );\n\n    cti.utils.callAction('call-component-function', { \"page\" : \"SORCodes\",\"componentInstanceId\":\"506ab6a8-0172-4024-a0e6-ae59ed29f1ee\",\"function\":\"bind\"});\n    cti.utils.updatePage();\n\n    cti.store.variables.menuOption = \"schedules\";\n    cti.fnSearchPanel(cti.store.variables.menuOption);\n  } else {\n    cti.fnCloseSpinner();\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodematch\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"Warning\",\n        \"text\" : \"You have already added this SOR Code to the Job in this Location.\"\n      }\n    );\n  }\n}"},"_auto_id_":"211bacf5-6a27-4c34-80fd-e84860d0ed9c"}],"model":"$store.variables.sorCodeSearchResults","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_sorcodes_html","_auto_id_":"796a0e10-1d11-4080-9eff-c1fb771eb8de","content":"<div style=\"display:block;width:100%\">\n  <div style=\"padding-bottom:10px;font-weight:bold;\">SOR Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>"}],"pagination":true,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":3},{"name":"SearchJobSORCodes","type":"component","item-type":"web-component","content":[],"componentId":"c3341eb8-461e-4b21-89e2-0a4547054eea","_auto_id_":"1d08b93f-d7fa-40a0-90da-edc870d838bb","attributes":{"sourceObjectArrayName":"cti.store.jobs.selectedJob.aItemGroups","displayArrayName":"cti.store.variables.sorCodeJobSearchResults","displayListIfNoSearch":1,"maxResults":30,"minCharacters":3,"locationFilter":"cti.store.variables.selectedLocation.sLocation"},"expressions":{"show":"$store.variables.menuOption === \"schedules\""},"actions":[],"classes":"sors-on-job"},{"name":"html_sorcodes_schedules","type":"content","item-type":"html","_auto_id_":"2c428e3a-a434-4845-985b-262989f408b7","content":"<br>\n<p>Please confirm quantities for the below SOR codes added to this job.</p>","expressions":{"show":"$store.variables.menuOption === \"schedules\""}},{"name":"list_sorsummary","type":"content","item-type":"list","_auto_id_":"f4c4f9dd-b45b-4212-9e1f-7d05b7af6ddf","search":"","classes":"","expressions":{"show":"$store.variables.menuOption === \"schedules\""},"theme":"bootstrap","model":"$store.variables.sorCodeJobSearchResults","actions":[],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_sorsummary_html","_auto_id_":"d4cacb75-a9f2-4402-9465-d05f8f9fb6b9","content":"<div class=\"inlineblock-outer\">\n    <div class=\"inlineblock-outer\">\n        <div class=\"sor-header\">{{$data.$item.sCode}}</div>\n        <div class=\"estimated\">Estimated: {{$data.$item.nQtyRequired}}\t</div>\n    </div>\n    <div>{{$data.$item.sLongDescr}}</div>\n</div>\n<hr>"},{"name":"HeaderQuantityDone","type":"content","item-type":"html","_auto_id_":"394c966f-430a-46aa-a93a-41c0becc7d2b","content":"<div class=\"sor-list-header\">Quantity Done</div>","expressions":{},"classes":""},{"name":"qntyDoneRow","type":"area","item-type":"row","_auto_id_":"c33f7f2c-6a94-430d-88b3-d96c27c874aa","content":[{"name":"btnUsedMinus","type":"button","item-type":"button","_auto_id_":"87aa1a00-07c5-4a27-97fc-3f58c9bde11e","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQtyDoneThisVisit<1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyDoneThisVisit = $data.$item.nQtyDoneThisVisit - 1;\n$data.$item.nQtyRemaining = $data.$item.nQtyRemaining + 1;\n\ncti.fnSORAlgorithms(false, false);"},"_auto_id_":"6f16c67e-761e-4fad-9f3b-c000f8ca28fe"}]},{"name":"QuantityDone","type":"content","item-type":"html","_auto_id_":"27c22eaa-dbd1-44f9-8c9f-b5eeaea81b69","content":"{{$data.$item.nQtyDoneThisVisit}}","expressions":{},"classes":"sor-value"},{"name":"btnUsedPlus","type":"button","item-type":"button","_auto_id_":"cd2c8e57-5ac9-462e-b5cc-c8a05bdb8e03","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if($data.$item.nInitialQty === undefined) {\n  $data.$item.nInitialQty = $data.$item.nQtyRemaining;\n}\n\n$data.$item.nQtyDoneThisVisit = $data.$item.nQtyDoneThisVisit + 1;\nif($data.$item.nQtyRemaining > 0) {\n  $data.$item.nQtyRemaining = $data.$item.nQtyRemaining - 1;\n}\n\nvar exceededBand = cti.fnSORAlgorithms(false, false);\ncti.store.variables.exceededBand = exceededBand;\n\nif($data.$item.nQtyRemaining > 0 ) {\n  delete cti.store.variables.exceededBand;\n} else if($data.$item.nQtyDoneThisVisit <= $data.$item.nInitialQty) {\n  delete cti.store.variables.exceededBand;\n}\n\nif(cti.store.variables.exceededBand) {\n  $data.$item.nQtyDoneThisVisit = $data.$item.nQtyDoneThisVisit - 1;\n  if($data.$item.nQtyRemaining > 0) {\n    $data.$item.nQtyRemaining = $data.$item.nQtyRemaining + 1;\n  }\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"style\" : \"warning\",\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have exceeded Band C for the Job Cost Variation Bandings. You are not permitted to add any more SOR codes, or increase the quanitity of your current SOR codes until you are back within Band B.\"\n    }\n  );\n}"},"_auto_id_":"63e3f31d-915f-473f-bbdd-f787d16e7926","actions":[]}]}],"expressions":{}},{"name":"HeaderQuantityRemaining","type":"content","item-type":"html","_auto_id_":"dcbcf0f9-468b-4b0c-8f70-7863a2782d44","content":"<div class=\"sor-list-header\">Remaining</div>","expressions":{},"classes":""},{"name":"qntyRemainingRow","type":"area","item-type":"row","_auto_id_":"54e465f8-1142-48e5-a351-6fca1ebb5fc9","content":[{"name":"btnRemainingMinus","type":"button","item-type":"button","_auto_id_":"f62ff961-6c59-448d-a3b3-a1a3623a3476","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQtyRemaining<1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyRemaining = $data.$item.nQtyRemaining -1;\n\n// Update the jobcost and ignore any band variation checks\ncti.fnSORAlgorithms(false, true);"},"_auto_id_":"2e405c85-8711-4a7e-bcbc-3abcb8e2ee97"}]},{"name":"QuantityRemaining","type":"content","item-type":"html","_auto_id_":"24f592e7-ddcc-46ee-a1bf-981bdc9daa9e","content":"{{$data.$item.nQtyRemaining}}","expressions":{},"classes":"sor-value"},{"name":"btnRemainingPlus","type":"button","item-type":"button","_auto_id_":"c73776c0-bff9-4ef3-a93e-33611552a41a","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if($data.$item.nInitialQty === undefined) {\n  $data.$item.nInitialQty = $data.$item.nQtyRemaining;\n}\n\n$data.$item.nQtyRemaining = $data.$item.nQtyRemaining + 1;\n\nvar exceededBand = cti.fnSORAlgorithms(false, false);\ncti.store.variables.exceededBand = exceededBand;\n\nvar total = $data.$item.nQtyRemaining + $data.$item.nQtyDoneThisVisit;\nif(total <=  $data.$item.nInitialQty) {\n  delete cti.store.variables.exceededBand;\n}\n\nif(cti.store.variables.exceededBand) {\n  $data.$item.nQtyRemaining = $data.$item.nQtyRemaining - 1;\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warning\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have exceeded Band C for the Job Cost Variation Bandings. You are not permitted to add any more SOR codes, or increase the quanitity of your current SOR codes until you are back within Band B.\"\n    }\n  );\n}"},"_auto_id_":"5dd2d149-20fe-4b1d-9c39-a7ead9c80986"}]}],"expressions":{}}]},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"954ddc1a-9fe5-411c-8ff4-7acab1fdc808","content":"Save","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ndelete cti.store.variables.sorCodeSearchResults;\ndelete cti.store.variables.sorCodeJobSearchResults;\ndelete cti.store.variables.selectedLocation;\ndelete cti.store.variables.menuOption;\n\ncti.utils.callAction('go-to-page', { \"name\": \"SORLocationSelect\" });"},"_auto_id_":"8320b68a-2cf6-4dde-a591-4e3767244350"}],"classes":"confirm-bar-btn"}],"_auto_id_":"929584fb-f89e-45e5-a68f-b3628fa129bf","expressions":{}}]},{"start":false,"name":"SORLocationSelect","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"b2f365c1-dd44-4b38-9847-34f34060c92e","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"$( \"#sorLocationFetch\" ).click(function() {\n  cti.utils.callAction('call-actionflow',{'name':'OnlineStockLocations'});\n});\n\ncti.fnOrderSORLocations();\n$success();"},"_auto_id_":"6353ee9f-7611-4be4-a874-992cdec4d5e6"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"2bc3ef0f-cbbd-4991-8001-e7fd10fafa15","content":"<h4 class=\"title\">SOR Select Location</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"b945d20c-cebc-4d7b-b519-3d8ff033869d","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"c4807c1a-09f2-4bbc-bde4-5b813121c5cd","function":"open"},"_auto_id_":"75123fbf-69ae-4aa7-a604-db0ad24ad114"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"ef4bb5a3-f2cb-4ddd-88be-b422d02f851d","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"3905b6ac-9abf-47bb-9df9-e6f14b532a5c"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"8e5a00b5-8fce-492e-b8da-50484bb5b367","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"2a679118-3dcf-4ff8-8743-ce04368d5399"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"e39df987-08b5-44d8-9321-16a4cd9fed2b","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"79964419-4b3d-4f70-a0e7-caaa16c59216"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"c718f83e-126b-4e18-857b-387d761d70bf","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"SORLocationSelect","componentInstanceId":"28c5532b-f7bf-43d3-85dd-7a673051085d","function":"show"},"_auto_id_":"88905d3f-ad80-4e11-9fe4-05757e618bb7"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"229ebdbb-eb5a-41a6-b227-f94bee1a947d"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"ed653381-5d3f-4f4d-87a2-3972fa3cf0ac","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cf95c657-235a-4f21-9628-8e872d3950fb"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"6ce65499-4966-46fb-a8b3-298399593a67","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"412cdb3e-76ba-45cf-988a-2f1a845cb40d"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"5af4c5ea-18cb-428e-ad92-1e70858ccded","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"11e7bd3b-249d-4c3b-921a-871fd65560c9"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"c4807c1a-09f2-4bbc-bde4-5b813121c5cd","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"d798eada-59f6-43fd-9f96-9f138fb4d55a","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"28c5532b-f7bf-43d3-85dd-7a673051085d","attributes":{},"expressions":{}},{"name":"html_sorheader","type":"content","item-type":"html","_auto_id_":"8a071b34-853d-4e3f-8f02-875f6a5f4027","content":"<div class=\"codes-icon\">\n\t<i class=\"fa fa-barcode\"></i>\n</div>\n<h4 class=\"codes-icon-header\">Schedule of Rate Codes</h4>","expressions":{}},{"name":"jobLocationsEmpty","type":"content","item-type":"html","_auto_id_":"0b99c72f-af8e-48b8-a067-581811da2cdb","content":"<h4 style=\"text-align:center;\">Failed to Download SOR Locations</h4><p style=\"text-align:center;\">Currently you do not have any available SOR Stock Locations on device. Please contact your Supervisor or try downloading the Stock by tapping the below icon.</p>\n<div style=\"color:#0072C6;text-align:center;font-size:30pt;width:100%\" id=\"sorLocationFetch\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.jobLocations == false"}},{"name":"list_location","type":"content","item-type":"list","_auto_id_":"2fbd1a28-aba4-4b46-94fd-1bb58d535a9b","search":"","classes":"","theme":"bootstrap","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Loading SOR Codes...');\n\ncti.store.variables.selectedLocation = {{$data.$item}};\n\nif(cti.store.variables.selectedLocation.sLocation == \"NOLOCATION\") {\n  cti.store.variables.selectedLocation.sDescription = \"No Location\";\n}\n\nwindow.appManager.loadFromDatabase('sordata', function (doc) {\n  cti.fnCloseSpinner();\n\n  var sorCodes = cti.store.jobs.selectedJob.aItemGroups;\n  var selectedLocation = cti.store.variables.selectedLocation;\n  var exists = false;\n\n  for(var i in sorCodes) {\n    if(sorCodes[i].sLocation == selectedLocation.sLocation) {\n      exists = true;\n      break;\n    }\n  }\n\n  if(exists) {\n    cti.store.variables.menuOption = \"schedules\";\n  } else {\n    if(selectedLocation.sSORCodesQuantity != 0) {\n      cti.store.variables.menuOption = \"schedules\";\n    } else {\n      cti.store.variables.menuOption = \"search\";\n    }\n  }\n\n  cti.store.variables.sorCodeSearchResults = [];\n  var count = 50;\n  \n  for(var i in doc.data) {\n    if(count === 0) {\n      break;\n    } else {\n      count--;\n      cti.store.variables.sorCodeSearchResults.push(doc.data[i]);\n    }\n  }\n    \n  cti.utils.callAction('go-to-page', { \"name\": \"SORCodes\" });\n\n  $success();\n}, function (reason, err) {\n  cti.fnCloseSpinner();\n  cti.utils.callAction('call-actionflow', { \"name\": \"OnlineSORCodes\" });\n});"},"_auto_id_":"b286bdc7-c03b-48b9-a95c-a7d78277f19d","actions":[]}],"model":"$store.jobs.jobSORLocations","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_location_html","_auto_id_":"517267de-daaf-45c8-bc5c-416da36bc138","content":"<div class=\"list-item-container\">\n  <div class=\"list-location\">{{$data.$item.sDescription}} <span style=\"color:#0072C6\">{{$data.$item.sSORCodesQuantity}}</span></div>\n  <div class=\"{{$data.$item.sLocationClass}}\"></div>\n</div>"}],"pagination":false,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"Prev","paginationNextLabel":"Next","paginationLastLabel":"Last","paginationPrevNext":false,"paginationFirstLast":false,"paginationPagesToDisplay":null},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"49bb8905-f715-48e2-8989-860c01da4b90","content":"Show More","theme":"default","expressions":{"show":"$store.variables.showFullLocations === false"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = true;\ncti.fnOrderSORLocations();"},"_auto_id_":"afd6b0f5-875a-4c27-a2f7-91a9c568835f"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"8c973cc1-9ce3-47e0-abfe-48a6e0bccb71","content":"Show Less","theme":"default","expressions":{"show":"$store.variables.showFullLocations === true"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ncti.fnOrderSORLocations();"},"_auto_id_":"4e7f60e2-256e-43aa-b9d9-b4424fe61d6d"}],"classes":"showlist-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"3d016125-893e-44b7-81c5-8086d5ac7ed8","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"49921639-5967-4fa7-ac9e-f129167c8066","content":"Back","theme":"default","expressions":{"show":"$store.variables.sorNav === false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\nvar lastJobCost = cti.store.variables.lastJobCost;\n\nif(jobCost != lastJobCost) {\n  cti.fnSORAlgorithms(true, false);\n} else {\n  cti.fnSORAlgorithms(false, false);\n}\n\ndelete cti.store.variables.lastJobCost;\nvar lastPage = cti.store.variables.lastSORPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"d968251c-a7ff-4178-b111-cad6174125e1","actions":[]}],"classes":"button-bar-btn"},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"17ad61cb-e259-438d-bbdc-21342ea18499","content":"Previous","theme":"default","expressions":{"show":"$store.variables.sorNav === true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\nvar lastJobCost = cti.store.variables.lastJobCost;\n\nif(jobCost != lastJobCost) {\n  cti.fnSORAlgorithms(true, false);\n} else {\n  cti.fnSORAlgorithms(false, false);\n}\n\ndelete cti.store.variables.lastJobCost;\ncti.store.variables.lastSORPage = \"CustomerSignature\";\ncti.utils.callAction('go-to-page', { \"name\": \"CustomerSignature\" });"},"_auto_id_":"d7898a33-ff7e-4290-845b-f02e14a93ba6"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"d34b3ceb-ed74-421e-9419-a469b5ed577c","content":"Complete","theme":"default","expressions":{"show":"$store.variables.sorNav === true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var sorCodesOnJob = cti.store.jobs.selectedJob.aItemGroups;\nvar result = true;\n\nfor(var i in sorCodesOnJob) {\n  var currentSor = sorCodesOnJob[i];\n  \n  if(currentSor.nQtyRemaining != 0) {\n    result = false\n    break;\n  }\n}\n\nif(result) {\n  var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\n  var lastJobCost = cti.store.variables.lastJobCost;\n\n  if(jobCost != lastJobCost) {\n    cti.fnSORAlgorithms(true, false);\n  } else {\n    cti.fnSORAlgorithms(false, false);\n  }\n  \n  delete cti.store.variables.lastJobCost;\n  cti.fnNavigateVanStock(cti.store.state.currentPage);\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodesfailed\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"There are still SOR Codes that need completing on the job.\"\n    }\n  );\n}"},"_auto_id_":"21baead7-9bfa-489d-a719-045616165f39"}]}],"expressions":{}}],"_auto_id_":"c1168392-351c-46a2-a694-def26f9f5021","expressions":{}}]},{"start":false,"name":"CustomerSignature","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"e4cb9b76-93f2-4e96-b402-e46dfbdbd15b","content":"<h4 class=\"title\">Customer Signature</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"af6a50f0-d9fa-4a30-a2fa-c3c710c27f7f","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"CustomerSignature","componentInstanceId":"5d1490f9-a3e5-474a-bf16-e99208001b5b","function":"open"},"_auto_id_":"15038a91-0461-450a-8e67-a585871e36ea"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"95de229b-6c8f-49a3-8a4a-7125c0a0d6d6","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"d6c1834a-ff5d-4ad0-ae80-15d12da3a941"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"9cc39cf1-758b-4cd3-bb25-27f8d126a303","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3d93a5b1-bc1e-4c40-a7c3-3db94b736412"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"938d2d85-47b3-41b5-b240-fe812c40969e","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9ab29711-f2fd-46be-a216-34df3d9e280f"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"36d69f63-af88-4816-ac9d-1ab0e8510f0d","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ca2d8a90-8ff2-4111-bdff-6aa0fffe62d9"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"f21a7746-9f61-4652-95a6-4634e6e01f45","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"bdaed4fc-1f72-48db-a70d-6d8172ccb96a"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"de34a5d6-e294-470a-b777-bc645b31b31a","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cf90cff2-66da-4bf3-a468-796b0ac23c69"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"4897ac42-e44b-4447-ba77-1377bb6cbcc2","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b72a5807-c712-418a-b208-a1cb70b90f71"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"5f622599-a8f4-401f-ae46-8a91eea2b681","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"ac4ff492-813d-4ef1-864e-f183407cc144","actions":[]}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"5d1490f9-a3e5-474a-bf16-e99208001b5b","attributes":{},"expressions":{}}],"_auto_id_":"1f360d2f-446b-437e-bf24-66617e41cc78","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"4595f989-4477-4019-84e0-6eac3291213a","content":[{"name":"customerSignatureCheck","type":"choice","item-type":"radio","_auto_id_":"7b42d9b0-a36e-4f24-8d97-cfcd295af158","label":"Is the customer willing to sign?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.store.pages.CustomerSignature.reasonForNoSignature = undefined;\ncti.store.pages.CustomerSignature.customerSignature = undefined;\n\ncti.utils.updatePage();"},"_auto_id_":"5366fa29-48a6-459b-9e7a-2bbcce69d90e"}]},{"name":"reasonForNoSignature","type":"choice","item-type":"select","_auto_id_":"5e19534b-2eec-4c29-bddd-ed326ad44370","label":"No signature reason:","required":false,"options":[{"label":"COMMUNAL REPAIR","value":"COMMUNAL REPAIR"},{"label":"TENANT REFUSED","value":"TENANT REFUSED"},{"label":"TENANT UNABLE TO SIGN","value":"TENANT UNABLE TO SIGN"}],"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"0\""}},{"name":"tenantHomeNumber","type":"user-input","item-type":"text","_auto_id_":"a17ebb32-583f-47f0-ad45-d0d477a2c68e","label":"Tenant Home Number:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""}},{"name":"tenantMobileNumber","type":"user-input","item-type":"text","_auto_id_":"56de37ea-5f7c-4ce3-9718-0a69e9fcfa29","label":"Tenant Mobile Number:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""}},{"name":"customerSignature","type":"user-input","item-type":"signature","_auto_id_":"d080e9b9-ecab-4831-a653-dae7eb4d2167","label":"Tenant Signature","required":false,"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"2946f1f4-97d8-4e34-b73a-f90833aca8c1","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"00f93d8d-b408-42c4-a1c0-5d768c390b6a","content":"Previous","theme":"default","expressions":{"disabled":"$store.variables.selectedJob.travelended == false && $store.variables.selectedJob.lonedevice == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"f035e445-0afb-4673-975c-60e73fcad48b","actions":[]}]},{"name":"next_nosignature_btn","type":"button","item-type":"button","_auto_id_":"858ac2ca-0fd8-4c9f-bada-ef495198294d","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.CustomerSignature.reasonForNoSignature == undefined","show":"$store.pages.CustomerSignature.customerSignatureCheck == \"0\" || $store.pages.CustomerSignature.customerSignatureCheck == undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigateSORCodes(cti.store.state.currentPage, true);"},"_auto_id_":"24762c0d-187e-4950-834b-710e09d1621d"}]},{"name":"next_signature_btn","type":"button","item-type":"button","_auto_id_":"38221ded-cc9b-4cf0-b11b-2c3bd7a283b0","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.CustomerSignature.customerSignature == undefined","show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var homeNumber = cti.store.pages.CustomerSignature.tenantHomeNumber.replace(/\\s/g,'');\nvar mobNumber = cti.store.pages.CustomerSignature.tenantMobileNumber.replace(/\\s/g,'');\nvar propDetail = cti.store.jobs.selectedJob.aPropertyDetail;\nvar home = true;\nvar mob = true;\n\nif(homeNumber != \"\" && homeNumber != undefined) {\n  home = /^\\d+$/.test(homeNumber);\n  \n  if(home) {\n    if(homeNumber.length != 11) {\n      home = false;\n    }\n  }\n}\n\nif(mobNumber != \"\" && mobNumber != undefined) {\n  mob = /^\\d+$/.test(mobNumber);\n  \n  if(mob) {\n    if(mobNumber.length != 11) {\n      mob = false;\n    }\n  }\n}\n\nif(!home) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodesfailed\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning: Invalid Home Number\",\n      \"text\" : \"The Home Number entered is not a valid telephone number. Please make sure there are no letters or special characters in the text field.\"\n    }\n  );\n}\n\nif(!mob) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodesfailed\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning: Invalid Mobile Number\",\n      \"text\" : \"The Mobile Number entered is not a valid telephone number. Please make sure there are no letters or special characters in the text field.\"\n    }\n  );\n}\n\nif(home && mob) {\n  propDetail.sHome_No = cti.store.pages.CustomerSignature.tenantHomeNumber;\n  propDetail.sMobile_No = cti.store.pages.CustomerSignature.tenantMobileNumber;\n  \n  cti.fnNavigateSORCodes(cti.store.state.currentPage, true);\n}"},"_auto_id_":"d30a0b59-095c-4103-bfd8-142153c2cb50"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"FollowOnContinued","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"e599231d-a7bc-4e8f-96a6-6fda2a5496f0","content":"<h4 class=\"title\">Follow On Appointment</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"4f560347-4095-4776-82a7-8909dfaa86b7","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"FollowOnAppointment","componentInstanceId":"ec690e85-bb5e-4721-a85e-c151496ff8b2","function":"open"},"_auto_id_":"47cd9f4e-cff2-45d1-8a3c-aa0c8889912b"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"326825e7-a0fc-4bb3-ab92-407d14395f2b","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"10bda808-bd75-459b-912c-5d4b83ce2dd9"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"48fb53a7-d0d3-4cd5-af9c-13d6a400b16e","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"de2b3167-3e0d-4ae3-a29d-8ee6652cc4b7"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"cd0e1b4e-7660-4df6-971c-3d6ff865532a","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9e962c09-ed46-42e3-9824-1e17449650f0"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"9253f44c-a68c-456d-a971-6978d272c6d9","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6d5d233f-01f1-40a1-b42c-1d69b91204a4"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"346f3f1d-9028-496a-8992-8abccffc4a7b","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"09acf45f-355b-4f6b-90ef-1fd7c7f3eaa5"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"a5bb346c-39d8-4ced-8ae5-5e312bc907d2","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c4b69743-cc87-4ed6-b1d6-dfa37746fde3"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"257c237e-e29a-46d6-8393-fde081a87e62","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"71a1ccab-eccb-4a5a-9393-4eec70f6d0ae"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"df3f5219-026a-43e9-b912-018328266f70","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"87c9a882-bc8e-4ecb-bd4b-289fecbe0e06"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"ec690e85-bb5e-4721-a85e-c151496ff8b2","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"63cc70eb-0703-46ac-8f41-d736e96638af","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"41dbdd88-a0e7-4d49-ae5b-624660a655df","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"10687940-3993-4802-a338-7d1126d4a4c3","attributes":{},"expressions":{}},{"name":"html_followonbooking","type":"content","item-type":"html","_auto_id_":"55371499-c2ab-4195-bdca-59c5d533b9ea","content":"<p>Please ask the customer the earlist date they are available.</p>","expressions":{}},{"name":"followOnDate","type":"user-input","item-type":"date","_auto_id_":"8d482e5f-cf35-4d64-ac17-ebe86dca8da3","label":"Date to search from: ","required":true,"left-icon":"fa-calendar","expressions":{},"message":"This is a required field","options":{"min":"current"}},{"name":"followOnTradeReq","type":"choice","item-type":"select","_auto_id_":"a73ed04e-6f31-4d47-988d-b1f255c6625f","label":"Follow on trade required","required":true,"options":[],"expressions":{},"message":"This is a required field","option-source":"$store.staticData.tradesList","label-property":"sType","value-property":"sType","validators":[],"actions":[]},{"name":"followOnDays","type":"user-input","item-type":"number","_auto_id_":"4b2428cd-54f6-4cb3-84fe-cbf5fdfbc073","label":"Days to search over:","required":true,"decimals":0,"expressions":{},"message":"This is a required field","validators":[{"type":"regex","content":"^([1-9]|[12]\\d|3[0-6])$","name":"Number of days over a month","message":"Please select a number of days greater than 0 and within the days of a month"}]},{"name":"followOnDuration","type":"choice","item-type":"select","_auto_id_":"f2ddc666-6e57-482b-b201-3b879a118cbf","label":"Estimated Duration:","required":true,"options":[{"label":"00:15","value":"15"},{"label":"00:30","value":"30"},{"label":"00:45","value":"45"},{"label":"01:00","value":"60"},{"label":"01:15","value":"75"},{"label":"01:30","value":"90"},{"label":"01:45","value":"105"},{"label":"02:00","value":"120"}],"expressions":{},"message":"This is a required field","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.utils.updatePage();"},"_auto_id_":"b066aeca-406d-418a-b614-e881eb49c364","actions":[]}]},{"name":"getavailability_btn","type":"button","item-type":"button","_auto_id_":"118c469f-d67d-4b83-82a6-0b4af14ff236","content":"Get Availability","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"selecttime-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var today = moment().format('DD-MM-YYYY');\nvar selected = moment(cti.store.pages.FollowOnContinued.followOnDate).format('DD-MM-YYYY');\n\nif(today === selected) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_timeslot\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warning\",\n      \"title\" : \"Warning: Invalid Date Selected\",\n      \"text\" : \"You must select a date to search from that is not the current day. It must be in the future.\"\n    }\n  );\n} else {\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetFollowOnSlots\" });\n}"},"_auto_id_":"9a70b528-c36f-401e-a5fc-2ad404a45e54"}]},{"name":"html_availablebookings","type":"content","item-type":"html","_auto_id_":"2888070f-7b8d-4d0c-b799-9fd740bccf4f","content":"<h4>Available Appointments</h4>","expressions":{"show":"false"}},{"name":"html_noappointments","type":"content","item-type":"html","_auto_id_":"d710c31b-4b9e-47b8-88f5-94d4e2fb8669","content":"<h4 style=\"text-align:center;\">No Appointments Available</h4><p style=\"text-align:center;\">Currently there are not appointments available for the selected date range. Please contact your Supervisor or try amending your search.</p>","expressions":{"show":"$store.variables.appointmentResults == false"}},{"name":"followOnAppointmentSlots","type":"content","item-type":"list","_auto_id_":"e73b5c3e-7c18-43a2-ae77-3151f436ad04","search":"","classes":"","expressions":{"show":"false"},"model":"$store.jobs.followOnTimeSlots","theme":"bootstrap","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var timeSlots = cti.store.jobs.followOnTimeSlots;\nvar selectedSlot = {{$data.$item}};\n\nfor(var i in timeSlots) {\n  var remove = document.getElementById(timeSlots[i].id);\n  remove.classList.remove('timeslot-item-selected');\n  \n  if(timeSlots[i].id == selectedSlot.id) {\n    timeSlots[i].selected = true;\n    cti.store.jobs.selectedJob.sFollowOnRequiredDetail = selectedSlot;\n  } else {\n    timeSlots[i].selected = false;\n  }\n}\n\nvar element = document.getElementById(selectedSlot.id);\nelement.classList.add('timeslot-item-selected');\n\ncti.utils.updatePage();"},"_auto_id_":"ee312c76-cd69-4e3f-94ae-d397dee2abaa","actions":[]}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"followOnAppointmentSlots_html","_auto_id_":"78d2baff-6b19-4cf3-8413-fed8290b6ffb","content":"<div id=\"{{$data.$item.id}}\">{{$data.$item.description}}</div>"}]},{"name":"availableSlots","type":"choice","item-type":"select","_auto_id_":"3360c34f-7301-4d56-b15a-bbf5c8a09326","label":"Available Slots:","required":false,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"expressions":{"show":"$store.variables.appointmentResults == true"},"option-source":"$store.jobs.followOnTimeSlots","label-property":"description","value-property":"id"},{"name":"html_bookedfor","type":"content","item-type":"html","_auto_id_":"ab948504-26b2-4570-bf7d-3dfe6aba9943","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa complete\"></p></div>\n<h4 class=\"completeheader\">Booked</h4>\n<p style=\"color:#228B22;text-align:center;\">Follow on appointment booked for {{'$store.jobs.selectedJob.sFollowOnRequiredDetail.description'|store}}","expressions":{"show":"$store.jobs.selectedJob.bFollowOnRequired == true"}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"20d14973-2407-4010-a051-ab4ab0ba6782","extends":{"type":"area","item-type":"row"},"content":[{"name":"cancel_btn","type":"button","item-type":"button","_auto_id_":"fef7bcdc-41db-4691-9496-6537d6ea20e1","content":"Cancel","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('FollowOnContinued');\n\ndelete cti.store.jobs.selectedJob.sFollowOnRequiredDetail;\ndelete cti.store.jobs.followOnTimeSlots;\ndelete cti.store.jobs.selectedJob.bFollowOnRequired;\ndelete cti.store.variables.appointmentResults;\n\ncti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"9571c11c-7247-44a4-9d3f-76fe722f8593"}],"expressions":{},"classes":"deletephoto-btn"},{"name":"bookfollowon_btn","type":"button","item-type":"button","_auto_id_":"5648d84f-1e4e-4e10-9f69-859580624778","content":"Book Slot","theme":"default","expressions":{"disabled":"$store.pages.FollowOnContinued.availableSlots == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var timeSlots = cti.store.jobs.followOnTimeSlots;\nvar selectedSlot = cti.store.pages.FollowOnContinued.availableSlots.value;\nvar timeSlotData;\n\nfor(var i in timeSlots) {\n  if(timeSlots[i].id == selectedSlot) {\n    timeSlotData = timeSlots[i];\n    break;\n  }\n}\n\nif(cti.store.pages.FollowOnContinued.followOnDuration == undefined) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_timeslot\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warning\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You must select an Estimated Duration before continuing with booking the appointment.\"\n    }\n  );\n} else {\n  if(timeSlotData) {\n    cti.store.jobs.selectedJob.sFollowOnRequiredDetail = timeSlotData;\n    cti.utils.callAction('call-actionflow', { \"name\": \"BookFollowOnSlot\" });\n  } else {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_timeslot\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"warning\",\n        \"title\" : \"Warning\",\n        \"text\" : \"You must select an Available Time Slot before continuing with booking the appointment.\"\n      }\n    );\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"978ce2d3-7a3b-4781-a267-672b04d1b51b"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"FollowOnAppointment","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"74d76e3e-196e-4864-9253-d8b6bc53e30e","content":"<h4 class=\"title\">Follow On Work</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"789988eb-2cb9-4f59-9a0d-084cc0bb56b3","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"FollowOnAppointment","componentInstanceId":"89b9e196-7cc1-401b-aae3-00fe97dd31ac","function":"open"},"_auto_id_":"55ef2c52-6d94-464b-bc1a-1653c899ccd3"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"cd0d8607-f1ca-4193-b4f7-21f975bd2e13","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"db8bee77-a45e-406f-a46d-86e1dd61d3b7"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"270b5f0f-5a7e-453c-a708-d5a1eef88941","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"05e86dba-bf65-44b6-9ef5-b374773405da"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"76e14987-4657-46fc-9d68-c0f56e26de1d","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3fd1e5ae-02b6-48d3-8aec-9c4816bab2ed"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"af34375b-22d5-4478-a07b-adf689adbd34","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"59b549f3-0cb3-497f-acc9-11fad9e7b01b"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"15ba6cef-9442-4fd3-abfd-2b6f5d60631e","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"26fdaf53-c2ed-4b18-93e4-447bb6b60b03"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"fe7435ce-beef-4408-978d-fdb25820d25f","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"db207160-b253-4b38-aa5a-93e6f619635e"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"95fb0906-1ee1-4856-810c-90608e2c499b","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"20b6a9b7-62cd-4a30-98e7-6d0f9db828e6"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"d967f4ed-2a31-41ff-b8ed-253a868d28c9","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"67d243f5-7625-4264-95e5-06d28d162c65"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"89b9e196-7cc1-401b-aae3-00fe97dd31ac","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"617eb406-e012-4136-be75-00fb6fc09504","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"249676f8-560f-459c-a943-f2cf9ff5a5b2","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"eaf2c2a8-65d6-445e-8043-b375a5f9af93","attributes":{},"expressions":{}},{"name":"jobCompletionCheck","type":"choice","item-type":"radio","_auto_id_":"ec4d6967-4f78-439a-ad87-8b6af8a4f688","label":"Is there any Follow On Work required for this Job?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"message":"This is a required field","classes":"cb-bias-first","actions":[]},{"name":"jobNotCompleteReason","type":"choice","item-type":"select","_auto_id_":"3bf40b60-1a55-411a-8358-ae3aabd87cfe","label":"Reason job not complete","required":true,"options":[{"label":"Materials on order","value":"Materials on order"},{"label":"Other trade required","value":"Other trade required"},{"label":"Further time required (Me)","value":"Further time required (Me)"}],"expressions":{"show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\""},"message":"This is a required field","actions":[],"option-source":"$store.staticData.followOnList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"followOnComments","type":"user-input","item-type":"text","_auto_id_":"2713ef86-50f6-400d-ab39-687ea40a0872","label":"Follow on comments:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\""},"message":"This is a required field"},{"name":"book_btn","type":"button","item-type":"button","_auto_id_":"85f3d984-3442-407e-8b59-c9951b342980","content":"Book Follow On Appointment","theme":"default","expressions":{"disabled":"$form.invalid","show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnContinued\" });"},"_auto_id_":"720a076f-1ff7-4a32-837f-29ddbafd4c76"}],"classes":"bookappointment-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"d14ae38c-5d8f-459b-b351-f1c7f5aef4c9","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"f8b2454d-923a-4269-8144-003093173f01","content":"Previous","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"PostWorkPhotos\" });"},"_auto_id_":"3cd864e5-ae64-49a6-9f3d-991f41264396"}]},{"name":"jobcomplete_btn","type":"button","item-type":"button","_auto_id_":"20ae5c08-b430-41b6-a36b-55880c3fc73f","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.FollowOnAppointment.jobCompletionCheck == undefined","show":"$store.pages.FollowOnAppointment.jobCompletionCheck == undefined || $store.pages.FollowOnAppointment.jobCompletionCheck == \"0\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.sResultSummary = \"JOB COMPLETE\";\ncti.store.jobs.selectedJob.sResultSummarySubReason = \"\";\ncti.store.jobs.selectedJob.sResultDetail = \"Job Information: \" + cti.store.pages.JobInformation.workCompleteDescription;\n\ncti.utils.callAction('go-to-page', { \"name\": \"CustomerSignature\" });"},"_auto_id_":"6f5c8fcd-a782-4e06-a5cc-bf6a65e74e37"}]},{"name":"followon_btn","type":"button","item-type":"button","_auto_id_":"00e08eeb-4db9-4d00-a0a1-519d5f00d09b","content":"Next","theme":"default","expressions":{"show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\"","disabled":"$form.invalid"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.sResultSummary = \"FOLLOW ON REQUIRED\";\ncti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.FollowOnAppointment.jobNotCompleteReason.value;\ncti.store.jobs.selectedJob.sResultDetail = \"Job Information: \" + cti.store.pages.JobInformation.workCompleteDescription + \"\\nFollow On Required: \" + cti.store.pages.FollowOnAppointment.followOnComments;\n\ncti.utils.callAction('go-to-page', { \"name\": \"CustomerSignature\" });"},"_auto_id_":"3f5d2bdb-47dd-4be0-919a-5e0858068be2"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"PostWorkPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"67aaf250-42e7-43b7-bc41-05bd84bce21a","content":"<h4 class=\"title\">Post Work Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"55b6eb40-1578-4292-8c74-9fdffde3ec43","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"PostWorkPhotos","componentInstanceId":"504ff3b9-d422-449d-866e-83a45886ab5f","function":"open"},"_auto_id_":"bc79b6da-70ba-431c-8436-fadb8e8c8028"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bb4c37cd-c0f4-4393-b43f-852446d51554","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"a5f79df0-a384-43ba-ac6a-ecd7aaa9ab90"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"46b267a5-0c38-4131-804f-0a5d8d9e6938","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"2e597d53-8f55-4534-a100-a40507dd806f"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"4f8fc354-b8b3-4fb5-a8d5-c9aa4db40ade","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cb0c3bda-8779-47b6-8e55-8eab45f64612"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"4a8330a8-b5ef-449c-b704-4011f5380123","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e4729dc7-a1eb-4058-882c-edbb04ea42be"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"b58bb330-b020-4867-a0d4-77790cea80ee","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6d12bf9f-3085-4de7-b068-3ae4620bb2b2"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"3a29549f-213a-4e17-8092-9b515c30a71a","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e59af52b-8034-45e9-911c-fa5614f53b82"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"dbac1d1d-0862-4844-ae53-9b6f52705d85","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8650778e-6d89-4e63-a666-7529d6e7fbbc"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"b0751bf9-48ef-41a8-995e-2b54895782a6","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"1b3a32b1-8c11-4175-b6fe-e184516ce097"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"504ff3b9-d422-449d-866e-83a45886ab5f","attributes":{},"expressions":{}}],"_auto_id_":"4d84e759-91cd-4b13-96f5-8efa244d3967","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"7c4b973e-8e3e-4b9d-8b66-96eed867a1eb","content":[{"name":"noPermissionWarning","type":"content","item-type":"html","_auto_id_":"5ab0f6ee-1e56-473e-808f-4b33d1426ff3","content":"<h4 style=\"text-align:center;\">Warning</h4>\n<p style=\"text-align:center;\">You have selected on the Pre Work Photos page that you do not have permission to take photos. Please continue or obtain permission from tenant to take photos.</p>","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"N\""}},{"name":"preWorkPhotos","type":"content","item-type":"html","_auto_id_":"abd04328-08eb-4fd6-b801-bf5ce65f17e7","content":"<h4>Post Work Photos</h4><p>Please take any photos relevent to the work carried out on the job.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('PostWorkPhotos','3c93f0f9-04ef-4534-bf67-0e25cb39f47f')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""}},{"name":"btnTakePhotoPostWork","type":"button","item-type":"button","_auto_id_":"57b8dc12-6d91-478e-af6f-90b20c0d98c3","content":"Take Photo","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""},"actions":[{"event":"click","type":"call-component-function","data":{"page":"PostWorkPhotos","componentInstanceId":"35ddb660-3753-4901-8ebd-760414afd6a5","function":"takePhoto"},"_auto_id_":"48640d2c-39b6-4533-817a-e5caa6848be1"}],"classes":"takephoto-btn"},{"name":"PostWorkPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"f509b6fb-7881-4012-8019-6a75ad689441","_auto_id_":"35ddb660-3753-4901-8ebd-760414afd6a5","attributes":{"captureCategory":"Post Work","displayCategory":"Post Work","maxPhotos":3},"expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""},"actions":[{"event":"maxPhotosTaken","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"app_genericwarning","text":"You have taken the maximum number of photos for post-work evidence."},"_auto_id_":"97174caa-bf7c-43c6-819b-4ebd427da3a2"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"c8c71e24-e767-4949-a906-2fe375a1482e","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"0e0e156c-3e0a-45c1-a372-21736db1eadc","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"JobInformation","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_nophotos_btn","type":"button","item-type":"button","_auto_id_":"79bfe59c-747b-4ec4-8bf9-b89e13463d82","content":"Next","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"N\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"4ccc362b-d2d5-453c-ac6d-6ffa1f442c18"}]},{"name":"next_yespermission_btn","type":"button","item-type":"button","_auto_id_":"05d41afe-b6ff-4055-806f-b798f0f6be11","content":"Next","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"8fa858c3-9788-4894-b359-7449a0cf04da"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobInformation","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"9acb40ad-ff42-4d6b-adb3-657cbdaf4bbf","content":"<h4 class=\"title\">Job Information</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"1093da18-ff51-4110-80cd-434763ae143c","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"b995558d-fa2a-4780-ab11-a78e6fcfb0ca","function":"open"},"_auto_id_":"fca76422-03f7-4b8e-839c-0d9d6e1a9aff"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"a4e40bb1-028f-46b8-9116-5c7e87fe3c32","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"0965e40a-0728-4bd6-87f3-3d1462383c98"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"09747515-8039-4f2a-abb4-3c2f268c385e","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c51f6121-f8f9-4669-b40a-a6df87ac6916"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"7cebb8ab-a0b0-4d69-b13c-4aa4eda085f8","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"4cf87d27-401b-4afd-8653-a853339f85ba"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"25fda80d-3ced-4a6e-8028-03c85069e5ea","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"0f9370d8-d0e9-423a-b645-51ed2ff56dd9"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"ae966a6a-5f81-496d-9925-7fb66102e240","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c624b7c5-2d19-4ef7-a132-d8182d8dd912"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"4162d883-31ff-4e43-a4e5-841fabda3e34","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d9847fa4-f061-421b-adff-218ad43803a2"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"679efdf7-85f4-450f-9df6-a2950f8e2950","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"458beecf-6462-42e8-a39e-07cad51ea557"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"38ca52c4-26f5-4b0a-8a34-43e2f7a04d9e","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"dee2e051-8b43-4b7a-975e-010de96b40ad"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"b995558d-fa2a-4780-ab11-a78e6fcfb0ca","attributes":{},"expressions":{}}],"_auto_id_":"975edf3c-3936-4899-a361-530dbe24fba7","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"5babd70e-18bc-44b2-ad2b-bcc3c4a4c9fe","content":[{"name":"html_worktodo","type":"content","item-type":"html","_auto_id_":"b07e05b7-1f6e-4f73-895e-57b6aa681164","content":"<h4>Work to be carried out</h4>\n<p>{{'$store.jobs.selectedJob.sWorkToBeDoneDetail'|store}}</p>\n<hr>","expressions":{}},{"name":"workCompleteDescription","type":"user-input","item-type":"text","_auto_id_":"396e021d-3747-4fb5-bc4b-b0218d55bf1c","label":"Description of work carried out to remedy the issue:","required":true,"multiline":true,"debounce":250,"expressions":{},"message":"This is a required field","actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"e455a572-80e0-4c91-a2c0-6509fd86cbd1","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"29abde35-496a-4b9e-a201-53e5d9c8b563","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"PreWorkPhotos","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"da557649-c619-4811-8f14-42de3d39ef61","content":"Next","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.sResultDetail = cti.store.pages.JobInformation.workCompleteDescription;\n\ncti.utils.callAction('go-to-page', { \"name\": \"PostWorkPhotos\" });"},"_auto_id_":"b8cb4af0-8828-4b03-9f25-7a056a5ee196"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"PreWorkPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"a6bfae85-3bd1-424a-b075-c8c6fca7049d","content":"<h4 class=\"title\">Pre Work Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"beeab708-1201-484f-8fa8-2b949eee2ba9","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"BeforePhotos","componentInstanceId":"371022e1-f2e3-4d8f-b9b7-acccdc51cbac","function":"open"},"_auto_id_":"42a72e88-4404-40ce-bf7c-57b6e699df28"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"fda2d9ae-7d0a-4b50-be5c-9b9e19cfc765","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"f889b8ba-c71a-4300-bd24-38bb4110a28d"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"681f84e0-9a65-4bab-87b3-1c9bfa887b14","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"dcfa5dfa-5535-49bf-991e-34332bc442ef"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"348bb7b2-08e6-419a-a8e8-20149f3a287e","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a9db9556-9612-4b92-8330-ba0901d54537"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"835c4c3f-cac0-4970-b808-3d32d502dee3","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b981cfb6-7be6-4239-bea7-9ba6266c3979"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"bf94f94d-1a03-4fbc-a195-d7bfcde6813a","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6e592e33-5b3c-4b18-8e9f-ae1844b2c3e2"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"cab8e631-8c85-4b50-bbb3-729c029535fb","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a6160d0a-73a6-4673-bcce-234d33a5ef70"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"f895a91b-fd01-40d3-8799-8b5a82caf91a","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c4eac62a-d525-483d-8dc6-bc0ed791e810"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"a10ade9f-3c2b-4e87-8ed1-b44878394ac4","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"388e61d6-1867-42f9-8b96-9a5e63d6b6ec"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"371022e1-f2e3-4d8f-b9b7-acccdc51cbac","attributes":{},"expressions":{}}],"_auto_id_":"ca7e1d8b-4ef9-4133-bd6a-d373260e44d4","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"447aa3f3-da43-475f-bcb1-fa95c89ed602","content":[{"name":"preWorkPhotoPermission","type":"choice","item-type":"radio","_auto_id_":"176962b8-6221-4a58-ab4b-b5d21115705b","label":"Have you got permission to take photos?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[]},{"name":"preWorkPhotoDescription","type":"user-input","item-type":"text","_auto_id_":"6c2c16ed-c02c-4205-a67d-c838bd7522e3","label":"Please enter any tenant comments below:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == '0'"}},{"name":"preWorkPhotos","type":"content","item-type":"html","_auto_id_":"136f87dc-5669-49fe-8935-ee99cf289a12","content":"<h4>Pre Work Photos</h4><p>Please take any photos relevent to the job prior to work being done.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('PreWorkPhotos','708d6621-8b2f-4843-a6cd-c0d7dd539537')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"1\""}},{"name":"btnTakePhotoPreWork","type":"button","item-type":"button","_auto_id_":"44cfcd70-5b51-4113-b7c2-1d1a2e507914","content":"Take Photo","theme":"default","expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"1\""},"actions":[{"event":"click","type":"call-component-function","data":{"page":"PreWorkPhotos","componentInstanceId":"fd79e145-ee10-489c-aca8-66afe6a46365","function":"takePhoto"},"_auto_id_":"d9fe42b0-7962-4c7d-9d7c-ead1f2a4d224"}],"classes":"takephoto-btn"},{"name":"PreWorkPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"f509b6fb-7881-4012-8019-6a75ad689441","_auto_id_":"fd79e145-ee10-489c-aca8-66afe6a46365","attributes":{"captureCategory":"Pre Work","displayCategory":"Pre Work","maxPhotos":3},"expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == '1'"},"actions":[{"event":"maxPhotosTaken","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"app_genericwarning","title":"Photos","text":"You have taken the maximum number of photos for pre-work evidence."},"_auto_id_":"e4d478e7-19c8-4f31-a55d-5a3b4cdc1a6d"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"860f1674-81bd-4ab4-9a17-e21949c03cfc","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"6ef979fe-baf7-4754-80d7-5e1f6890bd22","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"StartingWork","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_yespermission_btn","type":"button","item-type":"button","_auto_id_":"0328853e-5627-46dd-aabd-d689f7817211","content":"Next","theme":"default","expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"1\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.bWorkPhoto = \"Y\";\ncti.store.jobs.selectedJob.bWorkPhotoComment = \"Permission has been granted \";\n\nif(!cti.store.jobs.selectedJob.bTenantPhotDataCollection) {\n  cti.store.variables.jobCollectionType = \"tenantphoto\";\n  cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"JobInformation\" });"},"_auto_id_":"5ea0e64e-aba5-4658-91aa-54e0809aea9c"}]},{"name":"next_nopermission_btn","type":"button","item-type":"button","_auto_id_":"83997b60-79fc-4ff1-8ecd-d6b74535420a","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.PreWorkPhotos.preWorkPhotoDescription == \"\" || $store.pages.PreWorkPhotos.preWorkPhotoDescription == undefined","show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"0\" || $store.pages.PreWorkPhotos.preWorkPhotoPermission == undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.bWorkPhoto = \"N\";\ncti.store.jobs.selectedJob.bWorkPhotoComment = cti.store.pages.PreWorkPhotos.preWorkPhotoDescription;\n\ncti.store.variables.jobCollectionType = \"tenantphoto\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n\ncti.utils.callAction('go-to-page', { \"name\": \"JobInformation\" });"},"_auto_id_":"3b122e34-1459-424e-a4cd-78378ef0a243"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"EstimatedOverride","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"e6b2d640-a068-4fc1-92f9-6b0f3682282d","content":"<h4 class=\"title\">Warning!</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"7637a56f-6e14-4e7c-aed6-06a019258597","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"4b325055-09db-4f56-9ada-05c05b67bc4b","function":"open"},"_auto_id_":"66858a05-2a63-476e-989b-73b618eed27a"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"6bed8b50-dfd8-4c92-bdb4-bd47588740f9","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"9ee7e959-4a2b-47f9-aa2d-512fc79bd3f2"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"d1a9a4b7-6f1e-4dec-b310-cf42379b5c7b","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1dde4e6e-97f0-4b66-a5fe-996fc1f10223"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"5d9b88f5-5ad7-4d9d-94ca-361c816b8b7d","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c5bd4703-561b-45e0-9598-897ec7e1187e"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"1c36ec16-9b98-4b34-a0c1-0784a9cde51e","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"765ca3fd-ccd4-470b-ab26-c03778d63258"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"f2f19e11-65de-4998-aaf8-61598edeb0ae","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"00ee1b06-83dd-4cc5-bbe9-22456e78fae6"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"751bba81-b28b-4dae-b33e-bca3a2d31344","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"43af7c37-db5b-45eb-aa70-d2190ec8c468"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"cd7aac98-19e1-4ed5-905e-9b6440cdda70","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"77a84014-c602-446b-8440-725bc84797dc"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"d2e370a7-a975-42cc-856b-27f91893326f","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"6091f492-0f42-45af-beef-47bf2cb34245"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"4b325055-09db-4f56-9ada-05c05b67bc4b","attributes":{},"expressions":{}}],"_auto_id_":"409f2b87-a041-4d46-ab64-f52fd5a740c6","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"5e768472-5d95-44c1-9803-bc2f943f97bd","content":[{"name":"html_override","type":"content","item-type":"html","_auto_id_":"813a97ae-db78-4624-99c9-a98d21281b20","content":"<h3>You have Overridden the Estimated Duration for this Job.</h3>\n<p>You are about to Override the Estimated Duration that has been set against this Job. Once you have Overridden this, it can not be reverted and any further changes/amendments to the SOR codes will have no impact on the calculated SMV.</p><p>Are you sure you wish to continue?</p>\n<hr>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"50aa55cf-daf9-49d2-a84f-46130fcf22e6","extends":{"type":"area","item-type":"row"},"content":[{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"a664cb86-2a46-4d76-9253-d90c6f606d81","content":"No","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.estimatedOverride;\ndelete cti.store.variables.estimatedOverrideSelected;\ncti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });"},"_auto_id_":"20cc9c86-5717-42c9-8c92-2ec9413eceeb"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"74789c41-5b46-45aa-b447-14f1661a950e","content":"Yes","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.estimatedOverride = true;\n\ncti.store.jobs.selectedJob.originalEstimatedValue = cti.store.pages.StartingWork.estimatedDuration.value;\ncti.fnCalcSMVChange();\n\nif(cti.store.jobs.selectedJob.bJobStartWork) {\n  cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n} else {\n  cti.fnStartJob();\n  cti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });\n}"},"_auto_id_":"809795f0-9f74-4056-9fab-4115d0601966"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"StartingWork","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"51103ef4-8864-48ba-bb10-3caeeacc7bf9","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"cti.fnSORAlgorithms(true);\nvar jobExpected = cti.store.jobs.selectedJob.sExpected_Duration;\n\nif(cti.store.pages.StartingWork === undefined) {\n  cti.store.pages.StartingWork = {};\n}\n\nif(cti.store.pages.StartingWork.estimatedDuration === undefined) {\n  cti.store.pages.StartingWork.estimatedDuration = {};\n}\n\nif(jobExpected === undefined || jobExpected == \"\") {\n  jobExpected = \"0\";\n}\n\nvar time = parseInt(jobExpected);\n\nif(time === 0) {\n  var roundedExpected = time;\n} else if(time > 0 && time <= 120) {\n  var roundedExpected = 15 * Math.round(parseInt(jobExpected) / 15);\n} else if(time > 120 && time <= 240 ) {\n  var roundedExpected = 30 * Math.round(parseInt(jobExpected) / 30);\n} else if(time > 240 && time <= 480) {\n  var roundedExpected = 60 * Math.round(parseInt(jobExpected) / 60);\n}\n\nif(roundedExpected === 0) {\n  roundedExpected = 15;\n\n  if(cti.store.jobs.selectedJob.bJobStartWork != true) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodesfailed\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"Warning\",\n        \"text\" : \"The Expected Duration of this job is less than 15 minutes, please make sure this is correct before starting the job.\"\n      }\n    );\n  }\n}\n\ncti.store.pages.StartingWork.estimatedDuration.value = roundedExpected;\ncti.store.jobs.selectedJob.iJobStartWorkEst = time;\n\nif(cti.store.jobs.selectedJob.bJobStartWork != true) {\n  if(cti.store.jobs.selectedJob.aItemGroups.length === 0) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodesfailed\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"Warning\",\n        \"text\" : \"There are currently no SOR codes assigned to this job. Please check this and confirm before starting the job.\"\n      }\n    );\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"41986944-5946-41be-87f7-13d83c52cdaa"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"9bf5f598-8419-43e0-beaa-337665a193c3","content":"<h4 class=\"title\">Starting Work</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"d758c326-968a-48a6-a6f7-14c86b9cc165","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"StartingWork","componentInstanceId":"287108c0-56c6-4e69-92c7-e608aa0b9e4e","function":"open"},"_auto_id_":"2b64450a-1501-4a80-8ed2-2bd42580e033"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"4e7352d2-5df9-4880-8894-ca77d62df20a","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"2b9b770f-7808-436e-af35-9bf8e71b9cda"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"d88028f8-c0de-495d-870c-4668ef71805e","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"993889b9-1d9c-41d0-aad2-7a9f2804576f"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"4f6e4662-10c2-4669-8d2b-92b92879d1e2","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cfc0421c-aa2c-40c1-a825-ab95be541c80"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"0487c688-80d5-45fe-b1ba-bd0f989d8caa","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d2935f2c-bf34-48ad-8b07-ce5b32a915ae"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"b5791333-dd97-4064-b4da-6067ff75c91f","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"77a02f7f-8097-4d9e-90b4-acfb33f9f2c2"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"fb989433-d413-4116-b2c9-eb9f8aa4abe3","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"22d2ce04-d81b-4b83-857c-055229db7f8c"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"d40399eb-3afa-4b87-865e-a577c735fc7a","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"23eabded-6be6-4fa7-8aa1-053a84852ec0"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"d28cfdbf-4e99-4ab6-ae89-4f19bab58b9d","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"f4b1aa03-c6ab-4fb1-8e51-694ef711b001"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"287108c0-56c6-4e69-92c7-e608aa0b9e4e","attributes":{},"expressions":{}}],"_auto_id_":"dab69140-df4d-4270-a323-25a4ac7dd3bd","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"1a5befe3-7598-44ef-be1f-26f3bc443d3f","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"7a99d18e-5fe1-4a3b-ba78-516f588995c7","attributes":{},"expressions":{}},{"name":"workDescription","type":"user-input","item-type":"text","_auto_id_":"c418e949-7f4d-430d-ad50-561b3498fe84","label":"Description of work to be carried out:","required":true,"multiline":true,"debounce":250,"expressions":{},"message":"This is a required field","validators":[],"actions":[]},{"name":"estimatedDuration","type":"choice","item-type":"select","_auto_id_":"72dd2ab3-3771-48e1-9199-6cf9f671f6af","label":"Estimated Duration:","required":true,"options":[{"label":"00:15","value":"15"},{"label":"00:30","value":"30"},{"label":"00:45","value":"45"},{"label":"01:00","value":"60"},{"label":"01:15","value":"75"},{"label":"01:30","value":"90"},{"label":"01:45","value":"105"},{"label":"02:00","value":"120"}],"expressions":{},"message":"This is a required field","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.iJobStartWorkEst = cti.store.pages.StartingWork.estimatedDuration.value;\ncti.store.variables.estimatedOverrideSelected = true;\ncti.utils.updatePage();"},"_auto_id_":"ca3af6fc-5db2-4fbd-84ff-3cd880615ae0","actions":[]}],"option-source":"$store.staticData.estimatedTimeSlots","label-property":"label","value-property":"value"},{"name":"html_totalmins","type":"content","item-type":"html","_auto_id_":"85581b50-8523-497e-bd41-9f6eaf06f9c3","content":"<p style=\"margin-bottom:2vh;margin-top:2vh;font-size: 12pt;\">Total Minutes: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobStartWorkEst'|store}}</span></p>\n<hr>","expressions":{}},{"name":"html_startjob","type":"content","item-type":"html","_auto_id_":"f49284a1-742e-4a27-a715-557426c591a2","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa startjob\"></p></div>","expressions":{"show":"$store.jobs.selectedJob.bJobStartWork == false"}},{"name":"html_jobstarted","type":"content","item-type":"html","_auto_id_":"cf5cba38-66fe-4f50-bc4b-ac34dc2b4f9c","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa complete\"></p></div>\n<h4 class=\"completeheader\">Job Started</h4>","expressions":{"show":"$store.jobs.selectedJob.bJobStartWork == true"}},{"name":"startjob_btn","type":"button","item-type":"button","_auto_id_":"aef03b7d-f05c-4432-a187-003ed16bc0df","content":"Start Job","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobStartWork == false","disabled":"$form.invalid"},"classes":"startjob-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var originalEstimated = cti.store.jobs.selectedJob.originalEstimatedValue;\nvar selectedEstimated = cti.store.pages.StartingWork.estimatedDuration.value;\n\nif(cti.store.variables.estimatedOverrideSelected) {\n  if(originalEstimated === selectedEstimated) {\n    cti.fnStartJob();\n  } else {\n    cti.utils.callAction('go-to-page', { \"name\": \"EstimatedOverride\" });\n  }\n} else {\n  cti.fnStartJob();\n}"},"_auto_id_":"c20cbe16-2c67-4eec-a5b0-d5e66cdd9636"}]},{"name":"html_jobstartedtime","type":"content","item-type":"html","_auto_id_":"2191ecf2-b44a-4998-9fdd-e499e9f2bb71","content":"<hr>\n<p style=\"font-size: 12pt;\">{{'$store.jobs.selectedJob.sJobStartWorkText'|store}}: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobStartWorkTime'|store}}</span></p>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"c7eb5bd8-d70e-4dff-bcae-faf77bd41bbc","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"5a306c6f-8aca-40dd-a6ff-3bda1df22657","content":"Previous","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobStartWork == true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"NoAccess\" });"},"_auto_id_":"b4fb8fa4-b715-44bd-bf72-45b7cbfa86ab"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"25e86653-37bb-4177-9cd4-619974977a43","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobStartWork == false || $form.invalid"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var originalEstimated = cti.store.jobs.selectedJob.originalEstimatedValue;\nvar selectedEstimated = cti.store.pages.StartingWork.estimatedDuration.value;\n\nif(cti.store.variables.estimatedOverrideSelected) {\n  if(originalEstimated === selectedEstimated) {\n    cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n  } else {\n    if(cti.store.variables.estimatedOverride) {\n      cti.store.jobs.selectedJob.originalEstimatedValue = selectedEstimated;\n      cti.fnCalcSMVChange();\n      cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n    } else {\n      cti.utils.callAction('go-to-page', { \"name\": \"EstimatedOverride\" });\n    }\n  }\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n}\n\ncti.store.jobs.selectedJob.sWorkToBeDoneDetail = cti.store.pages.StartingWork.workDescription;"},"_auto_id_":"5a42fada-1a69-4003-b83c-13a3b0c567df"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"RiskAssessment","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"cf723f9c-5de6-4271-bec0-e0032c6f71be","content":"<h4 class=\"title\">Risk Assessment</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"542287da-ca19-4041-9be8-00567876b3ef","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"RiskAssessment","componentInstanceId":"c5f974a3-9728-4ad0-919d-df9c7934b450","function":"open"},"_auto_id_":"3f8f51a1-cfaf-4d37-9569-79ef74acc9c4"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"c0a1e012-2bd2-488f-84f9-2fa4b4a79b17","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"af0df49d-b579-4aa0-b3a6-cadab64ac74a"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"e3977b22-5a39-4f33-b570-496a03736fff","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a3c3c19f-b1b1-4743-9ba0-6e8b941207f0"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"25f8076d-b464-4c3a-a5c3-6cdf0b04c761","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"169433a4-b7cd-4900-b77f-1d78c97d12a6"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"408baf78-2919-4d3e-8c3b-e5f6c450cf87","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"31b8a6c0-4e86-41de-92d1-66c2ff0ad51f"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"95b66d63-7c09-4c6d-b0b7-3dbeda621d39","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c7f4571b-79ed-4bc8-95dc-89ff1e851f1a"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"5aaa923f-e8b2-4018-90c5-185ad4b36314","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"RiskAssessment","componentInstanceId":"4f8e150c-b711-48a9-8ba4-511640fdd1fa","function":"show"},"_auto_id_":"3289a0dd-9134-4f44-a73a-c3edc272b9ce"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6a56e211-f900-4829-8d3d-77b243dea952"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"e019d31e-ab74-4578-bbd2-a496063bc2b2","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"01a6ec87-dfd1-484c-81f1-eae6a1938d7d"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"ab49100e-3254-40be-8831-52698a1a4b3b","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"2da39640-7cbc-4eb7-84eb-2e1be61ec86e"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"c5f974a3-9728-4ad0-919d-df9c7934b450","attributes":{},"expressions":{}}],"_auto_id_":"28db095f-7eaf-4ba1-9c8e-ae4dc88884d9","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"f3667cc7-ddeb-49e4-92f1-0ff822802a45","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"4f8e150c-b711-48a9-8ba4-511640fdd1fa","attributes":{},"expressions":{}},{"name":"html_riskassessment","type":"content","item-type":"html","_auto_id_":"796f517e-d13b-4bb7-aaad-852f3a7d9b96","content":"<h4>The <span style=\"font-weight:bold\">Risk Assessment</span> must be completed prior to carrying out daily works.</h4>\n<hr>","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""}},{"name":"questionOne","type":"choice","item-type":"radio","_auto_id_":"e4b3bfc3-3081-46ca-a923-12fbacd833b6","label":"I have identified and put into place control measures for all the significant work I am required to carry out. I have referred to RA Guidance and generic RA as required.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[],"validators":[]},{"name":"questionTwo","type":"choice","item-type":"radio","_auto_id_":"c8b921fd-13e4-4060-ba0c-c300599b93b4","label":"I have identified all the persons exposed to the work I am carrying out and have included them in my risk assessment having put in place any necessary control measures to protect them.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionThree","type":"choice","item-type":"radio","_auto_id_":"6229bd9e-431b-437c-b241-6db1313f1bbb","label":"The tools and equipment I am planning to use are suitable for the task and to the best of my knowledge, free from faults and defects.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionFour","type":"choice","item-type":"radio","_auto_id_":"43f67f85-f54b-4c84-bfd1-912c3888e8e8","label":"I have identified all the PPE equipment and will ensure it is worn correctly.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionFive","type":"choice","item-type":"radio","_auto_id_":"8bcacd0a-9bde-420a-a1fc-f3793141e54d","label":"Access equipment used is within its period of inspection, will only be used by those that are trained to do so, and I will abide by the 'Working at Height' safety instructions.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionSix","type":"choice","item-type":"radio","_auto_id_":"9ad3e0d7-9a02-49b8-b059-7dea8c9fd0ce","label":"Access equipment used is within its period of inspection, will only be used by those that are trained to do so, and I will abide by the 'Working at Height' safety instructions.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionSeven","type":"choice","item-type":"radio","_auto_id_":"ff7bb29b-16cf-47c3-b497-96aa583a6595","label":"If the work involves manual handling I will ensure that the load is within my lifting capability.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionEight","type":"choice","item-type":"radio","_auto_id_":"8d139c61-40dc-4457-bc99-62c2dcbb865c","label":"If the task involves the use of any hazardous substances (including asbestos) I will follow the COSHH safety data sheet/asbestos procedures as necessary and ensure all precautions are taken.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"confirmRiskAssessment","type":"choice","item-type":"radio","_auto_id_":"302e1a1e-2c20-4f86-8e4c-c0cae292892a","label":"Have you read and understood the full Risk Assessment Policy relating to this type of work and is it safe to proceed to do the work?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.payloads.riskAssessmentPayload != undefined && ($store.jobs.selectedJob.bRAStatus == false || $store.jobs.selectedJob.bRAStatus == true)"},"message":"This is a required field","classes":"cb-bias-last","actions":[],"validators":[]},{"name":"confirmRASignature","type":"user-input","item-type":"signature","_auto_id_":"e6d9ed41-db1b-47f2-9498-5c08b7342f40","label":"Operative Signature:","required":false,"expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"1\" && $store.payloads.riskAssessmentPayload != undefined && $store.payloads.riskAssessmentPayload != undefined && ($store.jobs.selectedJob.bRAStatus == false || $store.jobs.selectedJob.bRAStatus == true)"},"validators":[],"actions":[]},{"name":"html_rafailed","type":"content","item-type":"html","_auto_id_":"fca3d385-7a56-4039-a519-f92b51374171","content":"<div onclick=cti.fnPhoneCall('manager') style=\"width:100%;text-align:center;\"><p class=\"fa supervisor\"></p></div>\n<h4 class=\"check-fail-header\">One or more of the above checks has failed. Please call your Supervisor by tapping on the icon above before continuing...</h4>","expressions":{"show":"($store.pages.RiskAssessment.questionOne == \"0\" || $store.pages.RiskAssessment.questionTwo == \"0\" || $store.pages.RiskAssessment.questionThree == \"0\" || $store.pages.RiskAssessment.questionFour == \"0\" || $store.pages.RiskAssessment.questionFive == \"0\" || $store.pages.RiskAssessment.questionSix == \"0\" || $store.pages.RiskAssessment.questionSeven == \"0\" || $store.pages.RiskAssessment.questionEight == \"0\") && $store.payloads.riskAssessmentPayload == undefined"}},{"name":"html_ra_abandon","type":"content","item-type":"html","_auto_id_":"598b3380-fd98-4a63-b5a3-c525b10aa6c7","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa raabandon\"></p></div>\n<h4 class=\"abandonheader\">Are you sure you want to fail the Risk Assessment and Abandon this job?</h4>","expressions":{"show":"$store.jobs.selectedJob.bRAStatus != true && $store.jobs.selectedJob.bRAStatus != false"}},{"name":"noAccessSafelyReason","type":"choice","item-type":"select","_auto_id_":"c4cd0e25-a531-4758-a9b6-14bc5f806f03","label":"Abandon job reason?","required":false,"options":[{"label":"Abusive/Violent Tenant","value":"Abusive/Violent Tenant"},{"label":"Appliance Not Accessible","value":"Appliance Not Accessible"},{"label":"Appliance Under Warranty","value":"Appliance Under Warranty"},{"label":"Arrange for Another Day","value":"Arrange for Another Day"},{"label":"Called Away to Another Job","value":"Called Away to Another Job"},{"label":"Dirty House","value":"Dirty House"},{"label":"Incorrect Part Received","value":"Incorrect Part Received"},{"label":"Minor Only in Property","value":"Minor Only in Property"},{"label":"No Electric On","value":"No Electric On"},{"label":"No Gas Heating","value":"No Gas Heating"},{"label":"No Gas On","value":"No Gas On"},{"label":"No Meter Present","value":"No Meter Present"},{"label":"Office Cancelled","value":"Office Cancelled"},{"label":"Other","value":"Other"},{"label":"Personal","value":"Personal"},{"label":"Sharps","value":"Sharps"},{"label":"Unable to Finish","value":"Unable to Finish"},{"label":"Wrong Trade","value":"Wrong Trade"}],"expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"0\" && $store.jobs.selectedJob.bRAStatus == \"Failed Risk Assessment\""},"message":"This is a required field","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.NoAccess) {\n  if(cti.store.pages.NoAccess.noAccessSafelyReason != undefined) {\n    cti.store.jobs.selectedJob.bJobNoAccessSafely = true;\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"9e8962ec-b1d4-4640-8075-b051d90eeaca"}],"option-source":"$store.staticData.abandonJobList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"27e435ad-803a-4ae9-bbdd-2f87a134cdb4","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"9c9e2e70-e793-416f-be21-35916a8a9b3b","content":"Previous","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bRAStatus == true || $store.jobs.selectedJob.bRAStatus == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"NoAccess\" });"},"_auto_id_":"b638d218-9863-49a9-96d9-13c27e70f95d"}],"classes":"button-bar-btn"},{"name":"confirm_btn","type":"button","item-type":"button","_auto_id_":"f2ff942a-4daf-4a96-94a5-674217517aae","content":"Confirm","theme":"default","expressions":{"disabled":"$form.invalid","show":"($store.pages.RiskAssessment.questionOne != \"0\" && $store.pages.RiskAssessment.questionTwo != \"0\" && $store.pages.RiskAssessment.questionThree != \"0\" && $store.pages.RiskAssessment.questionFour != \"0\" && $store.pages.RiskAssessment.questionFive != \"0\" && $store.pages.RiskAssessment.questionSix != \"0\" && $store.pages.RiskAssessment.questionSeven != \"0\" && $store.pages.RiskAssessment.questionEight != \"0\") && $store.payloads.riskAssessmentPayload == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\ndelete cti.store.saveActionPayload;\n\ncti.store.pages.RiskAssessment.confirmRiskAssessment = undefined;\n\ncti.utils.updatePage();"},"_auto_id_":"2f848737-2e5b-491b-abb5-f8b907505516"}]},{"name":"cancel_btn","type":"button","item-type":"button","_auto_id_":"a7363123-3d0a-4de8-bb27-5473468281bd","content":"Cancel","theme":"default","expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"0\" && $store.jobs.selectedJob.bRAStatus == \"Failed Risk Assessment\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.bRAStatus = false;\ncti.store.payloads.riskAssessmentPayload = undefined;\n//cti.utils.destroyPageData('RiskAssessment');\n\ncti.utils.updatePage();"},"_auto_id_":"0e2f32ec-a735-4edd-8153-957c1cc99d0c"}],"classes":"button-bar-btn"},{"name":"complete_proceed_btn","type":"button","item-type":"button","_auto_id_":"964b8805-2d69-48b2-892c-7d4bf3ece698","content":"Complete","theme":"default","expressions":{"show":"$store.payloads.riskAssessmentPayload != undefined  && $store.pages.RiskAssessment.confirmRiskAssessment != \"0\"","disabled":"$store.pages.RiskAssessment.confirmRiskAssessment == undefined || $store.pages.RiskAssessment.confirmRASignature == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\nvar payload = cti.store.payloads.riskAssessmentPayload;\n\npayload.questionOne == 1 ? payload.questionOne = \"Y\" : payload.questionOne = \"N\";\npayload.questionTwo == 1 ? payload.questionTwo = \"Y\" : payload.questionTwo = \"N\";\npayload.questionThree == 1 ? payload.questionThree = \"Y\" : payload.questionThree = \"N\";\npayload.questionFour == 1 ? payload.questionFour = \"Y\" : payload.questionFour = \"N\";\npayload.questionFive == 1 ? payload.questionFive = \"Y\" : payload.questionFive = \"N\";\npayload.questionSix == 1 ? payload.questionSix = \"Y\" : payload.questionSix = \"N\";\npayload.questionSeven == 1 ? payload.questionSeven = \"Y\" : payload.questionSeven = \"N\";\npayload.questionEight == 1 ? payload.questionEight = \"Y\" : payload.questionEight = \"N\";\n\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = true;\ncti.store.jobs.selectedJob.bJobStartWork = false;\ncti.store.jobs.selectedJob.sJobStartWorkText = \"Not started yet\";\ncti.store.jobs.selectedJob.iJobStartWorkTime = \"\";\n\ncti.store.variables.jobCollectionType = \"riskassessment\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\ncti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });\n\nwindow.appManager.createTimeList();"},"_auto_id_":"704ec32a-f7c8-49bc-b724-31191cb0c9aa","actions":[]}]},{"name":"abandon_raquestions_btn","type":"button","item-type":"button","_auto_id_":"e9f2bf46-daaa-4f09-b563-4b25fd97bad9","content":"Abandon RA","theme":"default","expressions":{"show":"($store.pages.RiskAssessment.questionOne == \"0\" || $store.pages.RiskAssessment.questionTwo == \"0\" || $store.pages.RiskAssessment.questionThree == \"0\" || $store.pages.RiskAssessment.questionFour == \"0\" || $store.pages.RiskAssessment.questionFive == \"0\" || $store.pages.RiskAssessment.questionSix == \"0\" || $store.pages.RiskAssessment.questionSeven == \"0\" || $store.pages.RiskAssessment.questionEight == \"0\") && $store.payloads.riskAssessmentPayload == undefined"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = \"Failed Risk Assessment\";\ncti.store.pages.RiskAssessment.confirmRiskAssessment = \"0\";\n\ncti.utils.updatePage();"},"_auto_id_":"952ef3c8-c674-4a54-b82f-df7c378abc48"}],"classes":"abandon-bar-btn"},{"name":"abandon_confirmcheck_btn","type":"button","item-type":"button","_auto_id_":"0293e848-9ae3-4a21-bf6a-8dacc33a2dc2","content":"Abandon RA","theme":"default","expressions":{"show":"$store.payloads.riskAssessmentPayload != undefined && $store.jobs.selectedJob.bRAStatus == false && $store.pages.RiskAssessment.confirmRiskAssessment == \"0\"","disabled":"$store.pages.RiskAssessment.confirmRiskAssessment == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = \"Failed Risk Assessment\";\n  \ncti.utils.updatePage();"},"_auto_id_":"e6a3a3e8-cdf3-491c-a897-fbb9df6a6976"}]},{"name":"abandon_job_btn","type":"button","item-type":"button","_auto_id_":"4842faf4-dd9e-4839-88fa-1b8058bf5f86","content":"Confirm","theme":"default","expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"0\" && $store.jobs.selectedJob.bRAStatus == \"Failed Risk Assessment\"","disabled":"$store.pages.RiskAssessment.noAccessSafelyReason == undefined"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\nvar payload = cti.store.payloads.riskAssessmentPayload;\n\nif(payload.questionOne != undefined) {\n  payload.questionOne == 1 ? payload.questionOne = \"Y\" : payload.questionOne = \"N\";\n} else {\n  payload.questionOne = \"N/A\";\n}\nif(payload.questionTwo != undefined) {\n  payload.questionTwo == 1 ? payload.questionTwo = \"Y\" : payload.questionTwo = \"N\";\n} else {\n  payload.questionTwo = \"N/A\";\n}\nif(payload.questionThree != undefined) {\n  payload.questionThree == 1 ? payload.questionThree = \"Y\" : payload.questionThree = \"N\";\n} else {\n  payload.questionThree = \"N/A\";\n}\nif(payload.questionFour != undefined) {\n  payload.questionFour == 1 ? payload.questionFour = \"Y\" : payload.questionFour = \"N\";\n} else {\n  payload.questionFour = \"N/A\";\n}\nif(payload.questionFive != undefined) {\n  payload.questionFive == 1 ? payload.questionFive = \"Y\" : payload.questionFive = \"N\";\n} else {\n  payload.questionFive = \"N/A\";\n}\nif(payload.questionSix != undefined) {\n  payload.questionSix == 1 ? payload.questionSix = \"Y\" : payload.questionSix = \"N\";\n} else {\n  payload.questionSix = \"N/A\";\n}\nif(payload.questionSeven != undefined) {\n  payload.questionSeven == 1 ? payload.questionSeven = \"Y\" : payload.questionSeven = \"N\";\n} else {\n  payload.questionSeven = \"N/A\";\n}\nif(payload.questionEight != undefined) {\n  payload.questionEight == 1 ? payload.questionEight = \"Y\" : payload.questionEight = \"N\";\n} else {\n  payload.questionEight = \"N/A\";\n}\n\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = \"Failed Risk Assessment\";\ncti.store.pages.RiskAssessment.confirmRiskAssessment = \"0\";\n\ncti.store.variables.jobCollectionType = \"riskassessment\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n\ncti.store.variables.jobEventStatus = \"abandonjob\";\ncti.store.jobs.selectedJob.sResultSummary = \"ABANDON JOB\";\ncti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.RiskAssessment.noAccessSafelyReason.value;\n  \ncti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });"},"_auto_id_":"22ca40bc-592a-475b-a05d-6994ef45e955"}],"classes":"abandon-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"NoAccess","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"5248cbf1-fac2-481c-874d-ee2ba76ac390","content":"<h4 class=\"title\">Access Check</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"fe62f0d9-7d2f-4125-b3e4-934b2264f416","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"NoAccess","componentInstanceId":"d4a83db1-0b3e-42b1-a039-1137eb93593f","function":"open"},"_auto_id_":"008e60eb-8146-491d-8046-b2f099989ef6"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"2ede09d9-af62-4883-b857-5801723b5a1e","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"ba3923e2-1f45-4b82-913b-89d8097a20e9"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"6eafd8c4-0f20-4bdd-853f-5ff0efad3449","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1e71e9ac-b7b2-4f91-86cb-dc6fba5be3b2"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"450aeba4-4adb-4a94-b165-ddeca9da194d","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"24d0d995-4475-414c-91e3-2a6bd31739ed"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"61fdb04f-ac61-45a6-8581-5c7512255ffe","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f474e6e9-567b-4043-909d-19dc2c1c2363"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"cd929f9e-7071-4026-b45a-48b92f5ed984","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a292f592-a0a9-4051-bf42-c99210769a3b"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"316f5990-22c7-4b2e-9329-8d2ad0ec2a55","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"NoAccess","componentInstanceId":"bf0e6a9c-7fd7-425f-bc90-a2eaed6d2163","function":"show"},"_auto_id_":"43140d8b-4416-4cf2-b9f9-87d936e2a9bc"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e31e5a2c-67a0-4801-9a60-eedfc9a910b1"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"07b80502-79ae-4f5d-90c2-b303fd5db393","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"54f54666-6388-4e86-a0d1-88d84d915fde"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"847c928c-54da-4a11-98b8-804ce05ede81","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"a4a671ed-1048-41fc-8f92-8f4f7d8a12d8"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"d4a83db1-0b3e-42b1-a039-1137eb93593f","attributes":{},"expressions":{}}],"_auto_id_":"b87a1bfb-d6fd-469d-bd7d-6c14a9150e3c","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"12fb7ea3-0d5a-409a-9e25-ef98952d4790","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"bf0e6a9c-7fd7-425f-bc90-a2eaed6d2163","attributes":{},"expressions":{},"actions":[]},{"name":"gainingAccess","type":"choice","item-type":"radio","_auto_id_":"029e6ff1-d7ff-4fff-a398-8db63eec1b52","label":"Are you able to gain access to the property?","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob != undefined) {\n  cti.store.pages.NoAccess.gainingAccessSafely = undefined;\n  cti.store.pages.NoAccess.noAccessReason = undefined;\n  cti.store.pages.NoAccess.noAccessSafelyReason = undefined;\n  cti.store.jobs.selectedJob.photos = undefined;\n\n  cti.utils.updatePage();\n}"},"_auto_id_":"d4fee33c-eda7-4674-95be-27a29b467437"}],"message":"This is a required field","validators":[]},{"name":"gainingAccessSafely","type":"choice","item-type":"radio","_auto_id_":"b7c915c7-3abb-4231-9b5e-d70e78565103","label":"Are you able to safely enter the property?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"1\""},"classes":"cb-bias-last","actions":[],"message":"This is a required field","validators":[]},{"name":"html_noaccessphoto","type":"content","item-type":"html","_auto_id_":"3a5c1ffe-9d82-48f1-8353-5d753c2a5ad6","content":"<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('NoAccess','5c61cee9-3f4f-442b-b436-8e9ceab7c9da')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""}},{"name":"btnTakePhotoNoAccess","type":"button","item-type":"button","_auto_id_":"58ba8c34-a176-4c3e-89f7-78c86706f3d3","content":"Take Photo","theme":"default","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""},"classes":"takephoto-btn","actions":[{"event":"click","type":"call-component-function","data":{"page":"NoAccess","componentInstanceId":"827ec688-df13-4e96-84e9-8440d4e445ec","function":"takePhoto"},"_auto_id_":"29ab1d2c-a1a0-488f-a3a5-77019d66a822"}]},{"name":"NoAccessPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"f509b6fb-7881-4012-8019-6a75ad689441","_auto_id_":"827ec688-df13-4e96-84e9-8440d4e445ec","attributes":{"captureCategory":"No Access","displayCategory":"No Access","maxPhotos":1},"expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""}},{"name":"noAccessReason","type":"choice","item-type":"select","_auto_id_":"d6bb5f2d-9037-49d5-80db-be4168fad285","label":"No access reason?","required":false,"options":[{"label":"Demolished Property","value":"Demolished Property"},{"label":"No Answer At Door","value":"No Answer At Door"},{"label":"No Answer At Door - Entry System","value":"No Answer At Door - Entry System"},{"label":"No Keys Available","value":"No Keys Available"},{"label":"Not Convenient","value":"Not Convenient"},{"label":"Other","value":"Other"},{"label":"Other Trade On Site","value":"Other Trade On Site"},{"label":"Right To Buy","value":"Right To Buy"},{"label":"Tenant Away","value":"Tenant Away"},{"label":"Tenant Bereavement","value":"Tenant Bereavement"},{"label":"Tenant ill Or In Hospital","value":"Tenant ill Or In Hospital"},{"label":"Tenant Refused Access","value":"Tenant Refused Access"}],"expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""},"message":"This is a required field","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.NoAccess) {\n  if(cti.store.pages.NoAccess.noAccessReason != undefined || cti.store.media.noAccessPhoto != undefined) {\n    cti.store.jobs.selectedJob.bJobNoAccess = true;\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"ec61718c-d6ed-4c51-8fbf-66a3fb83cbb7"}],"option-source":"$store.staticData.noAccessList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"noAccessSafelyReason","type":"choice","item-type":"select","_auto_id_":"bbbe805d-a4e4-45fa-9f25-412f1fcbb1c5","label":"Abandon job reason?","required":false,"options":[{"label":"Abusive/Violent Tenant","value":"Abusive/Violent Tenant"},{"label":"Appliance Not Accessible","value":"Appliance Not Accessible"},{"label":"Appliance Under Warranty","value":"Appliance Under Warranty"},{"label":"Arrange for Another Day","value":"Arrange for Another Day"},{"label":"Called Away to Another Job","value":"Called Away to Another Job"},{"label":"Dirty House","value":"Dirty House"},{"label":"Incorrect Part Received","value":"Incorrect Part Received"},{"label":"Minor Only in Property","value":"Minor Only in Property"},{"label":"No Electric On","value":"No Electric On"},{"label":"No Gas Heating","value":"No Gas Heating"},{"label":"No Gas On","value":"No Gas On"},{"label":"No Meter Present","value":"No Meter Present"},{"label":"Office Cancelled","value":"Office Cancelled"},{"label":"Other","value":"Other"},{"label":"Personal","value":"Personal"},{"label":"Sharps","value":"Sharps"},{"label":"Unable to Finish","value":"Unable to Finish"},{"label":"Wrong Trade","value":"Wrong Trade"}],"expressions":{"show":"$store.pages.NoAccess.gainingAccessSafely == \"0\""},"message":"This is a required field","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.NoAccess) {\n  if(cti.store.pages.NoAccess.noAccessSafelyReason != undefined) {\n    cti.store.jobs.selectedJob.bJobNoAccessSafely = true;\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"571f4aa5-394c-43f7-99d6-6003dfbca928"}],"option-source":"$store.staticData.abandonJobList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"ca5fb0cb-2f7a-4d58-bf0e-69cb3b983ede","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"35d1f3c1-78e0-442d-8c71-bcf3b25303c1","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"ArrivedOnSite","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"76208e99-7457-4bf5-96b1-b00590a1d961","content":"Next","theme":"default","expressions":{"show":"($store.pages.NoAccess.gainingAccess === undefined || $store.pages.NoAccess.gainingAccess == \"1\") && ($store.pages.NoAccess.gainingAccessSafely === undefined || $store.pages.NoAccess.gainingAccessSafely == \"1\")","disabled":"$store.pages.NoAccess.gainingAccess === undefined || $store.pages.NoAccess.gainingAccessSafely === undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.bJobNoAccessSafely == undefined) cti.store.jobs.selectedJob.bJobNoAccessSafely = false;\ncti.store.jobs.selectedJob.bGainedAccess = true;\nif(cti.store.jobs.selectedJob.bRAStatus == undefined) cti.store.jobs.selectedJob.bRAStatus = false;\n\nif(cti.store.jobs.selectedJob.bRAStatus) {\n  cti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"RiskAssessment\" });\n}"},"_auto_id_":"4f360866-c160-4a38-8444-c48a61f149d5"}]},{"name":"sendnoaccess_btn","type":"button","item-type":"button","_auto_id_":"3b02b9c4-d730-4c99-88b9-bd590b43cd6d","content":"Send No Access","theme":"default","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\"","disabled":"$store.pages.NoAccess.noAccessReason === undefined"},"classes":"abandon-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var photos = cti.store.jobs.selectedJob.photos;\nvar exists = false;\n\nfor(var i in photos) {\n  if(photos[i].category === \"No Access\") { \n    exists = true; \n    break; \n  }\n}\n\nif(exists) {\n  cti.store.variables.jobEventStatus = \"noaccess\";\n  cti.store.jobs.selectedJob.sResultSummary = \"NO ACCESS\";\n  cti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.NoAccess.noAccessReason.value;\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_noaccessphoto\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning\",\n      \"text\": \"You must take a photo to provide alongside reason for No Access to the property.\"\n    }\n  );\n}"},"_auto_id_":"a823dc8a-fe73-4cd2-a487-4bbac5d10fbc"}]},{"name":"abandonjob_btn","type":"button","item-type":"button","_auto_id_":"c1853980-f81d-4027-b5d1-7051493f80a6","content":"Abandon Job","theme":"default","expressions":{"show":"$store.pages.NoAccess.gainingAccessSafely == \"0\"","disabled":"$store.pages.NoAccess.noAccessSafelyReason === undefined"},"classes":"abandon-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.bJobNoAccessSafely) {\n  cti.store.variables.jobEventStatus = \"abandonjob\";\n  cti.store.jobs.selectedJob.sResultSummary = \"ABANDON JOB\";\n  cti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.NoAccess.noAccessSafelyReason.value;\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });\n}"},"_auto_id_":"fc3dc022-62fd-42d7-964a-ace6475b2a71"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"ArrivedOnSite","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"0901403c-1096-4d90-a65d-7de1c3a1a3f5","content":"<h4 class=\"title\">Arriving On Site</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"123c2e92-37cb-4861-99d9-700eb2d731a6","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"ArrivedOnSite","componentInstanceId":"7afd4562-92e6-4396-ab14-319edde1c728","function":"open"},"_auto_id_":"fcb94bf6-fc5b-49b8-992e-cf29b0d7f4a9"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"30840ae4-219c-4af7-90da-7251b71780f7","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"2db099ad-43d2-4a5d-b567-98833266aba2"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"54f593f1-e253-4cfd-888a-12de9498fdb2","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"4343eff3-3ceb-4339-8073-92b916cf3a8d"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"c54d76c1-56b4-4180-bf53-5cb412ba6899","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a200dbcc-ce2a-4517-b7ff-82e233d5ac24"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"fc01c985-0f83-4066-9133-575293b822d0","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e9e2e316-f635-4a08-9409-1b3270782e63"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"34924d04-c966-481b-aa8a-52ef83d25c63","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"fe9558f5-cfaa-42e4-9ab3-ee128ce8c1ac"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"9da07c10-6926-4354-aec8-5a7c7cd47811","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"ArrivedOnSite","componentInstanceId":"3bc742ef-5209-4d8e-94b9-c2f3c5709590","function":"show"},"_auto_id_":"ab516e72-cd43-4cef-85b4-1bd94883a466"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a33f34f9-fab6-4618-a103-c23de1988ad1"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"b16c650b-407a-4179-b97d-c46b8d90da94","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b85705a1-9d08-4dfb-b2ad-b4ef5e1adc02"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"c17a7495-15f6-430c-b7e3-c183cd8708e8","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"4d37ae56-8b1d-4aec-9c86-4f50dab7053e"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"7afd4562-92e6-4396-ab14-319edde1c728","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"b57616dc-71fc-4c35-aa77-c2f53ff815fa","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"2c6e4508-f389-42fb-a6f8-5c800552fa88","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"3bc742ef-5209-4d8e-94b9-c2f3c5709590","attributes":{},"expressions":{}},{"name":"html_arriving_pending","type":"content","item-type":"html","_auto_id_":"59c8aaff-da90-4ac5-8000-5c6015304da8","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelEnded == false"}},{"name":"html_arriving_arrived","type":"content","item-type":"html","_auto_id_":"e14f0d96-9e27-4a42-8a90-98b688c64cc5","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>\n<div class=\"arriving\">\n\t<i id=\"arriving-spinner\" class=\"fa arrived-ticked\"></i>\n</div>\n<h4 class=\"completeheader\">Arrived On-Site</h4>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelEnded == true"}},{"name":"sendArrivedMessage","type":"button","item-type":"button","_auto_id_":"7d8a2909-c729-4bbf-9125-f44f36ce1ee4","content":"End Travel","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelEnded == false"},"classes":"travel-btn","actions":[{"event":"click","type":"call-function","data":{"name":"fnEndTravel"},"_auto_id_":"89e4b505-91a2-4b0b-a757-8c4c073cebdd"}]},{"name":"html_travelstatus","type":"content","item-type":"html","_auto_id_":"66d14513-929c-4055-a6df-143395e1225e","content":"<p style=\"font-size: 12pt;\">{{'$store.jobs.selectedJob.sJobTravelEndedText'|store}}: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobEndedTravelTime'|store}}</span></p>\n<hr>\n<h5 style=\"font-weight:bold;\">Contact Name</h5>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sTenant_Name'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Address</h5>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_1'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_4'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sPostcode'|store}}</p>\n<hr>","expressions":{}},{"name":"html_activatedlone","type":"content","item-type":"html","_auto_id_":"6b612e1f-4ed3-461b-bd83-00427c8467fd","content":"<div class=\"arriving\">\n\t<i id=\"arriving-spinner\" class=\"fa arrived-ticked\"></i>\n</div>\n<h4 class=\"completeheader\">Activated Lone Working Device</h4>","expressions":{"show":"$store.jobs.selectedJob.bLoneDeviceStatus == true"}},{"name":"rdoLoneWorkingDevice","type":"choice","item-type":"radio","_auto_id_":"49c775e0-3b33-42b0-9a38-1259d40ebc4e","label":"Have you activated your Lone Working Device?","required":false,"options":[{"label":"Yes","value":"Yes"},{"label":"No","value":"No"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"false"},"classes":"cb-bias-last","actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"9dbe7b37-5b9e-41ea-9796-5e6d527ebe93","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"a0db0750-1168-43ab-a52b-46eb0c099c5d","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"StartTravel","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"6a1aacc1-2d76-43c5-b4cd-15645d4d8e16","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobTravelEnded == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.bJobNoAccess == undefined) cti.store.jobs.selectedJob.bJobNoAccess = false;\ncti.utils.callAction('go-to-page', { \"name\": \"NoAccess\" });"},"_auto_id_":"6c0d5e5f-9596-4698-be33-dc745740e95b"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"StartTravel","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"702ecfe7-86ba-4b66-b7cd-92a43ea48012","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var travelContainer = document.getElementById('travel-container');\nvar iconTravelContainer = document.getElementById('icon-travel-container');\n\ntravelContainer.href = \"geo:0,0?q=\" + cti.store.jobs.selectedJob.aPropertyDetail.sPostcode.replace(/\\s/g,'');\niconTravelContainer.href = \"geo:0,0?q=\" + cti.store.jobs.selectedJob.aPropertyDetail.sPostcode.replace(/\\s/g,'');"},"_auto_id_":"9fbf2aa2-0d98-42bd-9043-9e7f8944d37c"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"602bd40b-36a3-499e-a543-d95d85a51003","content":"<h4 class=\"title\">Start Travel</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"a464605e-7b7a-4395-a215-0d8265b3bc8c","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"StartTravel","componentInstanceId":"0b1f580b-e008-4d7c-ae18-87bfb96c42b7","function":"open"},"_auto_id_":"df939670-1db6-48ae-9efd-1e86654f75b7"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"b88808a6-f27e-455a-8f1f-822334ad0be0","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"3091f0e8-9c97-4226-8783-4cc62447ca77"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"b168d52d-b4ab-4dea-8446-af2a9dcc2c36","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"97c00a57-8da3-4027-b439-aa1ab9a5f3fe"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"968f6c6f-ee61-428a-8a89-3e644da9683f","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b69bf80d-3b66-4bff-ae0a-20b13bcf7ba8"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"674b77e3-4444-4203-a37f-f3b49d1f5389","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"42217b51-843a-4389-aea0-053bf48ef408"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"d12d0781-fb6e-48b9-bf99-58f06a2f26ce","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"19d42bd9-848a-4a0a-9dd0-adcf13f5fabc"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"34fd6100-4801-4bd1-b4fd-536ea23cb1ce","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c9160b22-0638-4856-8963-97ce14bfcde8"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"5f4b20bf-c776-4aab-b323-b9b11e7ff1b3","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"StartTravel","componentInstanceId":"016a9ffa-9b0e-4d79-889f-3df70d24fcef","function":"show"},"_auto_id_":"ff9e6efc-2ef2-46cc-abb3-950fe95b77b5"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"02f2e212-db8a-4b8b-ab5b-b3f46d2a901c"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"b3ef53a0-889d-40be-857d-805dd6f2b48c","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c5cc86cd-7ef1-46da-9648-2ce895934ffd"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"a0a90f68-d6e3-4e1a-b4d8-8b78bf238dd6","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"7b0b5a95-4e85-490c-bf16-57031eac947d"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"2c138e2b-20de-4fc9-85d4-7502b8d8e1cf","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"cb9c7490-1bb9-4343-83fb-1e3b4e25384f"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"0b1f580b-e008-4d7c-ae18-87bfb96c42b7","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"acad6af2-af87-4cc5-bc4e-ebb4e3a3980c","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"c88f6d17-ea3a-4b1c-bccb-4784bc237cd2","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"016a9ffa-9b0e-4d79-889f-3df70d24fcef","attributes":{},"expressions":{}},{"name":"html_travelling_pending","type":"content","item-type":"html","_auto_id_":"063f64a6-6625-4069-a8a2-32b551839a59","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted == false"}},{"name":"html_travelling_started","type":"content","item-type":"html","_auto_id_":"67767d05-5228-4871-8a11-94f961f433b1","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>\n<div class=\"starting\">\n\t<i id=\"starting-spinner\" class=\"fa started-ticked\"></i>\n</div>\n<h4 class=\"completeheader\">En-Route Message Sent</h4>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted == true"}},{"name":"sendEnrouteMessage","type":"button","item-type":"button","_auto_id_":"05b56d6d-895f-4ed5-bf13-96ed4474dab1","content":"Send En-Route Message","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted == false"},"classes":"travel-btn","actions":[{"event":"click","type":"call-actionflow","data":{"name":"ValidateJob"},"_auto_id_":"03c6fa8e-ec44-4b07-8749-0924d08335aa"}]},{"name":"html_travelstatus","type":"content","item-type":"html","_auto_id_":"1de3bfb7-6532-467f-b09a-b2f5bd6a8c57","content":"<p style=\"font-size: 12pt;\">{{'$store.jobs.selectedJob.sJobTravelStartedText'|store}}: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobStartedTravelTime'|store}}</span></p>\n<hr>\n<div style=\"width:100%;text-align:center;\"><a target=\"_blank\" class=\"fa getmethere buttonDisabled\" id=\"icon-travel-container\"></a></div>\n<div style=\"width:100%;text-align:center;\"><a target=\"_blank\" class=\"btn btn-default getmethere-btn\" id=\"travel-container\">Get Me There</a></div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"cec023c2-a96a-44cf-b6fb-2e983e4e88f1","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"eed2544e-46a5-4eca-b287-a74824a1c916","content":"Previous","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobTravelStarted === true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var selectedJob = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\n\nif(selectedJob.length > 0) {\n  cti.utils.callAction('go-to-page', { \"name\": \"Warnings\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"JobAccessDetails\" });\n}"},"_auto_id_":"a9c761e9-fae1-4830-a043-48aabcd24071"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"839ca6e1-6f28-4fc0-b751-b56016dcb9aa","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobTravelStarted == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(!cti.store.jobs.selectedJob.bJobTravelEnded) {\n  cti.store.jobs.selectedJob.bJobTravelEnded = false;\n  cti.store.jobs.selectedJob.sJobTravelEndedText = \"Pending Arrival\";\n}\n\nif(cti.store.jobs.selectedJob.bLoneDeviceStatus == undefined) cti.store.jobs.selectedJob.bLoneDeviceStatus = false;\n\ncti.utils.callAction('go-to-page', { \"name\": \"ArrivedOnSite\" });"},"_auto_id_":"9899b7f0-e7b1-4dd1-902c-1a7c6b2395a5"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"Warnings","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"e739cfe2-23ae-403a-aec3-cb63e6c71997","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var warnings = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\nvar allChecked = true;\n\nfor(var i in warnings) {\n  var thisWarning = warnings[i];\n  \n  if(thisWarning.checked === \"unchecked-warning\") {\n    allChecked = false;\n    break;\n  }\n}\n\nvar element = document.getElementById('select-all');\n\nif(allChecked) {\n  element.classList.remove('all-unchecked-warning');\n  element.classList.add('all-checked-warning');\n  \n  var objDiv = document.getElementById(\"scrollable\");\n  objDiv.scrollTop = objDiv.scrollHeight;\n} else {\n  element.classList.remove('all-checked-warning');\n  element.classList.add('all-unchecked-warning');\n}\n\ncti.utils.updatePage();"},"_auto_id_":"c2ac2104-0687-4a3c-83ad-5f527612240d"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"3a14b1fd-6cce-48f3-817c-8fe18399476c","content":"<h4 class=\"title\">Warnings</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"efd12d9b-5052-4405-9a27-a4ac9fbc58c4","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobsList","componentInstanceId":"b31b3059-2a6b-4688-a622-b288b37d30e1","function":"open"},"_auto_id_":"8562d104-14b9-4da0-8e19-5a37bb2e291c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"796558a0-93b3-4f03-969c-6030ea54585a","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"1f792bb5-7048-40d0-bdf5-2ce2893b2d36"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"2c196d3d-79fc-437b-a99a-fb3eb1bfdbd4","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"796ec05e-0689-4a18-9e31-d88a62215185"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"7ae7afef-f720-45ca-a561-4e5408891980","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a71746c2-4fda-4463-97d0-69c8ddbd06a7"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"ae1ff703-5ccb-420d-90e5-3d2dbf69af06","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8f817917-4d7b-4573-a32f-1d0c3ef4ff4a"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"406dd164-00d7-41f7-af20-e86c42d6fb21","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f34e225e-45a2-4729-8901-599321868a3e"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"8d9702b7-ebce-4cc6-a8f9-a3f52e0ad195","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8a651578-80f6-4172-a78b-c3a90a253379"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"6bc6208d-7c9d-498c-b493-b9375f400ef7","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"Warnings","componentInstanceId":"f02d27fa-60c2-493a-bc05-24b29914989e","function":"show"},"_auto_id_":"0c2d896a-0f75-4f55-a30e-2cec713b739c"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"726ca9eb-302b-4ee9-b9ab-ba3bd1e7fdae"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"70550265-aca2-4921-94cd-79602257f8a2","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"40d472c4-1aae-4775-92f6-2915d4da271d"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"45631829-f76a-4c0a-ad90-95106c1b1281","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"b0545856-ef4d-40b9-ab31-1935b9f231aa"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"bcb5e256-54d2-4f06-976e-1f0bfaa686ab","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"40d1e7a4-2a74-41b5-8963-4e4b48bc0cfb"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"e1a6e628-0ecb-4832-8b09-1d42be1f27cf","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"3cebe18c-6542-4cf9-bca3-f5ebc6b3c287","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"5d59489d-e4bb-425f-ac62-c2b38f7c87c2","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"f02d27fa-60c2-493a-bc05-24b29914989e","attributes":{},"expressions":{}},{"name":"html_warnings","type":"content","item-type":"html","_auto_id_":"8e4a9847-045f-407f-a538-d991b8d0178d","content":"<p>Please check and select the below warnings to confirm you have read and confirmed them. Current number of Warnings for this property is: <strong><span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings.length'|store}}</span></strong></p>\n<hr>\n<div style=\"display:inline-block;width:100%;\">\n  <div class=\"fa fa-list\"></div>\n  <div class=\"warning-short\">Select All...</div>\n  <div id=\"select-all\" class=\"fa all-unchecked-warning\" onclick=\"cti.fnCheckAllWarnings();\"></div>\n</div>","expressions":{}},{"name":"list_warnings","type":"content","item-type":"list","_auto_id_":"61afb7b3-d4e7-4014-9e32-76cb6f405148","search":"","classes":"","expressions":{},"model":"$store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings","theme":"bootstrap","actions":[{"event":"click","type":"call-function","data":{"name":"fnCheckWarning","params":{"warning":"{{$data.$item}}","index":"{{$data.$item.index}}"}},"_auto_id_":"99d260c3-834d-4c1f-a31f-ac49b263f077"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_warnings_html","_auto_id_":"a69bb295-f96f-42c2-ad24-fe8c57d29605","content":"<div style=\"display:inline-block;width:100%;padding:5px;\">\n  <div style=\"display:inline-block;width:100%;\">\n    <div class=\"{{$data.$item.outerClass}} fa {{$data.$item.innerClass}}\"></div>\n  \t<div class=\"warning-short\">{{$data.$item.sWarnReason}}</div>\n    <div class=\"fa {{$data.$item.checked}}\"></div>\n  </div>\n  <div style=\"margin-bottom: 5px;\">{{$data.$item.sWarnCategory}}</div>\n  <div>{{$data.$item.sWarnText}}</div>\n</div>"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"57676bda-90e1-4297-bfd3-f01b8b8ed84f","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"c0845730-0f40-4ffb-a18b-561d08428e8a","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"JobAccessDetails","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"aa989b13-cf36-49aa-91f4-4301f555a802","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(!cti.store.jobs.selectedJob.bJobTravelStarted) {\n  cti.store.jobs.selectedJob.bJobTravelStarted = false;\n  cti.store.jobs.selectedJob.sJobTravelStartedText = \"Pending Start of Travel\";\n} else {\n  cti.store.jobs.selectedJob.sJobTravelStartedText = \"En-Route Time\";\n}\n\nif(!cti.store.jobs.selectedJob.aPropertyDetail.bPropertyWarningsDataCollection) {\n  cti.store.variables.jobCollectionType = \"warnings\";\n  cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"StartTravel\" });"},"_auto_id_":"04bfaaa3-c070-4e6a-8064-10c68f7b9b6b"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobAccessDetails","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"1a017844-6af6-461b-ba79-607c41c1c51f","content":"<h4 class=\"title\">Job and Access Detail</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"1f727aed-a76f-4ef0-9c46-cd6a9fefae82","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobAccessDetails","componentInstanceId":"15391f51-5c9b-4cc5-9442-95c6214a5a7a","function":"open"},"_auto_id_":"35fa2ffb-4867-44f3-b7de-7ed7cfdcb753"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bccfccb5-bc15-404e-b1a1-35594b2e8934","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"deee1234-07a8-4cae-b693-dedd26e6ebd0"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"aac16677-aa98-41ea-941f-e0ebb594f67d","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"70d16cb2-4cb5-49f9-94c4-b3d05978ab10"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"8aa6f3e4-580c-49e0-971a-4c0f65af04a8","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ec24c845-bd51-4942-8b07-fca29b578cdb"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"d4bf73da-2a1f-4136-9225-811b13b2ed9b","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3c1ac684-df65-4f75-869f-591823fbe7b4"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"29437b41-9bf1-4fe2-bcc8-22ad4ef22555","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e57813cc-7917-4516-b268-5ef4b3e34171"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"b3fcfb6a-7636-4f55-aa9f-719f110530f5","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"7b47178a-8113-4051-80cd-dfeef2297a24"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"ce67d957-c5ec-4ccd-bd1e-380e73d958de","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobAccessDetails","componentInstanceId":"88b9479b-43ed-4d65-b84b-dbb8bb849325","function":"show"},"_auto_id_":"446d28be-a9fa-41d2-ab1a-93e0fc46fa04"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8326a15a-da60-4fae-9da0-d82816b82c09"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"592f2999-3067-47e3-aa40-f8ad5d22c439","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1bd268d2-4ae0-4119-8aa7-b2bc38e3392f"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"9f95bd33-f869-43ac-9e00-0225e3b09a05","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"718feaf5-7523-4852-919a-ed9a464511c0"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"c0b83bf7-529e-40e6-882a-b24613db050f","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"f139928d-5aa4-4f3c-b640-456c68701433"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"15391f51-5c9b-4cc5-9442-95c6214a5a7a","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"07060863-5402-4df3-a8c4-eaebb09c6b1f","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"88b9479b-43ed-4d65-b84b-dbb8bb849325","attributes":{},"expressions":{}},{"name":"html_jobaccessdetail","type":"content","item-type":"html","_auto_id_":"463d32a8-62d5-423f-bde5-2e7cd86112b3","content":"<h4>Order Details</h4>\n<hr>\n<h5 style=\"font-weight:bold;\">Summary:</h5>\n<p>{{'$store.jobs.selectedJob.sProblemSummary'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Description:</h5>\n<p>{{'$store.jobs.selectedJob.sProblemDetail'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Access Details:</h5>\n<p>{{'$store.jobs.selectedJob.sAccessDetail'|store}}</p>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"2dda5fb3-2e8f-4734-9e4f-3e97c702355f","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"1baabe78-c838-49e6-81b6-9d02c830542e","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"TenantDetails","isConditional":false,"expressions":{}}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"aa90b6ec-f5c4-4f74-9380-a76e1a9aa425","content":"Next","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var propertyDetail = cti.store.jobs.selectedJob.aPropertyDetail;\nvar index = -1;\n\nif(propertyDetail.aPropertyWarningsChecked == undefined) { \n  propertyDetail.aPropertyWarningsChecked = false; \n}\n  \nif(propertyDetail.aPropertyWarnings) {\n  if(propertyDetail.aPropertyWarnings.length > 0) {\n    for(var i in propertyDetail.aPropertyWarnings) {\n      var warning = propertyDetail.aPropertyWarnings[i];\n      var iconClass = undefined;\n      \n      if(warning.checked == undefined) {\n        warning.checked = \"unchecked-warning\";\n      }\n      \n      if(warning.checked === \"unchecked-warning\") {\n        propertyDetail.aPropertyWarningsChecked = false;\n      }\n      \n      if(warning.sWarnText == undefined || warning.sWarnText == \"\") {\n        warning.sWarnText = \"No information was supplied with this warning, please proceed with caution.\";\n      }\n\n      classes = cti.fnReturnIconClass(warning.sWarnReason);\n      warning.innerClass = classes.iconClass;\n      warning.outerClass = classes.outerClass;\n      \n      index++;\n      warning.index = index;\n    }\n    \n    cti.utils.callAction('go-to-page', { \"name\": \"Warnings\" });\n  } else {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_nowarnings\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"No Warnings!\",\n        \"text\" : \"There are no Tenant or Property Warnings for this job.\"\n      }\n    );\n\n    if(!cti.store.jobs.selectedJob.bJobTravelStarted) {\n      cti.store.jobs.selectedJob.bJobTravelStarted = false;\n      cti.store.jobs.selectedJob.sJobTravelStartedText = \"Pending Start of Travel\";\n    }\n\n    cti.utils.callAction('go-to-page', { \"name\": \"StartTravel\" });\n  }\n}"},"_auto_id_":"1ec764b1-0b2d-493f-a1d9-e6bdabe2549e","actions":[]}],"expressions":{},"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"89484f79-6379-4d14-8467-12354c041d36"}]},{"start":false,"name":"TenantDetails","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"59d3ed00-5b92-4d3e-9ef3-411bcc1200f0","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var job = cti.store.jobs.selectedJob.aPropertyDetail;\n\nvar left = document.getElementById('left');\nvar right = document.getElementById('right');\nvar center = document.getElementById('center');\n\nvar leftText = document.getElementById('left-text');\nvar rightText = document.getElementById('right-text');\nvar centerText = document.getElementById('center-text');\n\nif(job.sHome_No == \"\" || job.sHome_No == undefined) {\n  left.classList.add('no-home');\n  leftText.classList.add('no-home');\n} else {\n  left.onclick = function() { cti.fnPhoneCall('tenanthome'); };\n}\n\nif(job.sMobile_No == \"\" || job.sMobile_No == undefined) {\n  right.classList.add('no-mobile');\n  rightText.classList.add('no-mobile');\n} else {\n  right.onclick = function() { cti.fnPhoneCall('tenantmob'); };\n}\n\nif(job.sWork_No == \"\" || job.sWork_No == undefined) {\n  center.classList.add('no-booked');\n  centerText.classList.add('no-booked');\n} else {\n  center.onclick = function() { cti.fnPhoneCall('user'); };\n}\n\ncti.utils.updatePage();"},"_auto_id_":"e9352432-0dc0-468a-affe-8b2f475981d3"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"0fe482fb-2edf-4c69-a4e3-485d6b23067e","content":"<h4 class=\"title\">Tenant Details</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"c2484509-3108-489a-bbd7-568db902a590","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"TenantDetails","componentInstanceId":"015fbc97-bea5-406d-b694-c81cf0e6373e","function":"open"},"_auto_id_":"73a42cc1-7419-4de6-bf7a-d147c6c6d96a"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"d8763dd6-22b0-44aa-ab71-bb9f43cb10d7","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"f6c3df08-152d-4fc6-8bb6-032a5bb54625"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"26a85f16-6e51-41b8-a726-9615038b58a6","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"65131c07-9a07-429f-98d9-b5db0696244e"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"5950498e-3903-4a59-b8d9-3119b25ee24c","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"80661d15-9136-4b05-b27e-91f07a081148"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"d09fe109-4e31-49c0-8a90-1f10abcbdfb7","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9ca82674-3123-482a-992a-91f54ddba784"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"4dfcb71a-f9ec-4e51-ad1c-775c377d128d","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d081662e-20a8-47d9-be8f-22e72456b4ec"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"5b6f09e2-cd16-4188-924a-b7167c9c3cc2","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"fa8cc205-20bb-4465-85c1-2a268e2342e1"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"5ba13b3f-30d4-467b-8a91-3f839161d821","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"TenantDetails","componentInstanceId":"0b26bb85-3867-4dd4-9e8f-cc0aa4bfe576","function":"show"},"_auto_id_":"cd29d06c-dc73-4907-be41-36644938ecb9"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"bd7056b6-9cbc-4d04-8c13-1ea64a512bf6"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"7b38f280-0ec8-43a3-9f42-0faa03701e96","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b9f11ad0-a8a5-477b-8230-1398c5f699d2"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"abb26f81-7c40-41da-b34e-cc733a64041e","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"b2192bc3-7be5-4fe0-b1f2-cfb7a807d398"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"4054a2f3-9488-42cf-85d5-9aed9d2c8221","content":"Logout","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"a1638e32-165d-4e38-9b58-659bc9f5e149"}],"left-icon":"fa-sign-out"}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"015fbc97-bea5-406d-b694-c81cf0e6373e","attributes":{},"expressions":{}}],"_auto_id_":"1e622393-0bf2-4c65-b928-02b27a172a0e","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"0b26bb85-3867-4dd4-9e8f-cc0aa4bfe576","attributes":{},"expressions":{},"actions":[]},{"name":"html_tenantdetails","type":"content","item-type":"html","_auto_id_":"409c7bfc-f516-43f4-b4b3-70aee435afc3","content":"<p style=\"font-weight:100;\">Tenant Name: <span style=\"font-weight:bold;\">{{'$store.jobs.selectedJob.aPropertyDetail.sTenant_Name'|store}}</span></p>\n<p style=\"font-weight:100;\">Attend On: <span style=\"font-weight:bold;\">{{'$store.jobs.selectedJob.dAttendOnDate'|store}}</span></p>\n<p style=\"font-weight:100;\">Appointment Slot: <span style=\"font-weight:bold;\">{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>\n<h5 style=\"font-weight:bold;\">Address</h5>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_1'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_4'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sPostcode'|store}}</p>\n<hr>\n<div class=\"centered-max\">\n  <div class=\"tenant-contacts\">Call Telephone Number:</div>\n  <div class=\"inlineblock-default\">\n    <div id=\"left\" class=\"fa home\"></div>\n    <div id=\"right\" class=\"fa mobile\"></div>\n    <div id=\"center\" class=\"fa booked\"></div>\n  </div>\n  <div class=\"inlineblock-default\">\n    <div id=\"left-text\" class=\"home-text\">Tenant Home</div>\n    <div id=\"right-text\" class=\"mobile-text\">Tenant Mobile</div>\n    <div id=\"center-text\" class=\"booked-text\">Booked By</div>\n  </div>\n</div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"44274661-5ce0-4b05-ae6f-fa49304aadd0","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"d1546148-d366-4499-b829-ac3c8e419db1","content":"Previous","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Returning to Job List...');\nwindow.accuServFunctions.fnClearJobData();"},"_auto_id_":"9a52d7d5-43a3-4500-a91b-eaeabdfc5150"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"nav-button","_auto_id_":"1decc51a-b01a-4971-8b87-ac6131df2841","extends":{"type":"button","item-type":"button"},"content":"Next","actions":[{"event":"click","type":"go-to-page","data":{"name":"JobAccessDetails","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"c200c353-bb09-48d7-96e3-bbff3582685a"}]},{"start":false,"name":"JobList","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"a1f20f3d-9a54-474b-8b34-d19e1f998183","actions":[{"event":"onloaded","type":"inline-function","data":{"sync":true,"code":"if(cti.store.variables.reSyncJobList) {\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n}"},"_auto_id_":"b4124fb8-5ec8-4e71-88f3-2979ef8ad2b1"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"a2dec18d-8aae-4698-9b53-31ffb4a62372","content":"<h4 class=\"title\">Job List</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"ed9bee2f-abe8-4ede-b868-875b1dab4f14","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobsList","componentInstanceId":"b31b3059-2a6b-4688-a622-b288b37d30e1","function":"open"},"_auto_id_":"1a7f357f-ec03-4c2f-ae78-62f583e70914"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"f0d4db81-2942-490e-b8f8-e4c2bca4bc66","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"04b47566-e14a-4f6f-91b4-9ce4a414a5a9"}]},{"name":"btnReSyncJob","type":"button","item-type":"button","_auto_id_":"7834d6e6-9306-4511-b0bd-3564afb78f83","content":"Re-Sync Job List","theme":"default","left-icon":"fa-refresh","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('call-actionflow',{'name':'GetJobList'});"},"_auto_id_":"00ef274f-2727-442a-9010-694cd2f09ae7"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"36c16ae3-94f2-471f-8f1e-da664b5f0651","content":"Job Map","theme":"default","expressions":{"show":"$store.jobs.jobList.length > 0"},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"419bf1de-9c66-4d56-adfe-a256bc5e5c37"}]},{"name":"btnRequestJob","type":"button","item-type":"button","_auto_id_":"4b3ca61c-7a41-46b6-bf94-da62b47245b4","content":"Request a Job","theme":"default","left-icon":"fa-send-o","actions":[{"event":"click","type":"go-to-page","data":{"name":"RequestJob","isConditional":false},"_auto_id_":"a9739727-5cc5-4587-a48a-13c4fa2a39fa"}],"expressions":{}},{"name":"btnRaiseIncident","type":"button","item-type":"button","_auto_id_":"61ac8454-0c2c-44ab-a88f-23e2dfd2d13d","content":"Raise an Incident","theme":"default","left-icon":"fa-warning","actions":[{"event":"click","type":"go-to-page","data":{"name":"RaiseIncident","isConditional":false},"_auto_id_":"bd6f0b50-3002-4bf8-a7b5-be473effb3be"}],"expressions":{}},{"name":"btnPauseTask","type":"button","item-type":"button","_auto_id_":"b476ee4f-5c23-4562-b518-c3853a9c4312","content":"Pause Task","theme":"default","expressions":{},"left-icon":"fa-pause","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"PauseTask\" });"},"_auto_id_":"806fabde-312f-442b-b07d-0cc9a2ed771b"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"15c1b6bf-b9c1-4cf8-abb4-0da941826121","content":"Logout","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"d8fa87c1-f09a-494b-a64f-8337a62065f9"}],"left-icon":"fa-sign-out"}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"b31b3059-2a6b-4688-a622-b288b37d30e1","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"6da8e581-2244-4198-9813-2c7805f3c9d5","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"noJobsDisplay","type":"content","item-type":"html","_auto_id_":"7fc8e8ea-2079-4aae-9066-c41e56eb4dea","content":"<h4 class=\"centered-text\">You have 0 Jobs</h4><p class=\"centered-text\">Currently you do not have any Jobs in your Job List. Please contact your Supervisor or re-sync your list by tapping the below icon.</p>\n<div class=\"retry-job\" onclick=\"cti.utils.callAction('call-actionflow',{'name':'GetJobList'});\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.jobs.jobList.length === 0"}},{"name":"list_joblistshort","type":"content","item-type":"list","_auto_id_":"6a380a2a-0c60-4bd1-9fa9-a480ac29ca5b","search":"internal","classes":"","expressions":{"show":"$store.jobs.jobListShort.length > 0 && $store.variables.showFullJobs !== true"},"model":"$store.jobs.jobListShort","theme":"bootstrap","actions":[{"event":"click","type":"call-function","data":{"name":"fnSelectJob","params":{"jobid":"{{$data.$item.aAccuServJobID.iJobEventNoKey}}"}},"_auto_id_":"01303fe1-4522-464f-b689-05ec15ffe36f"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_joblistshort_html","_auto_id_":"03f37c36-78a3-440f-95bd-3156628808a6","content":"<div class=\"joblist-container\">\n  <div class=\"joblist-column-1 joblist-status\">\n    <div class=\"joblist-slot\">{{::$data.$item.sAssignedType}}</div>\n    <div class=\"joblist-day\">{{::$data.$item.sDay}}</div>\n    <div class=\"joblist-month\">{{::$data.$item.sMonth}}</div>\n  </div>\n  <div class=\"joblist-column-2\">\n    <div class=\"joblist-contract\">{{::$data.$item.sProblemDetailDisplay}}</div>\n    <br>\n    <div class=\"joblist-priority\">{{::$data.$item.sContract}}</div>\n    <div class=\"joblist-priority\">{{::$data.$item.sPriority}}</div>\n    <div class=\"joblist-address\">{{::$data.$item.sHouseNo}} {{::$data.$item.sAddress1}}, {{::$data.$item.sPostcode}}</div>\n  </div>\n  <div class=\"joblist-column-3\"></div>\n</div>","expressions":{}}],"searchFunctionExternal":"function (searchCriteria, item) {\n  // e.g., return item.name === searchCriteria.name;\n}","searchMode":"type","searchDebounce":500,"searchWithin":"","searchFunction":"function (searchTerm, item) {\n  // e.g., return item.name === searchTerm;\n}"},{"name":"list_joblistfull","type":"content","item-type":"list","_auto_id_":"94eb7015-dbd5-45de-8260-2df3666af3f9","search":"internal","classes":"","expressions":{"show":"$store.jobs.jobList.length > 0 && $store.variables.showFullJobs === true"},"model":"$store.jobs.jobList","theme":"bootstrap","actions":[{"event":"click","type":"call-function","data":{"name":"fnSelectJob","params":{"jobid":"{{$data.$item.aAccuServJobID.iJobEventNoKey}}"}},"_auto_id_":"ea3ca642-514b-4fbf-8300-e0c5b87b99a1"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_joblistfull_html","_auto_id_":"63b48e68-96e0-4d73-a106-11ced34ca6cf","content":"<div class=\"joblist-container\">\n  <div class=\"joblist-column-1 joblist-status\">\n    <div class=\"joblist-slot\">{{::$data.$item.sAssignedType}}</div>\n    <div class=\"joblist-day\">{{::$data.$item.sDay}}</div>\n    <div class=\"joblist-month\">{{::$data.$item.sMonth}}</div>\n  </div>\n  <div class=\"joblist-column-2\">\n    <div class=\"joblist-contract\">{{::$data.$item.sProblemDetailDisplay}}</div>\n    <br>\n    <div class=\"joblist-priority\">{{::$data.$item.sContract}}</div>\n    <div class=\"joblist-priority\">{{::$data.$item.sPriority}}</div>\n    <div class=\"joblist-address\">{{::$data.$item.sHouseNo}} {{::$data.$item.sAddress1}}, {{::$data.$item.sPostcode}}</div>\n  </div>\n  <div class=\"joblist-column-3\"></div>\n</div>","expressions":{}}],"searchFunctionExternal":"function (searchCriteria, item) {\n  // e.g., return item.name === searchCriteria.name;\n}","searchMode":"type","searchDebounce":500,"searchWithin":"","searchFunction":"function (searchTerm, item) {\n  // e.g., return item.name === searchTerm;\n}"},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"acc82558-b25e-4d3d-b151-3b3a8fdb78a8","content":"Show More Jobs","theme":"default","expressions":{"show":"$store.variables.showFullJobs === false && $store.jobs.jobList.length >0"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullJobs = true;\ncti.utils.updatePage();"},"_auto_id_":"65fbde68-a8cb-438e-bcbb-9978c775783b"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"1ad48f82-afc5-4adc-8e28-977852061f16","content":"Show Less Jobs","theme":"default","expressions":{"show":"$store.variables.showFullJobs === true && $store.jobs.jobList.length >0"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullJobs = false;\ncti.utils.updatePage();"},"_auto_id_":"e63e3755-c5b3-4974-9a5c-366be1b73306"}],"classes":"showlist-btn"},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"a6f1b8d0-f4e9-4c48-9347-c6ad294f3759","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"08c6a9dd-131b-4740-b60e-85b9ad51c394"}]},{"start":false,"name":"VehicleChecksPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"0526361e-5c11-4daa-a9f0-eec9851e480f","content":"<h4 class=\"title\">Vehicle Checks - Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"cd252f99-82d3-4776-b09c-67bee6a1baa4","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecks","componentInstanceId":"fe6dd10f-0cb3-418e-962d-9970d4bffebe","function":"open"},"_auto_id_":"303860f6-d129-474c-8089-1b5e1f738bf7"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"f6596e04-92f7-43b9-aaac-a3558bee7a43","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"bf747251-dc2c-4b08-9600-babfe932cda9"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"0aaf3943-3bd8-4bc6-952e-c01c60d7fe4b","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"1cfde628-a8a4-44b7-9d45-219e16aa6082"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"fe6dd10f-0cb3-418e-962d-9970d4bffebe","attributes":{},"expressions":{}}],"_auto_id_":"c60819a3-9e5b-4091-8653-0de916948f82","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"5e2fc209-699b-482c-bead-19c4c4afae21","attributes":{},"expressions":{}},{"name":"html_vehiclecheckheader","type":"content","item-type":"html","_auto_id_":"8e5b8223-626a-430c-b822-ef693f08fe88","content":"<h4>Vehicle Check Photos</h4>\n<p>If you wish to take any photos to accompany the Vehicle Check, please do so here. You can take a maximum of 10 photos.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('VehicleChecksPhotos','dba898e6-7afb-427a-884f-8e170d7507a3')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{}},{"name":"takePhoto_btn","type":"button","item-type":"button","_auto_id_":"7511d457-ee31-4618-9291-1b27bebe13d9","content":"Take Photo","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecksPhotos","componentInstanceId":"1ae8f3b5-d9cd-4770-8853-501854a7474b","function":"takePhoto"},"_auto_id_":"9727b622-0d95-494c-bd51-068f5797a34e"}],"classes":"takephoto-btn"},{"name":"VehicleCheckPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"f509b6fb-7881-4012-8019-6a75ad689441","_auto_id_":"1ae8f3b5-d9cd-4770-8853-501854a7474b","attributes":{"captureCategory":"Vehicle Check","displayCategory":"Vehicle Check","maxPhotos":10},"expressions":{},"actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"a9925d52-0937-4357-9999-553e781ae5da","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"c626302c-211a-4cba-a80d-f9a706f8aa47","content":"Previous","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Return back to Vehicle Check Page */\ncti.utils.callAction('go-to-page', { name: \"VehicleChecks\" });"},"_auto_id_":"f27e77a5-b504-45c3-a262-9201a4638c6d","actions":[]}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"256f842a-524a-4844-a495-8aade30f1767","content":"Complete","theme":"default","expressions":{"disabled":"$form.invalid || $store.pages.VehicleChecksPhotos.oilCheckOk == \"0\" || $store.pages.VehicleChecksPhotos.waterCheckOk == \"0\" || $store.pages.VehicleChecksPhotos.tyresCheckOk == \"0\" || $store.pages.VehicleChecksPhotos.lightsCheckOk == \"0\""},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Process StartOfDay and fetch StaticData and Jobs */\ncti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"StartOfDay\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });"},"_auto_id_":"7566c79f-034d-4744-a050-cc24d55008ae","actions":[]}]}],"expressions":{}}],"_auto_id_":"2f8ffe4c-bace-46dc-b53e-1abb85df55b8","expressions":{}}]},{"start":false,"name":"VehicleChecks","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"e536320f-9811-4759-8796-8a8ed8365f83","content":"<h4 class=\"title\">Vehicle Checks</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"01b68805-8da1-4f5e-8750-af398c1f2621","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecks","componentInstanceId":"1e558724-77eb-49cb-9bbb-6424105228b0","function":"open"},"_auto_id_":"0afd7615-d5c9-4fad-bdd2-eaeb695c5643"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"9ddc8d5c-38ac-4529-b1ca-b5e9524b2429","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"69a325ae-1bca-4fe2-b469-37a422abcb24"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"c0980c93-6f53-490c-854e-000836751222","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"b27a7963-77c7-43ea-91f9-bd57e724428a"}]}],"componentId":"563920b3-2105-4832-b9a0-4895c1d36eef","_auto_id_":"1e558724-77eb-49cb-9bbb-6424105228b0","attributes":{},"expressions":{}}],"_auto_id_":"d69c9ee9-f281-4e86-8758-a161550867c5","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"36f85b62-7878-4b01-a6e6-16bb81dbc1b6","attributes":{},"expressions":{}},{"name":"rdoDrivingCheck","type":"choice","item-type":"radio","_auto_id_":"046bcc45-3ef4-451f-aff2-159baee49766","label":"Are you driving today?","required":false,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[]},{"name":"html_vehiclecheck","type":"content","item-type":"html","_auto_id_":"8450f10e-eae5-4dd8-98f8-f1036bf64528","content":"<h4>Please complete a Vehicle Check</h4><p>Fill out the vehicle check questions below and confirm the latest odometer reading before continuing.</p>","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""}},{"name":"vehicleRegistration","type":"user-input","item-type":"text","_auto_id_":"af8560bd-8dcc-47d4-8f38-c3558168bce8","label":"Vehicle Registration Number","required":false,"multiline":false,"debounce":250,"message":"Please enter a Vehicle Registration Number","expressions":{"show":"false"},"validators":[],"actions":[],"placeholder":"E.g. TE66 EST","classes":"vehiclecheck-reg","default":""},{"name":"oilCheckOk","type":"choice","item-type":"radio","_auto_id_":"54c620ff-825d-41fc-b8d1-454d3d546198","label":"Oil checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"waterCheckOk","type":"choice","item-type":"radio","_auto_id_":"84266219-dcb0-4d6b-b4f1-946dd9d1d542","label":"Water checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"tyresCheckOk","type":"choice","item-type":"radio","_auto_id_":"5d1e17d0-8f4b-4af9-b3d6-b6c528cdb641","label":"Tyres checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"lightsCheckOk","type":"choice","item-type":"radio","_auto_id_":"e039c0d0-a7bd-4549-9ba4-f2188b334f49","label":"Lights checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"html_vehiclecheckfailed","type":"content","item-type":"html","_auto_id_":"636ad97e-5d7d-4bfa-87d7-7700e78f49a2","content":"<div onclick=cti.fnPhoneCall('manager') class=\"centered-text\"><p class=\"fa supervisor\"></p></div>\n<h4 class=\"check-fail-header\">One or more of the above checks has failed. Please call your Supervisor by tapping on the icon above before continuing...</h4>","expressions":{"show":"($store.pages.VehicleChecks.oilCheckOk == \"0\" || $store.pages.VehicleChecks.waterCheckOk == \"0\" || $store.pages.VehicleChecks.tyresCheckOk == \"0\" || $store.pages.VehicleChecks.lightsCheckOk == \"0\") && $store.pages.VehicleChecks.rdoDrivingCheck == \"1\""}},{"name":"vehicleOdometer","type":"user-input","item-type":"number","_auto_id_":"d364efa7-5abe-4ca8-a5f2-6ed87b55d606","label":"Vehicle Mileage","required":true,"decimals":2,"expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"message":"Please enter the vehicle's mileage","actions":[],"placeholder":"E.g. 10000","classes":"vehiclecheck-reg","validators":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"1e865e38-728d-413f-a528-284795861f09","extends":{"type":"area","item-type":"row"},"content":[{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"ed9caf5b-77c9-42ef-a0f2-4b32736c0c8c","content":"Next","theme":"default","expressions":{"disabled":"$form.invalid || $store.pages.VehicleChecks.oilCheckOk == \"0\" || $store.pages.VehicleChecks.waterCheckOk == \"0\" || $store.pages.VehicleChecks.tyresCheckOk == \"0\" || $store.pages.VehicleChecks.lightsCheckOk == \"0\"","show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\" || $store.pages.VehicleChecks.rdoDrivingCheck == undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Process Vehicle Check Function */\nvar enteredOdo = cti.store.pages.VehicleChecks.vehicleOdometer;\nvar lastOdo = cti.store.api.AccuServ.initialise.nlastRecordedMileage || 0;\nvar enteredDifference = enteredOdo - lastOdo;\n\nif(enteredOdo < lastOdo) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning!\",\n      \"text\": \"Input mileage can not be less than the last recorded reading.\"\n    }\n  );\n} else if(enteredOdo === 0) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning!\",\n      \"text\": \"Please ensure you enter your vehicle mileage. It must be more than 0.\"\n    }\n  );\n} else if(cti.store.staticData.vehicleMileageMaxEntry < enteredDifference) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning!\",\n      \"text\": \"Please make sure the difference between the current entry and last entry is less than \" + cti.store.staticData.vehicleMileageMaxEntry + \" miles.\"\n    }\n  );\n} else {\n  delete cti.store.saveActionPayload;\n\n  cti.utils.callAction('go-to-page', { name: \"VehicleChecksPhotos\" });\n}"},"_auto_id_":"bb8103fb-8b65-4000-9bcd-fb0bc14bbb59","actions":[]}]},{"name":"complete_btn","type":"button","item-type":"button","_auto_id_":"7ec0d888-1292-47e9-af24-d926875032f3","content":"Complete","theme":"default","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"0\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Skip Vehicle Check Function */\ncti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"StartOfDay\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });"},"_auto_id_":"762cdcc3-4838-448a-a303-2c51dcf2d626"}],"classes":"confirm-bar-btn"}],"expressions":{}}],"_auto_id_":"5b388d33-26ab-4e4f-9d79-755c51651b2e","expressions":{}}]},{"start":true,"name":"Login","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"fa1beb0d-6bb5-4428-9f7c-11e813826377","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(window) {\n  if(!window.appManager) {\n    window.appManager = new AppManager();\n    setTimeout(window.appManager.pollingMonitor, 100);\n  }\n  if(!window.accuServFunctions) {\n    window.accuServFunctions = new AccuServFunctions();\n  }\n}\n\nif(cti.store.pages.AppSettings === undefined) {\n  cti.store.pages.AppSettings = {};\n}\n\nif(cti.store.webService === undefined) {  \n  cti.store.webService = {};\n  cti.store.webService.apiUrls = [];\n  \n  cti.store.webService.apiUrls.push({\"value\": cti.store.schema.metadata.accuservurl});\n}"},"_auto_id_":"30621a7f-a45a-40b1-ac37-225527143da9"}]}],"content":[{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"imgLogo","type":"media","item-type":"image-viewer","_auto_id_":"d7100bd4-f2db-466b-90b3-5368d23f2249","scaleImage":false,"maxWidth":200,"maxHeight":200,"expressions":{},"fileName":"accuserv-logo.png","classes":"header-image","actions":[]},{"name":"htmlLoginPrompt","type":"content","item-type":"html","_auto_id_":"b5421214-c104-4d5d-94fe-e4cae341e55d","content":"<p class=\"p-text\">Please enter your Username and Password and tap Login to proceed.</p>","expressions":{}},{"name":"Username","type":"user-input","item-type":"text","_auto_id_":"aa436589-5726-4865-958c-9264c4669aae","label":"","required":true,"multiline":false,"debounce":250,"expressions":{},"description":"","placeholder":"Username","validators":[],"actions":[],"classes":"credentials-input","message":"Please enter your Username"},{"name":"Password","type":"user-input","item-type":"password","_auto_id_":"3f12d90d-6e3d-4284-bc4c-62a6a6dc73a5","label":"","required":true,"message":"Please enter your Password","expressions":{},"placeholder":"Password","classes":"credentials-input","actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"05905617-fb09-483a-9211-204018e952c2","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnLogin","type":"button","item-type":"button","_auto_id_":"9fd0bdd5-fccb-44d6-ae70-5cc034d4a375","content":"Login","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"login-button","actions":[{"event":"click","type":"call-actionflow","data":{"name":"Login"},"_auto_id_":"1aba177f-1b96-4934-926a-066a76d469a9"}]}],"expressions":{}},{"name":"htmlApplicationDetails","type":"content","item-type":"html","_auto_id_":"e4d476d0-53ef-4ea6-91c9-eaa56bf8cf4b","content":"<div class=\"app-title\">AccuMobile<span class=\"version\">Version: {{'$store.schema.version' | store}}</span></div>","expressions":{}},{"name":"btnSettings","type":"button","item-type":"button","_auto_id_":"c596ca9e-d814-43ec-9091-b30076e969b4","content":"","theme":"default","left-icon":"fa-gear","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":{"name":"AppSettings","isConditional":false},"_auto_id_":"e1c7c06b-0a40-4d07-9036-f980669753a4"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","_auto_id_":"72c4d3a3-db48-4f33-9e16-e1aa752a360c","attributes":{"message":"Attempting to log you in..."},"expressions":{},"actions":[]}],"_auto_id_":"18b05f1c-c5c6-44c5-832b-bd9dbb67dbf1","expressions":{}}],"settings":{"auth":false}}],"actionflows":[{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var code = cti.store.payloads.eventStatusPayload.sStatus;\n\nif(code != \"70\" && code != \"71\" && code != \"72\" && code != \"74\") {\n\tcti.store.jobs.selectedJob.aInJobEventStatus.push(cti.store.payloads.eventStatusPayload);\n}\n\nif(cti.store.jobs.eventStatusLimit > 0) {\n  // Fetch the sendEventStatusHeaders to supply to the joblist request\n  cti.store.variables.sendEventStatusHeaders = window.appManager.newHeaderData();\n  $success();\n} else {\n  cti.fnCloseSpinner();\n}"},"_auto_id_":"4d18f099-cf3d-44bd-a2ae-3817789dae9a","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"jobstatus","params":{"applicationkey":"{{$store.variables.sendEventStatusHeaders.applicationkey}}","authtoken":"{{$store.variables.sendEventStatusHeaders.authtoken}}","messageid":"{{$store.variables.sendEventStatusHeaders.messageid}}","messagedate":"{{$store.variables.sendEventStatusHeaders.messagedate}}","data":"{{$store.payloads.eventStatusPayload}}"}},"_auto_id_":"d08bdeff-bedc-4040-a5b4-f9160f83ca64","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobstatus endpoint success callback */\n\nvar resp = cti.store.offlineApi.AccuServOffline.jobstatus;\nvar responseJob = 0;\nvar code;\n\nif(resp) {\n  if(resp.jobID !== undefined) {\n    responseJob = resp.jobID.iJobEventNoKey\n  }\n\n  if(cti.store.payloads.eventStatusPayload != undefined) {\n    code = cti.store.payloads.eventStatusPayload.sStatus;\n  } else {\n    code = \"Returned out of scope.\";\n  }\n\n  var job = cti.store.jobs.selectedJob;\n\n  if(job != undefined) {\n    if(responseJob === job.aAccuServJobID.iJobEventNoKey) {\n      cti.store.jobs.eventStatus = {\n          sStatus: resp.sStatus,\n          sCode: code\n      };\n\n      if(resp.bSuccess) {\n        cti.store.jobs.selectedJob.sStatus = resp.sStatus;\n\n        if(code == \"70\" || code == \"71\" || code == \"72\" || code == \"74\") {\n          cti.store.variables.reSyncJobList = true;\n          cti.store.jobs.lastJobEvent.aEventStatus = cti.store.jobs.eventStatus;\n        }\n      }\n    } else {\n      window.appManager.logEvent('Job Status Response returned outside scope of current job.' , 'info');\n    }\n  } else {\n    window.appManager.logEvent('Job Status Response returned outside scope of any job.' , 'info');\n  }\n} else {\n  window.appManager.logEvent('Job Status Response returned no response.' , 'error');\n}\n\ndelete cti.store.variables.sendEventStatusHeaders;\ndelete cti.store.payloads.eventStatusPayload;\ndelete cti.store.offlineApi.AccuServOffline.jobstatus;\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"82529f1c-715b-45c9-817e-16d3b03e8752"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.eventStatusLimit = cti.store.jobs.eventStatusLimit - 1;\ncti.utils.callAction('call-actionflow', { \"name\": \"SendJobStatus\" });"},"_auto_id_":"c4021da8-f6d4-4d66-9d54-6e8e3c048674"}]}]}],"name":"SendEventStatus"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Validating Job...');\n\n// Set validation retry counter\nif(cti.store.variables.validateRetryCount === undefined) cti.store.variables.validateRetryCount = 3;\n\n// Fetch the validateJobHeaders to supply to the requestJob request\ncti.store.variables.validateJobHeaders = window.appManager.newHeaderData();\n\ncti.store.payloads.validateJobPayload = {\n  \"job\": cti.store.jobs.selectedJob.aAccuServJobID,\n  \"operative\": cti.store.jobs.selectedJob.aOperativeDetail.sOperativeID\n}\n\n// If retry counter is 0 then start job anyway\nif(cti.store.variables.validateRetryCount === 0) {\n  delete cti.store.variables.validateRetryCount;\n  \n  cti.fnCloseSpinner();\n  cti.fnStartTravel();\n} else {\n  $success();\n}"},"_auto_id_":"965081ea-c5fc-4bbe-ac13-1f1f03457a85","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"validatejobstatus","params":{"applicationkey":"{{$store.variables.validateJobHeaders.applicationkey}}","authtoken":"{{$store.variables.validateJobHeaders.authtoken}}","messagedate":"{{$store.variables.validateJobHeaders.messagedate}}","messageid":"{{$store.variables.validateJobHeaders.messageid}}","data":"{{$store.payloads.validateJobPayload}}"}},"_auto_id_":"6a1a2e36-2cca-425a-8a11-291b3633acd7","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.validatejobstatus;\n\nif(resp.bSuccess) {\n  cti.fnStartTravel();\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Invalid Job: \" + resp.sStatus,\n      \"text\" : \"This job is no longer validated against your operative ID. Please return to the job list screen and re-sync your job list.\"\n    }\n  );\n}\n\ndelete cti.store.variables.validateJobHeaders;\ndelete cti.store.payloads.validateJobPayload;\ndelete cti.store.api.AccuServ.validatejobstatus;\ndelete cti.store.variables.validateRetryCount;\n\ncti.fnCloseSpinner();"},"_auto_id_":"a864d160-d93d-4339-9f8f-1e104da5b672"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Validating Job Failed\",\n    \"text\": \"The request to Validate this Job failed to reach the server. Please check that you have internet connectivity or contact the AccuServ support. You have \" + cti.store.variables.validateRetryCount + \" retry attempts remaining.\"\n  }\n);\n\n// Delete purchaseOrderHeaders payload object\ndelete cti.store.variables.validateJobHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();\n\n// Take off a retry attempt\ncti.store.variables.validateRetryCount--;"},"_auto_id_":"4383408d-0492-4e15-9ca0-df2c9038b901"}]}]}],"name":"ValidateJob"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Do some init stuff\ncti.store.currentProfile.refreshingToken  = true;\nwindow.appManager.logEvent('Refreshing auth token', 'debug');\n\ncti.store.variables.apiHeaders.refreshtoken = window.appManager.newHeaderData();\n\n$success();\n"},"_auto_id_":"dc1840d6-ea61-4ccc-9737-55a397f8110f","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"refreshtoken","params":{"messageid":"{{$store.variables.apiHeaders.refreshtoken.messageid}}","messagedate":"{{$store.variables.apiHeaders.refreshtoken.messagedate}}","applicationkey":"{{$store.variables.apiHeaders.refreshtoken.applicationkey}}","authtoken":"{{$store.variables.apiHeaders.refreshtoken.authtoken}}"}},"_auto_id_":"019b0464-1a7c-49f9-b1b2-fa9dff15f754","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/*\n\tExample legit response:\n    {\n      \"errorCode\": 0,\n      \"errorDesc\": \"\",\n      \"token\": \"A6BE4685-BAD2-4E80-BBB8-5AB37FF459C3\",\n      \"expiresIn\": 3600,\n      \"messageid\": \"34\"\n    }\n\n*/\nvar response = cti.store.offlineApi.AccuServOffline.refreshtoken;\nif (response.errorCode == 0) {\n  // Update the token - the function will take care of everything\n  window.accuServFunctions.fnUpdateAuthToken(response.token, response.expiresIn);\n}\nelse {\n  window.appManager.logEvent('Failure to refresh auth token: ' + response.errorDesc, 'warning');\n\tcti.store.currentProfile.refreshingToken  = false;\n}"},"_auto_id_":"5d40baa7-817b-4aa0-97ab-a28069942a62","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Typically a transport level failure or timeout\nwindow.appManager.logEvent('Failure to refresh auth token (API call failed)', 'warning');\ncti.store.currentProfile.refreshingToken  = false;\n"},"_auto_id_":"f0ac687d-58f5-42d5-a15a-261440ea4ae7"}]}]}],"name":"RefreshToken"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Raising Job Incident...');\n\n// Fetch the raiseIncidentHeaders to supply to the requestJob request\ncti.store.variables.raiseIncidentHeaders = window.appManager.newHeaderData();\n$success();"},"_auto_id_":"1fcfeb0c-5251-404f-92d4-5f12e43b930c","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"raiseincident","params":{"applicationkey":"{{$store.variables.raiseIncidentHeaders.applicationkey}}","authtoken":"{{$store.variables.raiseIncidentHeaders.authtoken}}","messageid":"{{$store.variables.raiseIncidentHeaders.messageid}}","messagedate":"{{$store.variables.raiseIncidentHeaders.messagedate}}","data":"{{$store.payloads.raiseIncidentPayload}}"}},"_auto_id_":"2470fc12-23a1-4cec-abec-683abf70e2e0","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.raiseincident;\n\nif(resp.bSuccess) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_specialordersent\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : \"Incident Raised!\",\n      \"text\" : resp.sStatus + resp.sAccuServReference\n    }\n  );\n}\n\ndelete cti.store.payloads.raiseIncidentPayload;\ndelete cti.store.variables.raiseIncidentHeaders;\n\ncti.utils.destroyPageData('RaiseIncident');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n\ncti.fnCloseSpinner(1500);"},"_auto_id_":"9fef23e4-4a2f-40d3-8beb-2203db50cf3e"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Requesting OOH Job Failed\",\n    \"text\": \"The request to send this OOH Job failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete oohHeaders payload object\ndelete cti.store.variables.oohHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"6f7d1730-1dc8-4be9-9617-af87e1bf7ab9","actions":[]}]}]}],"name":"RaiseIncident"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Requesting OOH Job...');\n\n// Fetch the oohHeaders to supply to the requestJob request\ncti.store.variables.oohHeaders = window.appManager.newHeaderData();\n$success();"},"_auto_id_":"250efe3f-abe7-4c8d-9c1f-a59285e2c8f8","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"requestoutofhoursjob","params":{"applicationkey":"{{$store.variables.oohHeaders.applicationkey}}","authtoken":"{{$store.variables.oohHeaders.authtoken}}","messageid":"{{$store.variables.oohHeaders.messageid}}","messagedate":"{{$store.variables.oohHeaders.messagedate}}","data":"{{$store.payloads.requestJobPayload}}"}},"_auto_id_":"7d9a3d08-5474-4b01-b930-a0e0d1982c1f","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.requestoutofhoursjob;\n\nif(resp.bSuccess) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_specialordersent\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : \"Out of Hours Job Raised!\",\n      \"text\" : resp.sStatus + resp.sAccuServReference\n    }\n  );\n}\n\ndelete cti.store.payloads.requestJobPayload;\ndelete cti.store.variables.oohHeaders;\n\ncti.utils.destroyPageData('RequestJob');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n\ncti.fnCloseSpinner(1500);"},"_auto_id_":"0fa9deda-0232-485f-b1a0-9ae0903179f5"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Requesting OOH Job Failed\",\n    \"text\": \"The request to send this OOH Job failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete oohHeaders payload object\ndelete cti.store.variables.oohHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"988ab677-bd82-4e7c-a336-eb6070f0800a","actions":[]}]}]}],"name":"RequestJob"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Encode any jpegs to base64\nfunction toDataURL(thisPhoto, callback) {\n  var xhr = new XMLHttpRequest();\n  xhr.onload = function() {\n    var reader = new FileReader();\n    reader.onloadend = function() {\n      callback(reader.result, thisPhoto);\n    };\n    reader.readAsDataURL(xhr.response);\n  };\n  xhr.open(\"GET\", thisPhoto.src);\n  xhr.responseType = \"blob\";\n  xhr.send();\n}\n\n// Check that the photos element is undefined and define if needed\nif (cti.store.jobs.failedPhotosToSend.photos === undefined) {\n  cti.store.jobs.failedPhotosToSend.photos = [];\n}\n\n// Check that the signatures element is undefined and define if needed\nif (cti.store.jobs.failedPhotosToSend.signatures === undefined) {\n  cti.store.jobs.failedPhotosToSend.signatures = [];\n}\n\n// Check that we have any photos or signatures\nif (\n  cti.store.jobs.failedPhotosToSend.photos.length > 0 ||\n  cti.store.jobs.failedPhotosToSend.signatures.length > 0\n) {\n  var photoLength = cti.store.jobs.failedPhotosToSend.photos.length;\n\n  // If we have any photos then kick off the endcoding proccess ...\n  if (photoLength > 0) {\n    for (var i in cti.store.jobs.failedPhotosToSend.photos) {\n      var thisPhoto = cti.store.jobs.failedPhotosToSend.photos[i];\n\n      toDataURL(thisPhoto, function(dataUrl, thisPhoto) {\n        thisPhoto.content = dataUrl;\n        photoLength--;\n\n        if (photoLength === 0) {\n          $success();\n        }\n      });\n    }\n  } else {\n    // ... otherwise bypass this and submit the signautres only\n    $success();\n  }\n} else {\n  // No photos or signatures so just process the jobcomplete event\n  cti.fnClearPhotos(cti.store.jobs.failedPhotosToSend.photos, true);\n  cti.utils.callAction(\"call-actionflow\", { name: \"JobComplete\" });\n}"},"_auto_id_":"ca5c84f5-91a9-4543-8fda-194ef1eb3ea6","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"// fnUploadPhotos function callback to handle the response of the image/signature upload\nfunction uploadedCallbackEvent(ok) {\n  if (ok) {\n    for (var i in cti.store.jobs.failedPhotos) {\n      var thisPhoto = cti.store.jobs.failedPhotos[i];\n      if (\n        cti.store.jobs.failedPhotosToSend.job.aAccuServJobID.iJobEventNoKey ===\n        thisPhoto.job.aAccuServJobID.iJobEventNoKey\n      ) {\n        cti.store.jobs.failedPhotos.splice(i, 1);\n      }\n    }\n\n    cti.fnClearPhotos(cti.store.jobs.failedPhotosToSend.photos, false);\n    window.appManager.logEvent(\n      \"Photo/Signature re-submitted successfully from Job ID: \" +\n        cti.store.jobs.failedPhotosToSend.job.aAccuServJobID.sJobNo,\n      \"info\"\n    );\n\n    delete cti.store.jobs.failedPhotosToSend;\n    delete cti.store.variables.signatures;\n    delete cti.store.jobs.signaturesAssociatedJob;\n  } else {\n    for (var i in cti.store.jobs.failedPhotosToSend.photos) {\n      delete cti.store.jobs.failedPhotosToSend.photos[i].content;\n    }\n\n    window.appManager.logEvent(\n      \"Photo/Signature failed to send for Job ID: \" +\n        cti.store.jobs.failedPhotosToSend.job.aAccuServJobID.sJobNo +\n        \". Re-submitting...\",\n      \"error\"\n    );\n  }\n}\n\ncti.fnUploadPhotos(\n  cti.store.jobs.failedPhotosToSend,\n  cti.store.pages.AppSettings.accuservAPIAddress,\n  uploadedCallbackEvent,\n  false\n);"},"_auto_id_":"71de501e-4099-49e7-a6fd-a092af77da0d"}]}],"name":"SubmitPhotosOffline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Get jobEventStatus\nvar jobEventStatus = cti.store.variables.jobEventStatus;\n\nif (jobEventStatus === \"jobcomplete\") {\n  cti.fnOpenSpinner(\"Preparing Job Complete to send to AccuServ...\");\n} else if (jobEventStatus === \"abandonjob\") {\n  cti.fnOpenSpinner(\"Preparing to Abandon Job to send to AccuServ...\");\n} else if (jobEventStatus === \"noaccess\") {\n  cti.fnOpenSpinner(\"Preparing to send No Access for Job to AccuServ...\");\n}\n\n// Encode any jpegs to base64\nfunction toDataURL(thisPhoto, callback) {\n  var xhr = new XMLHttpRequest();\n  xhr.onload = function() {\n    var reader = new FileReader();\n    reader.onloadend = function() {\n      callback(reader.result, thisPhoto);\n    };\n    reader.readAsDataURL(xhr.response);\n  };\n  xhr.open(\"GET\", thisPhoto.src);\n  xhr.responseType = \"blob\";\n  xhr.send();\n}\n\nvar opSig = false;\nvar riskSig = false;\nvar cusSig = false;\n\n// Set booleans to indicate any signatures present\nif (\n  cti.store.pages.Completion !== undefined &&\n  cti.store.pages.Completion.operativeSignature !== undefined\n) {\n  opSig = true;\n}\nif (\n  cti.store.pages.RiskAssessment !== undefined &&\n  cti.store.pages.RiskAssessment.confirmRASignature !== undefined\n) {\n  riskSig = true;\n}\nif (\n  cti.store.pages.CustomerSignature !== undefined &&\n  cti.store.pages.CustomerSignature.customerSignature !== undefined\n) {\n  cusSig = true;\n}\n\nif (cti.store.jobs.selectedJob.photos === undefined) {\n  cti.store.jobs.selectedJob.photos = [];\n}\n\n// Check if we have any signatures or photos\nif (\n  cti.store.jobs.selectedJob.photos.length > 0 ||\n  opSig ||\n  riskSig ||\n  cusSig\n) {\n  var photoLength = cti.store.jobs.selectedJob.photos.length;\n\n  // If we have any photos then kick off the endcoding proccess ...\n  if (photoLength > 0) {\n    for (var i in cti.store.jobs.selectedJob.photos) {\n      var thisPhoto = cti.store.jobs.selectedJob.photos[i];\n\n      toDataURL(thisPhoto, function(dataUrl, thisPhoto) {\n        thisPhoto.content = dataUrl;\n        photoLength--;\n\n        if (photoLength === 0) {\n          $success();\n        }\n      });\n    }\n  } else {\n    // ... otherwise bypass this and submit the signautres only\n    $success();\n  }\n} else {\n  // No photos or signatures so just process the jobcomplete event\n  cti.fnClearPhotos(cti.store.jobs.selectedJob.photos, true);\n  cti.utils.callAction(\"call-actionflow\", { name: \"JobComplete\" });\n}\n"},"_auto_id_":"44e13e91-cd81-4c1e-9711-d4a416c0c510","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"// fnUploadPhotos function callback to handle the response of the image/signature upload\nfunction uploadedCallbackEvent(ok) {\n  if (ok) {\n    delete cti.store.variables.signatures;\n    delete cti.store.jobs.signaturesAssociatedJob;\n\n    cti.fnClearPhotos(cti.store.jobs.selectedJob.photos, true);\n    cti.utils.callAction(\"call-actionflow\", { name: \"JobComplete\" });\n  } else {\n    for (var i in cti.store.jobs.selectedJob.photos) {\n      delete cti.store.jobs.selectedJob.photos[i].content;\n    }\n\n    cti.store.payloads.failedPhotos = {\n      photos: cti.store.jobs.selectedJob.photos,\n      job: cti.store.jobs.selectedJob,\n      signatures: cti.store.variables.signatures\n    };\n\n    cti.fnStashPhotos();\n    delete cti.store.variables.signatures;\n  }\n}\n\ncti.fnOpenSpinner(\"Uploading photos and signatures to AccuServ...\");\ncti.fnUploadPhotos(\n  cti.store.jobs.selectedJob.photos,\n  cti.store.pages.AppSettings.accuservAPIAddress,\n  uploadedCallbackEvent,\n  true\n);"},"_auto_id_":"6cc38225-d299-4f2f-bb01-f555e67d2782","actions":[]}]}],"name":"SubmitPhotos"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Fetch the jobCompleteOfflineHeaders to supply to the jobcompletion request\ncti.store.variables.jobCompleteOfflineHeaders = window.appManager.newHeaderData();\ncti.store.payloads.jobCompleteOffline = undefined;\n\nvar jobDetail = cti.store.jobs.failedJobToSend;\ncti.store.payloads.jobCompleteOffline = {};\n\nif(jobDetail.aItemGroups == undefined) jobDetail.aItemGroups = [];\nif(jobDetail.aVanStock == undefined) jobDetail.aVanStock = [];\n\nfor(var i in jobDetail.aItemGroups) { \n  delete jobDetail.aItemGroups[i].$index;\n}\n\nfor(var i in jobDetail.aVanStock) { \n  delete jobDetail.aVanStock[i].$index;\n}\n\nvar d = new Date();\nvar finishHours = (d.getHours()<10?'0':'') + d.getHours();\nvar finishMins = (d.getMinutes()<10?'0':'') + d.getMinutes();\n\nvar obj = {\n  \"bSuccess\" : jobDetail.bSuccess,\n  \"sStatus\" : jobDetail.sStatus,\n  \"sResultSummary\" : jobDetail.sResultSummary,\n  \"sResultSummarySubReason\" : jobDetail.sResultSummarySubReason,\n  \"sResultDetail\" : jobDetail.sResultDetail,\n  // ML Travel Date/Time Code\n  \"dStartTravelDate\" : jobDetail.dtJobTravelStartedDateTime,\n  \"iStartTravelHrs\" : parseInt(jobDetail.iJobStartedTravelHrs),\n  \"iStartTravelMins\" : parseInt(jobDetail.iJobStartedTravelMins),\n  //\n  \"dtArrivedOnDateTime\" : jobDetail.dtJobTravelEndedDateTime,\n  \"dArrivedOnDate\" : jobDetail.dtJobTravelEndedDateTime,\n  \"iArrivedOnHrs\" : parseInt(jobDetail.iJobEndedTravelHrs),\n  \"iArrivedOnMins\" : parseInt(jobDetail.iJobEndedTravelMins),\n  \"dtFinishedOnDateTime\" : moment().format(),\n  \"dFinishedOnDate\" : moment().format(),\n  \"iFinishedOnHrs\" : parseInt(finishHours),\n  \"iFinishedOnMins\" : parseInt(finishMins),\n  \"dtJobTargetDateTime\" : jobDetail.dtJobTargetDateTime,\n  \"dJobTargetDate\" : jobDetail.dtJobTargetDateTime,\n  \"iJobTargetHrs\" : parseInt(jobDetail.iJobTargetHrs),\n  \"iJobTargetMins\" : parseInt(jobDetail.iJobTargetMins),\n  \"aAccuServJobID\" : jobDetail.aAccuServJobID,\n  \"aOperativeDetail\" : jobDetail.aOperativeDetail,\n  \"aItemGroups\" : jobDetail.aItemGroups,\n  \"aStockItemsUsed\" : jobDetail.aVanStock,\n  \"aJobAdditionalDetail\" : jobDetail.aJobAdditionalDetail,\n  \"aInJobDataCollectionResponse\" : jobDetail.aInJobDataCollectionResponse,\n  \"aInJobEventStatus\" : jobDetail.aInJobEventStatus\n};\n\ncti.store.payloads.jobCompleteOffline = obj;\n$success();"},"_auto_id_":"402e803a-aa3d-4c42-8dda-e55372e34d98","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobcompletion","params":{"messageid":"{{$store.variables.jobCompleteOfflineHeaders.messageid}}","messagedate":"{{$store.variables.jobCompleteOfflineHeaders.messagedate}}","authtoken":"{{$store.variables.jobCompleteOfflineHeaders.authtoken}}","applicationkey":"{{$store.variables.jobCompleteOfflineHeaders.applicationkey}}","data":"{{$store.payloads.jobCompleteOffline}}"}},"_auto_id_":"761f8c6e-46e2-41a6-b2b9-563d51a3c59e","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobcompletionoffline Endpoint - Returns:\n    {\n      \"bSuccess\": false, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message \n      \"messageid\": \"\" -- Unique message ID supplied from API\n    }\n*/\n\nvar resp = cti.store.api.AccuServ.jobcompletion;\n\nif(resp.bSuccess) {\n  var job = cti.store.payloads.jobCompleteOffline;\n  var jobId = job.aAccuServJobID.iJobEventNoKey;\n  var jobList = cti.store.jobs.jobList;\n  var jobDetails = cti.store.jobs.jobDetails;\n  var failedJobs = cti.store.jobs.failedJobs;\n  \n  for(var i in jobList) {\n    var thisJob = jobList[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobList.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in jobDetails) {\n    var thisJob = jobDetails[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobDetails.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in failedJobs) {\n    var thisJob = failedJobs[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      failedJobs.splice(i, 1);\n      break;\n    }\n  }\n  \n  window.appManager.logEvent('Offline job successfully re-submitted for Job ID: ' + job.aAccuServJobID.sJobNo, 'info');\n}\n\ndelete cti.store.payloads.jobCompleteOffline;\ndelete cti.store.variables.jobCompleteOfflineHeaders;\ndelete cti.store.jobs.failedJobToSend;\ndelete cti.store.api.AccuServ.jobcompletion;\n\ncti.utils.updatePage();"},"_auto_id_":"cd137991-3223-4631-8e1d-bce08fe2aa30"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"delete cti.store.payloads.jobCompleteOffline;\ndelete cti.store.variables.jobCompleteOfflineHeaders;\ndelete cti.store.jobs.failedJobToSend;\n\ncti.utils.updatePage();"},"_auto_id_":"6324411c-cccb-4a37-9538-5eaae5735174"}]}]}],"name":"JobCompleteOffline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Sending job details to AccuServ...');\n\n// Fetch the jobCompleteHeaders to supply to the jobDataCollection request\ncti.store.variables.jobCompleteHeaders = window.appManager.newHeaderData();\n\ncti.store.payloads.jobEventObject = undefined;\nvar jobDetail = cti.store.jobs.selectedJob;\nvar code;\n\nif(jobDetail.sResultSummary == \"ABANDON JOB\") {\n  code = \"71\";\n} else if(jobDetail.sResultSummary == \"NO ACCESS\") {\n  code = \"72\";\n} else if(jobDetail.sResultSummary == \"FOLLOW ON REQUIRED\") {\n  code = \"74\";\n} else {\n  code = \"70\";\n}\n\n// Send Event Status\ncti.fnSendEventStatus(code);\n\nvar completeEventStatus = cti.store.payloads.eventStatusPayload;\njobDetail.aInJobEventStatus.push(completeEventStatus);\n\nif(jobDetail.aItemGroups == undefined) jobDetail.aItemGroups = [];\nif(jobDetail.aVanStock == undefined) jobDetail.aVanStock = [];\n\nfor(var i in jobDetail.aItemGroups) { \n  delete jobDetail.aItemGroups[i].$index;\n}\n\nfor(var i in jobDetail.aVanStock) { \n  delete jobDetail.aVanStock[i].$index;\n}\n\nvar d = new Date();\nvar finishHours = (d.getHours()<10?'0':'') + d.getHours();\nvar finishMins = (d.getMinutes()<10?'0':'') + d.getMinutes();\n\nvar obj = {\n  \"bSuccess\" : jobDetail.bSuccess,\n  \"sStatus\" : jobDetail.sStatus,\n  \"sResultSummary\" : jobDetail.sResultSummary,\n  \"sResultSummarySubReason\" : jobDetail.sResultSummarySubReason,\n  \"sResultDetail\" : jobDetail.sResultDetail,\n  // ML Travel Date/Time Code\n  \"dStartTravelDate\" : jobDetail.dtJobTravelStartedDateTime,\n  \"iStartTravelHrs\" : parseInt(jobDetail.iJobStartedTravelHrs),\n  \"iStartTravelMins\" : parseInt(jobDetail.iJobStartedTravelMins),\n  //\n  \"dtArrivedOnDateTime\" : jobDetail.dtJobTravelEndedDateTime,\n  \"dArrivedOnDate\" : jobDetail.dtJobTravelEndedDateTime,\n  \"iArrivedOnHrs\" : parseInt(jobDetail.iJobEndedTravelHrs),\n  \"iArrivedOnMins\" : parseInt(jobDetail.iJobEndedTravelMins),\n  \"dtFinishedOnDateTime\" : moment().format(),\n  \"dFinishedOnDate\" : moment().format(),\n  \"iFinishedOnHrs\" : parseInt(finishHours),\n  \"iFinishedOnMins\" : parseInt(finishMins),\n  \"dtJobTargetDateTime\" : jobDetail.dtJobTargetDateTime,\n  \"dJobTargetDate\" : jobDetail.dtJobTargetDateTime,\n  \"iJobTargetHrs\" : parseInt(jobDetail.iJobTargetHrs),\n  \"iJobTargetMins\" : parseInt(jobDetail.iJobTargetMins),\n  \"aAccuServJobID\" : jobDetail.aAccuServJobID,\n  \"aOperativeDetail\" : jobDetail.aOperativeDetail,\n  \"aItemGroups\" : jobDetail.aItemGroups,\n  \"aStockItemsUsed\" : jobDetail.aVanStock,\n  \"aJobAdditionalDetail\" : jobDetail.aJobAdditionalDetail,\n  \"aInJobDataCollectionResponse\" : jobDetail.aInJobDataCollectionResponse,\n  \"aInJobEventStatus\" : jobDetail.aInJobEventStatus\n};\n\ncti.store.payloads.jobEventObject = obj;\n$success();"},"_auto_id_":"c05dfa81-d563-4eae-9a70-1c76cac7fbca","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobcompletion","params":{"messageid":"{{$store.variables.jobCompleteHeaders.messageid}}","messagedate":"{{$store.variables.jobCompleteHeaders.messagedate}}","authtoken":"{{$store.variables.jobCompleteHeaders.authtoken}}","applicationkey":"{{$store.variables.jobCompleteHeaders.applicationkey}}","data":"{{$store.payloads.jobEventObject}}"}},"_auto_id_":"dde236d4-5823-4993-b09e-871bf3e20678","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobcompletion Endpoint - Returns:\n    {\n      \"bSuccess\": false, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message \n      \"messageid\": \"\" -- Unique message ID supplied from API\n    }\n*/\n\nvar resp = cti.store.api.AccuServ.jobcompletion;\nvar job = cti.store.payloads.jobEventObject;\n\nif(resp.bSuccess) { \n  var jobId = cti.store.payloads.jobEventObject.aAccuServJobID.iJobEventNoKey;\n  var jobList = cti.store.jobs.jobList;\n  var failedJobs = cti.store.jobs.failedJobs;\n  var jobDetails = cti.store.jobs.jobDetails;\n  var jobEventStatus = cti.store.variables.jobEventStatus;\n  var message;\n  var header;\n  \n  for(var i in jobList) {\n    var thisJob = jobList[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobList.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in jobDetails) {\n    var thisJob = jobDetails[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobDetails.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in failedJobs) {\n    var thisJob = failedJobs[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      failedJobs.splice(i, 1);\n      break;\n    }\n  }\n  \n  if(jobEventStatus === \"jobcomplete\") {\n    header = \"Success: Job Complete\";\n    message = \"You have successfully Completed the following job: Job No. \";\n  } else if(jobEventStatus === \"abandonjob\") {\n    header = \"Success: Abandoned Job\";\n    message = \"You have successfully Abandoned the following job: Job No. \";\n  } else if(jobEventStatus === \"noaccess\") {\n    header = \"Success: No Access\";\n    message = \"You have successfully sent a No Access on the following job: Job No. \";\n  }\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_jobcomplete\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : header,\n      \"text\" : message + cti.store.jobs.selectedJob.aAccuServJobID.sJobNo\n    }\n  );\n  \n  cti.store.jobs.lastJobEvent = {\n    \"aAccuServJobID\" : cti.store.jobs.selectedJob.aAccuServJobID,\n    \"sPropertyID\" : cti.store.jobs.selectedJob.aPropertyDetail.sPropertyID,\n    \"sOperativeID\" : cti.store.jobs.selectedJob.aOperativeDetail.sOperativeID\n  };\n  \n  cti.store.variables.reSyncJobList = true;\n} else {\n  var jobFailed = JSON.parse(JSON.stringify(cti.store.jobs.selectedJob));\n  if(cti.store.jobs.failedJobs == undefined) cti.store.jobs.failedJobs = [];\n  cti.store.jobs.failedJobs.push(jobFailed);\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Job Failed to Send to Server\",\n      \"text\": resp.sStatus || \"AccuServ was unable to complete this Job.\"\n    }\n  );\n}\n\n// Clear job related data\ndelete cti.store.payloads.jobEventObject;\ndelete cti.store.variables.jobCompleteHeaders;\ndelete cti.store.variables.jobEventStatus;\n\n// Delete API response\ndelete cti.store.api.AccuServ.jobcompletion;\n\n// Clear all inscope data\nwindow.accuServFunctions.fnDataDestroy();\n\n// Close spinner\ncti.fnCloseSpinner(1000);\n\n// Get latest job list\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"abe1b621-2cb8-4954-bba5-052da40cc79d","actions":[]},{"event":"fail","type":"call-function","data":{"name":"fnStashJob","params":{"job":"{{$store.jobs.selectedJob}}"}},"_auto_id_":"796f9e3a-b22b-4a4a-9271-c7c48da8fe81"}]}]}],"name":"JobComplete"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Requesting Purchase Order...');\n\n// Fetch the purchaseOrderHeaders to supply to the joblist request\ncti.store.variables.purchaseOrderHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"bb9daec2-f4f5-4a78-bdd3-d081384226fc","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"purchaseorder","params":{"data":"{{$store.payloads.purchaseOrderPayload}}","applicationkey":"{{$store.variables.purchaseOrderHeaders.applicationkey}}","authtoken":"{{$store.variables.purchaseOrderHeaders.authtoken}}","messageid":"{{$store.variables.purchaseOrderHeaders.messageid}}","messagedate":"{{$store.variables.purchaseOrderHeaders.messagedate}}"}},"_auto_id_":"76a9327e-339b-4487-bf50-61a3e91e4ab3","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.purchaseorder;\nvar purchaseOrder = cti.store.jobs.selectedJob.aPurchaseOrder;\n\nif(resp.bSuccess) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_specialordersent\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : \"Over The Counter Purchase Sent!\",\n      \"text\" : \"You have requested an Over the Counter Purchase from \" + cti.store.pages.OTCPurchases.orderSupplier.label + \" for Job Number \" + cti.store.jobs.selectedJob.aAccuServJobID.sJobNo\n    }\n  );\n  \n  delete cti.store.jobs.selectedJob.aOTCStock;\n  delete cti.store.jobs.selectedJob.aPurchaseOrder;\n  cti.utils.destroyPageData('OTCPurchases');\n  cti.store.variables.specialOrder = false;\n  cti.store.variables.poRaised = true;\n} else {\n  cti.store.jobs.failedPurchaseOrder = purchaseOrder;\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to place Purchase Order\",\n      \"text\": resp.sStatus || \"AccuServ was unable to place the requested Purchase Order\"\n    }\n  );\n}\n\ndelete cti.store.variables.purchaseOrderHeaders;\ndelete cti.store.payloads.purchaseOrderPayload;\ndelete cti.store.api.AccuServ.purchaseorder;\n\ncti.utils.updatePage();\ncti.fnCloseSpinner(1500);"},"_auto_id_":"b3b7a409-9313-4b86-9aec-6cedc487ecbf"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Sending Purchase Order Failed\",\n    \"text\": \"The request to send this Purchase Order failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete purchaseOrderHeaders payload object\ndelete cti.store.variables.purchaseOrderHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"1a669c9c-a853-4138-bc67-fbcee161a49c"}]}]}],"name":"PurchaseOrder"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading Order Catalogue...');\n\n// Fetch the otcHeaders to supply to the ordercatalogue request\ncti.store.variables.otcHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"cc207366-7ec8-4ccc-8202-1d98e5727fa6","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"ordercatalogue","params":{"messageid":"{{$store.variables.otcHeaders.messageid}}","messagedate":"{{$store.variables.otcHeaders.messagedate}}","authtoken":"{{$store.variables.otcHeaders.authtoken}}","applicationkey":"{{$store.variables.otcHeaders.applicationkey}}"}},"_auto_id_":"3b5e8ceb-7e9d-41e8-affe-47d986caa2cf","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* ordercatalogue Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aStockItemsFull\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar response = cti.store.api.AccuServ.ordercatalogue;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(response.bSuccess) {\n  // On success add the OTC data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"otcdata\", \n    response.aStockItemsFull, function(rev) {\n      window.appManager.logEvent('Saved OTC Stock data, revision: ' + rev);\n      var fullStock = response.aStockItemsFull;\n      var stock = [];\n      var filter = cti.store.variables.supplierOTCFilter;\n\n      for(var i in fullStock) {\n        var stockItem = fullStock[i].sAttrib1.trim();\n\n        if(filter === \"\" || filter === undefined) {\n          stock.push(fullStock[i]);\n        } else if(stockItem === filter) {\n          stock.push(fullStock[i]);\n        }\n      }\n\n      window.appManager.saveToDatabase(\"otcdata\", stock, function(rev) {\n        window.appManager.loadFromDatabase('otcdata', function (doc) {\n          var otcStock = cti.store.jobs.selectedJob.aOTCStock;\n          var selectedLocation = cti.store.variables.selectedLocation;\n          var exists = false;\n\n          for(var i in otcStock) {\n            if(otcStock[i].sLocation == selectedLocation.sLocation) {\n              exists = true;\n              break;\n            }\n          }\n\n          if(exists) {\n            cti.store.variables.menuOption = \"schedules\";\n          } else {\n            if(selectedLocation.sOTCStockQuantity != 0) {\n              cti.store.variables.menuOption = \"schedules\";\n            } else {\n              cti.store.variables.menuOption = \"search\";\n            }\n          }\n\n          cti.store.variables.otcStockSearchResults = [];\n          var count = 10;\n\n          for(var i in doc.data) {\n            if(count === 0) {\n              break;\n            } else {\n              count--;\n              cti.store.variables.otcStockSearchResults.push(doc.data[i]);\n            }\n          }\n            \n          cti.utils.callAction('go-to-page', { \"name\": \"OTCCodes\" });\n          $success();\n        }, function (reason, err) {\n          cti.fnCloseSpinner();\n          cti.utils.callAction('call-actionflow', { \"name\": \"OnlineOTCCodes\" });\n        });\n        \n        $success();\n      }, function(reason, e) {\n        window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n        $success();\n      });\n\n      $success();\n    }, function(reason, e) {\n      window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n      \n      // Close Spinner\n\t  cti.fnCloseSpinner();\n      \n      $success();\n    });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve OTC information\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide Order Catalogue lookup information.\"\n    }\n  );\n  window.appManager.logEvent('Failed to retrieve OTC data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete API response\ndelete cti.store.api.AccuServ.ordercatalogue;\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;"},"_auto_id_":"3b2a193c-4618-4491-831a-2d5a0c07d678"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve OTC information\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch Order Catalogue Stock information.\"\n  }\n);\nwindow.appManager.logEvent('Failed to retrieve OTC data (API connection).', 'warning');\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"bfca09ea-36ee-4e0d-ae7c-8c7dfcb565c4"}]}]}],"name":"OnlineOTCCodes"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading Van Stock Codes...');\n\n// Fetch the vanStockHeaders to supply to the vanstock request\ncti.store.variables.vanStockHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"bde119a3-7931-454d-bd28-4c3ca7227f75","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"vanstock","params":{"messageid":"{{$store.variables.vanStockHeaders.messageid}}","messagedate":"{{$store.variables.vanStockHeaders.messagedate}}","authtoken":"{{$store.variables.vanStockHeaders.authtoken}}","applicationkey":"{{$store.variables.vanStockHeaders.applicationkey}}"}},"_auto_id_":"ecd1cc09-77a3-4ad2-b728-b780d776bbdc","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* VanStock Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aOperativeVanStock\": [] -- Array of operative van stock\n    }\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.vanstock;\n\n// Check response for failure \n// Notify user with popup warning if the Van Stock failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(resp.bSuccess) {\n  // Re-package response into the offline store for future reference\n  cti.store.offlineApi.AccuServOffline.vanstock = JSON.parse(JSON.stringify(resp));\n  \n  // Timestamp the vanStockLastRetrievedDate\n  cti.store.staticData.vanStockLastRetrievedDate = moment().format();\n  \n  cti.store.variables.lastVanSelectPage = cti.store.state.currentPage;\n\n  var vanStock = cti.store.jobs.selectedJob.aVanStock;\n  var selectedLocation = cti.store.variables.selectedLocation;\n  var exists = false;\n\n  for(var i in vanStock) {\n    if(vanStock[i].sLocation == selectedLocation.sLocation) {\n      exists = true;\n      break;\n    }\n  }\n\n  if(exists) {\n    cti.store.variables.menuOption = \"schedules\";\n  } else {\n    if(selectedLocation.sVanStockQuantity != 0) {\n      cti.store.variables.menuOption = \"schedules\";\n    } else {\n      cti.store.variables.menuOption = \"search\";\n    }\n  }\n\n  delete cti.store.variables.vanStockSearchResults;\n  cti.utils.callAction('go-to-page', { \"name\": \"VanStockCodes\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve Van Stock\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide your Van Stock information.\"\n    }\n  );\n  window.appManager.logEvent('Failed to retrieve Van Stock. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete API response\ndelete cti.store.api.AccuServ.vanstock;\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"1f2358a2-c139-4614-a171-5005254d3453"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve Van Stock\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch your Van Stock information.\"\n  }\n);\nwindow.appManager.logEvent('Failed to retrieve Van Stock data (API connection).', 'warning');\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;"},"_auto_id_":"4be296cd-2517-40cc-8a1d-763a2d16be09"}]}]}],"name":"OnlineVanCodes"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading SOR Codes...');\n\n// Fetch the sorHeaders to supply to the SOR request\ncti.store.variables.sorHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"0f3bfb33-f511-4f62-999c-c270e695d754","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"sordata","params":{"messageid":"{{$store.variables.sorHeaders.messageid}}","messagedate":"{{$store.variables.sorHeaders.messagedate}}","authtoken":"{{$store.variables.sorHeaders.authtoken}}","applicationkey":"{{$store.variables.sorHeaders.applicationkey}}"}},"_auto_id_":"2429da7f-592d-4b81-9b7c-f49bef3f594e","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* SORCodes Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aSORCodesDetail\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.sordata;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(resp.bSuccess) {\n  // On success add the SOR data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"sordata\", \n    resp.aSORCodesDetail, function(rev) {\n      window.appManager.logEvent('Saved SOR data, revision: ' + rev);\n      cti.store.variables.lastSORSelectPage = cti.store.state.currentPage;\n      var sorCodes = cti.store.jobs.selectedJob.aItemGroups;\n      var selectedLocation = cti.store.variables.selectedLocation;\n      var exists = false;\n\n      for(var i in sorCodes) {\n        if(sorCodes[i].sLocation == selectedLocation.sLocation) {\n          exists = true;\n          break;\n        }\n      }\n\n      if(exists) {\n        cti.store.variables.menuOption = \"schedules\";\n      } else {\n        if(selectedLocation.sSORCodesQuantity != 0) {\n          cti.store.variables.menuOption = \"schedules\";\n        } else {\n          cti.store.variables.menuOption = \"search\";\n        }\n      }\n\n      cti.store.variables.sorCodeSearchResults = [];\n      var count = 10;\n\n      for(var i in doc.data) {\n        if(count === 0) {\n          break;\n        } else {\n          count--;\n          cti.store.variables.sorCodeSearchResults.push(doc.data[i]);\n        }\n      }\n\n      cti.utils.callAction('go-to-page', { \"name\": \"SORCodes\" });\n      \n      $success();\n    }, function(reason, e) {\n      window.appManager.logError('Failed to save SOR data - ' + reason, e);\n      \n      // Close Spinner\n\t  cti.fnCloseSpinner();\n      \n      $success();\n    });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve SOR information\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide Schedule or Rates lookup information.\"\n    }\n  );\n  window.appManager.logEvent('Failed to retrieve SOR data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete API response\ndelete cti.store.api.AccuServ.sordata;\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;"},"_auto_id_":"5784eb7d-050f-47c1-bd54-41fc2c6bd002"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve SOR information\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch Schedule of Rates lookup information.\"\n  }\n);\nwindow.appManager.logEvent('Failed to retrieve SOR data (API connection).', 'warning');\n\n// Delete API response\ndelete cti.store.api.AccuServ.sordata;\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"d21f2434-81df-43b8-86f9-4cc0938b011b"}]}]}],"name":"OnlineSORCodes"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading Stock Locations...');\n\n// Define locations array\nif(cti.store.jobs.jobLocations == undefined) cti.store.jobs.jobLocations = [];\n\n// Fetch the jobLocationsHeaders to supply to the locations request\ncti.store.variables.jobLocationsHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"0d86cd0c-e3d5-447b-b928-3eff85bd4550","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"joblocations","params":{"messageid":"{{$store.variables.jobLocationsHeaders.messageid}}","messagedate":"{{$store.variables.jobLocationsHeaders.messagedate}}","authtoken":"{{$store.variables.jobLocationsHeaders.authtoken}}","applicationkey":"{{$store.variables.jobLocationsHeaders.applicationkey}}"}},"_auto_id_":"14ac7b58-4e13-4479-907f-ac39accd5e23","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* joblocations Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"aJobLocationDetail\": [],\n      \"messageid\": \"\"\n    }\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.joblocations;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var jobLocationsObj = JSON.parse(JSON.stringify(resp.aJobLocationDetail));\n  \n  cti.store.jobs.jobLocations = jobLocationsObj;\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve Locations\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide location lookup information.\"\n    }\n  );\n\twindow.appManager.logEvent('Failed to retrieve Locations static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete jobLocationsHeaders payload object\ndelete cti.store.variables.jobLocationsHeaders;\n\n// Delete API response\ndelete cti.store.api.AccuServ.joblocations;\n\n// Close spinner\ncti.fnCloseSpinner();\n\n// Reorder Locations\ncti.fnOrderSORLocations();\ncti.fnOrderVanLocations();\ncti.fnOrderOTCLocations();"},"_auto_id_":"4225c7ef-bf2a-4107-b361-ea980149c7f5"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve Locations\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch location lookup information.\"\n  }\n);\n\n// Log app manager warning\nwindow.appManager.logEvent('Failed to retrieve Locations static data (API connection).', 'warning');\n\n// Delete headers\ndelete cti.store.variables.jobLocationsHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();\n\n// Reorder Locations\ncti.fnOrderSORLocations();"},"_auto_id_":"5a29f2ec-e518-45e0-a795-3d73b686a9e7"}]}]}],"name":"OnlineStockLocations"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobCollectionType = cti.store.variables.jobCollectionType;\nvar selectedJob = cti.store.jobs.selectedJob;\n\n// Fetch the jobDataCollectionHeaders to supply to the jobDataCollection request\ncti.store.variables.jobDataCollectionHeaders = window.appManager.newHeaderData();\n\n// Check the jobCollectionType to see what type of payload we need to package\nif(jobCollectionType === \"warnings\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"WarningsRead\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"WarningsRead\"\n      ],\n      \"asValues\": [\n        \"Y\"\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  $success();\n} else if(jobCollectionType === \"riskassessment\") {\n  var riskAssessment = cti.store.payloads.riskAssessmentPayload;\n  \n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"RiskAssessment\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"Q1\",\n        \"Q2\",\n        \"Q3\",\n        \"Q4\",\n        \"Q5\",\n        \"Q6\",\n        \"Q7\",\n        \"Q8\"\n      ],\n      \"asValues\": [\n        riskAssessment.questionOne,\n        riskAssessment.questionTwo,\n        riskAssessment.questionThree,\n        riskAssessment.questionFour,\n        riskAssessment.questionFive,\n        riskAssessment.questionSix,\n        riskAssessment.questionSeven,\n        riskAssessment.questionEight\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  $success();\n} else if(jobCollectionType === \"initialvisit\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"InitialVisitAssessment\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"EstimatedTime\",\n        \"OperativeComment\"\n      ],\n      \"asValues\": [\n        selectedJob.sExpected_Duration,\n        cti.store.pages.StartingWork.workDescription\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n  $success();\n} else if(jobCollectionType === \"tenantphoto\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"TenantPhotoConsent\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"TenantPhotoConsent\",\n        \"TenantPhotoComment\"\n      ],\n      \"asValues\": [\n        selectedJob.bWorkPhoto,\n        selectedJob.bWorkPhotoComment\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  $success();\n} else if(jobCollectionType === \"updatevisit\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"UpdatedVisitAssessment\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"EstimatedTime\"\n      ],\n      \"asValues\": [\n        selectedJob.sExpected_Duration\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n  $success();\n}"},"_auto_id_":"ff72fa47-0ddb-4e0e-8456-94c46d50335e","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"jobdatacollection","params":{"data":"{{$store.payloads.jobDataCollectionPayload}}","messageid":"{{$store.variables.jobDataCollectionHeaders.messageid}}","messagedate":"{{$store.variables.jobDataCollectionHeaders.messagedate}}","authtoken":"{{$store.variables.jobDataCollectionHeaders.authtoken}}","applicationkey":"{{$store.variables.jobDataCollectionHeaders.applicationkey}}"}},"_auto_id_":"ab048c73-8caf-4cab-b7b2-b86a7fbb97ef","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobdatacollection endpoint returns\n  {\n    \"bSuccess\": boolean,\n    \"sStatus\": string,\n    \"messageid\": string\n  }\n*/\n\nvar resp = cti.store.offlineApi.AccuServOffline.jobdatacollection;\nvar jobCollectionType = cti.store.variables.jobCollectionType;\nvar job = cti.store.jobs.selectedJob;\n\nif(resp) {\n  if(resp.bSuccess) {\n    if(job != undefined) {\n      if(jobCollectionType === \"warnings\") {\n        job.aPropertyDetail.bPropertyWarningsDataCollection = true;\n      }\n      if(jobCollectionType === \"tenantphoto\") {\n        job.bTenantPhotDataCollection = true;\n      }\n      if(jobCollectionType === \"initialvisit\") {\n        job.bInitialVisitDataCollection = true;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n      if(jobCollectionType === \"updatevisit\") {\n        job.bUpdatedVisitDataCollection = true;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n    }\n  } else {\n    if(job != undefined) {\n      window.appManager.logEvent('Data collection failed: ' + resp, 'warning');\n      if(jobCollectionType === \"warnings\") {\n        job.aPropertyDetail.bPropertyWarningsDataCollection = false;\n      }\n      if(jobCollectionType === \"tenantphoto\") {\n        job.bTenantPhotDataCollection = false;\n      }\n      if(jobCollectionType === \"initialvisit\") {\n        job.bInitialVisitDataCollection = false;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n      if(jobCollectionType === \"updatevisit\") {\n        job.bUpdatedVisitDataCollection = false;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n    }\n    window.appManager.logEvent('Data collection failed - no response.', 'warning');\n  }\n} else {\n  window.appManager.logEvent('Data collection response returned outside of job scope.', 'error');\n}\n\n// Clear variables relating to the data collection\ndelete cti.store.variables.jobDataCollectionHeaders;\ndelete cti.store.variables.jobCollectionType;\ndelete cti.store.payloads.jobDataCollectionPayload;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.jobdatacollection;"},"_auto_id_":"a245fefd-b9e9-457d-8094-35e0b0ee4ab1"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* jobdatacollection endpoint returns\n  {\n    \"bSuccess\": boolean,\n    \"sStatus\": string,\n    \"messageid\": string\n  }\n*/\n\nvar resp = cti.store.offlineApi.AccuServOffline.jobdatacollection;\n\n// TODO: Handle error response\n\n// Clear data collection information\ndelete cti.store.variables.jobDataCollectionHeaders;\ndelete cti.store.variables.jobCollectionType;\ndelete cti.store.payloads.jobDataCollectionPayload;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.jobdatacollection;"},"_auto_id_":"5c7dea4f-8c49-4d35-aa8e-25c4790832c1"}]}]}],"name":"JobDataCollection"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Booking Follow On Appointment...');\n\n// Fetch the followOnHeaders to supply to the joblist request\ncti.store.variables.followOnHeaders = window.appManager.newHeaderData();\n\nvar jobDetail = cti.store.jobs.selectedJob;\ncti.store.payloads.bookFollowOnPayload = {};\n\nvar data = {\n  \"iJobEventNoKey\": jobDetail.aAccuServJobID.iJobEventNoKey, \n  \"dApptDate\": jobDetail.sFollowOnRequiredDetail.dWorkDate, \n  \"sOperative\": jobDetail.sFollowOnRequiredDetail.sOperative,\n  \"sTrade\": cti.store.pages.FollowOnContinued.followOnTradeReq.label,\n  \"iDuration\": parseInt(cti.store.pages.FollowOnContinued.followOnDuration.value),\n  \"sComment\": cti.store.pages.FollowOnAppointment.followOnComments,\n};\n\ncti.store.payloads.bookFollowOnPayload = data;\n\n$success();"},"_auto_id_":"f9240d6b-6685-4784-9b45-00f72234818c","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"followonappointment","params":{"data":"{{$store.payloads.bookFollowOnPayload}}","messageid":"{{$store.variables.followOnHeaders.messageid}}","messagedate":"{{$store.variables.followOnHeaders.messagedate}}","authtoken":"{{$store.variables.followOnHeaders.authtoken}}","applicationkey":"{{$store.variables.followOnHeaders.applicationkey}}"}},"_auto_id_":"8cc28661-447e-4c28-96bb-4279804a8184","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.followonappointment;\n\nif(resp.bSuccess) {\n  delete cti.store.jobs.selectedJob.sFollowOnRequiredDetail;\n  delete cti.store.jobs.followOnTimeSlots;\n  delete cti.store.variables.appointmentResults\n  cti.utils.destroyPageData('FollowOnContinued');\n  delete cti.store.jobs.selectedJob.bFollowOnRequired;\n  \n  cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_followon\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Follow On Appointment Booked\",\n      \"text\" : \"Status: \" + resp.sStatus + \". Follow On Appointment successfully booked through AccuServ.\"\n    }\n  );\n} else {\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Error Booking Follow On Appointment\",\n      \"text\" : resp.sStatus || \"A problem occured when trying to retrieve the Follow On Time Slots\"\n    }\n  );\n}\n\ndelete cti.store.api.AccuServ.followonappointment;\ndelete cti.store.variables.followOnHeaders;\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"2ea7b9d9-7349-444a-bccd-0a269ddd28df","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Booking Follow On Appointment Request to API Failed\",\n    \"text\": \"The request to Book the Follow On Appointment failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete followOnHeaders payload object\ndelete cti.store.variables.followOnHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"5cca07c3-af43-4231-a4a8-841cbf367fef"}]}]}],"name":"BookFollowOnSlot"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Fetching Available Appointments...');\n\n// Fetch the followOnHeaders to supply to the joblist request\ncti.store.variables.followOnHeaders = window.appManager.newHeaderData();\n\nvar jobDetail = cti.store.jobs.selectedJob;\ncti.store.payloads.timeSlotsPayload = {};\n\nvar data = {\n  \"job\" : {\n    \"sJobNo\": jobDetail.aAccuServJobID.sJobNo, \n    \"iEventNo\": jobDetail.aAccuServJobID.iEventNo, \n    \"iJobEventNoKey\": jobDetail.aAccuServJobID.iJobEventNoKey, \n    \"sSchedulerID\": jobDetail.aAccuServJobID.sSchedulerID, \n    \"sOriginatorID\": jobDetail.aAccuServJobID.sOriginatorID\n  },\n  \"sTrade\": cti.store.pages.FollowOnContinued.followOnTradeReq.label,\n  \"iMinutes\": parseInt(cti.store.pages.FollowOnContinued.followOnDuration.value),\n  \"dStartDate\": moment(cti.store.pages.FollowOnContinued.followOnDate).format('YYYY-MM-DD'),\n  \"iDays\": cti.store.pages.FollowOnContinued.followOnDays\n};\n\ncti.store.payloads.timeSlotsPayload = data;\n\n$success();"},"_auto_id_":"23a7bddd-efb3-4095-a101-864781b521f9","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"followonavailability","params":{"data":"{{$store.payloads.timeSlotsPayload}}","messageid":"{{$store.variables.followOnHeaders.messageid}}","messagedate":"{{$store.variables.followOnHeaders.messagedate}}","authtoken":"{{$store.variables.followOnHeaders.authtoken}}","applicationkey":"{{$store.variables.followOnHeaders.applicationkey}}"}},"_auto_id_":"5747e6e1-abff-4c74-82ab-507dfd18eaac","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.followonavailability;\nvar id = 1;\nvar timeSlots = [];\n\ndelete cti.store.jobs.followOnTimeSlots;\n\nif(resp.bSuccess) {\n  var returnedTimeSlots = resp.items;\n  \n  if(returnedTimeSlots.length === 0) {\n    cti.store.variables.appointmentResults = false;\n  } else {\n    cti.store.variables.appointmentResults = true;\n    for(var i in returnedTimeSlots) {\n      var thisSlot = returnedTimeSlots[i];\n      var description;\n      var date = moment(thisSlot.dWorkDate);\n      var slot = thisSlot.sOperative;\n\n      var timeSlot = moment(date).format('dddd DD-MMM-YYYY');\n\n      description = timeSlot + ' ' + slot;\n\n      var obj = {\n        id: id,\n        description: description,\n        selected: false,\n        sOperative: slot,\n        dWorkDate: thisSlot.dWorkDate,\n        sWeekDay: thisSlot.sWeekDay,\n        nMaxSlots: thisSlot.nMaxSlots,\n        nUsedSlots: thisSlot.nUsedSlots,\n        sStatus: thisSlot.sStatus\n      };\n\t\t\n      id++;\n      timeSlots.push(obj);\n    }\n  }\n} else {\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Error Retrieving Follow On Availability\",\n      \"text\" : resp.sStatus || \"A problem occured when trying to retrieve the Follow On Time Slots\"\n    }\n  );\n}\n  \ncti.store.jobs.followOnTimeSlots = timeSlots;\n\ndelete cti.store.api.AccuServ.followonavailability;\ndelete cti.store.variables.followOnHeaders;\n\ncti.store.jobs.selectedJob.bFollowOnRequired = false;\ncti.store.jobs.selectedJob.sFollowOnRequiredDetail = undefined;\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"1a9875bf-82af-4a33-9036-4666345966fc"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Follow On Availability Request to API Failed\",\n    \"text\": \"The request to fetch the Follow On Time Slots failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete followOnHeaders payload object\ndelete cti.store.variables.followOnHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"3ebf593a-ada6-43c2-9b7a-8e8fca4fd942"}]}]}],"name":"GetFollowOnSlots"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Fetch the jobHistoryHeaders to supply to the joblist request\ncti.store.variables.jobHistoryHeaders = window.appManager.newHeaderData();\n\n// Package parameter payload for jobhistory API call\nvar jobID = cti.store.jobs.selectedJob.aAccuServJobID;\ncti.store.payloads.jobHistory = {\n  \"jobID\": {\n    \"sJobNo\": jobID.sJobNo,\n    \"iEventNo\": jobID.iEventNo,\n    \"iJobEventNoKey\": jobID.iJobEventNoKey,\n    \"sSchedulerID\": \"\",\n    \"sOriginatorID\": \"\"\n  },\n  \"contractType\": \"CURRENT\",\n  \"noOfJobs\": 9\n};\n\nvar exists = false;\n\nif(cti.store.jobs.jobHistory) {\n  for(var i in cti.store.jobs.jobHistory) {\n    var job = cti.store.jobs.jobHistory[i];\n    \n    if(job.aAccuServJobID.iJobEventNoKey == jobID.iJobEventNoKey) {\n      exists = true;\n      break;\n    }\n  }\n}\n\nif(!exists) {\n  $success();\n}"},"_auto_id_":"ffa8820d-0b8b-4e33-9d8a-ce4f6d640499","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobhistory","params":{"authtoken":"{{$store.variables.jobHistoryHeaders.authtoken}}","applicationkey":"{{$store.variables.jobHistoryHeaders.applicationkey}}","messageid":"{{$store.variables.jobHistoryHeaders.messageid}}","messagedate":"{{$store.variables.jobHistoryHeaders.messagedate}}","data":"{{$store.payloads.jobHistory}}"}},"_auto_id_":"0601fc3d-0c7a-436f-a87a-75fc5a33d961","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Job History Endpoint - Returns:\n    {\n      \"bSuccess\": boolean,\n      \"sStatus\": string,\n      \"iNoOfJobsReturned\": int,\n      \"aAccuServJobsSummaryList\": [array]\n  \t}\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.jobhistory;\n\n// Check response for failure\n// Package jobhistory in variable and navigate\n// to JobHistory page if errorCode returns 0\nif(resp.bSuccess) {\n  var detailHistoryObj = JSON.parse(JSON.stringify(resp.aAccuServJobsSummaryList));\n\n  for(var i in detailHistoryObj) {\n    var history = detailHistoryObj[i];\n    var date = moment(history.dAttendOnDate);\n    \n    history.dAttendOnDate = moment(history.dAttendOnDate).format('Do MMMM YYYY');\n    history.sDay = date.format('Do');\n    history.sMonth = date.format('MMM');\n    \n    if(history.iAttendOnHrs < 10) { \n      history.iAttendOnHrs = \"0\" + history.iAttendOnHrs.toString(); \n    } else {\n      history.iAttendOnHrs = history.iAttendOnHrs.toString();\n    }\n    \n    if(history.iAttendOnMins < 10) { \n      history.iAttendOnMins = \"0\" + history.iAttendOnMins.toString(); \n    } else {\n      history.iAttendOnMins = history.iAttendOnMins.toString();\n    }\n    \n    if(history.iAttendOnHrs < 12) { \n      history.iAttendOnMins += \"AM\";\n    } else {\n      history.iAttendOnMins += \"PM\";\n    }\n  }\n  \n  cti.store.jobs.jobHistory = detailHistoryObj;\n  cti.utils.callAction('go-to-page', { \"name\": \"JobHistory\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Failed to fetch Job History data\",\n      \"text\" : resp.sStatus\n    }\n  );\n}\n\n// Delete API response package\ndelete cti.store.api.AccuServ.jobhistory;\n\n// Delete jobHistoryHeaders payload object\ndelete cti.store.variables.jobHistoryHeaders;\n\n// Delete jobHistory payload object\ndelete cti.store.variables.jobHistory;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"7d4385ca-bf0e-4bd3-906a-716b3c9a94f5"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Job History Request to API Failed\",\n    \"text\": \"The request to fetch the Job History failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete jobHistoryHeaders payload object\ndelete cti.store.variables.jobHistoryHeaders;\n\n// Delete jobHistory payload object\ndelete cti.store.variables.jobHistory;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"a317738c-00e8-45bd-b0ac-85f4134e60ca"}]}]}],"name":"GetJobHistory"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Package jobId for API call\ncti.store.variables.jobDetailToFetch = {\n  \"iJobEventNoKey\" : cti.store.variables.selectedJobId\n};\n\n// Fetch the jobDetailHeaders to supply to the jobdetail request\ncti.store.variables.jobDetailHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"0f4c6d6c-06cf-4db6-9ff7-91e8a8ae0d63","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobdetail","params":{"messageid":"{{$store.variables.jobDetailHeaders.messageid}}","messagedate":"{{$store.variables.jobDetailHeaders.messagedate}}","authtoken":"{{$store.variables.jobDetailHeaders.authtoken}}","applicationkey":"{{$store.variables.jobDetailHeaders.applicationkey}}","data":"{{$store.variables.jobDetailToFetch}}"}},"_auto_id_":"bc0a00d8-767f-4cf9-98dc-c6b35c208cdb","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Job Detail Endpoint - Returns:\n    { \n      \"jobdetail\"\n    }\n*/\n\n// Grab response\nvar jobDetails = cti.store.jobs.jobDetails;\nvar resp = cti.store.api.AccuServ.jobdetail;\nvar detailIndex = undefined;\n\n// Check response for failure\n// Package jobdetail in variable and discard selectedJobId before continuing\n// to TenantDetails if errorCode returns 0\nif(resp.bSuccess) {\n  for(var j in jobDetails) {\n    if(resp.sJobNo == jobDetails[j].sJobNo) {\n      detailIndex = j;\n      break;\n    }\n  }\n\n  var detailObj = JSON.parse(JSON.stringify(resp));\n  var items = [];\n\n  for(var i in detailObj.aItemGroups) {\n    var thisItem = detailObj.aItemGroups[i]; \n    var str = JSON.stringify(thisItem);\n    \n    str = str.replace(/sLongDescription/g, 'sLongDescr');\n    str = str.replace(/sDescription/g, 'sShortDescr');\n\n    thisItem = JSON.parse(str);\n\n    delete thisItem.nQtyDoneToDate;\n    delete thisItem.sID;\n    delete thisItem.sPriceBook;\n    delete thisItem.sSpecialInstruction;\n    delete thisItem.sUnitOfMeasure;\n\n    if(thisItem.nSMVs == \"\" || thisItem.nSMVs == undefined) {\n      thisItem.nSMVs = 0;\n    }\n    if(thisItem.nSellPrice == \"\" || thisItem.nSellPrice == undefined) {\n      thisItem.nSellPrice = 0;\n    }\n    thisItem.sAttrib1 = \"\";\n    thisItem.sAttrib2 = \"\";\n    thisItem.sAttrib3 = \"\";\n    thisItem.sAttrib4 = \"\";\n    thisItem.sStockUnit = \"\";\n    thisItem.sTrade = \"\";\n    thisItem.nQtyRemaining = thisItem.nQtyRequired;\n\n    if(thisItem.sLongDescr == \"\" || thisItem.sLongDescr == undefined) {\n      thisItem.sLongDescr = thisItem.sShortDescr;\n    }\n\n    items.push(thisItem);\n  }\n\n  detailObj.aItemGroups = items;\n  \n  if(detailIndex == undefined) {\n    jobDetails.push(detailObj);\n  } else {\n    jobDetails[detailIndex] = detailObj;\n  }\n  \n  // Re-set the jobDetail store\n  cti.store.jobs.jobDetails = jobDetails;\n  \n  // Append selectedJob object\n  cti.store.jobs.selectedJob = detailObj;\n  \n  if(cti.store.jobs.selectedJob.aInJobDataCollectionResponse === undefined) {\n    cti.store.jobs.selectedJob.aInJobDataCollectionResponse = [];\n  }\n  if(cti.store.jobs.selectedJob.aInJobEventStatus === undefined) {\n    cti.store.jobs.selectedJob.aInJobEventStatus = [];\n  }\n\n  if(cti.store.staticData.jobLocations != undefined) {\n    if(cti.store.staticData.jobLocations.length > 0) {\n      cti.fnOrderSORLocations();\n      cti.fnOrderVanLocations();\n      cti.fnOrderOTCLocations();\n    }\n  }\n  \n  // Send job status\n  cti.fnSendEventStatus(\"30\");\n\n  // Navigate to Tenant Details page\n  cti.utils.callAction('go-to-page', { \"name\": \"TenantDetails\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Failed to fetch Job Detail data\",\n      \"text\" : resp.errorMessage\n    }\n  );\n}\n\n// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n\n// Delete API response package\ndelete cti.store.api.AccuServ.jobdetail;\n\n// Delete jobId parameter variable\ndelete cti.store.variables.jobDetailToFetch;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"00a92d5a-42b5-483c-8d4e-fa4c4249147d","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Job Detail Request to API Failed\",\n    \"text\": \"The request to fetch the Job Detail failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"2942014d-d9f2-451c-ab12-128baae78611","actions":[]}]}]}],"name":"GetJobDetailOnline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Fetch the jobDetailHeaders to supply to the joblist request\ncti.store.variables.jobDetailHeaders = window.appManager.newHeaderData();\n\n// Set our last job detail object to avoid calling twice\ncti.store.variables.pendingJobDetailToFetch = cti.store.variables.jobDetailToFetch;\n\n$success();"},"_auto_id_":"4141b58a-4feb-4cab-8172-52a7270aeb3f","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"jobdetail","params":{"messageid":"{{$store.variables.jobDetailHeaders.messageid}}","messagedate":"{{$store.variables.jobDetailHeaders.messagedate}}","authtoken":"{{$store.variables.jobDetailHeaders.authtoken}}","applicationkey":"{{$store.variables.jobDetailHeaders.applicationkey}}","data":"{{$store.variables.jobDetailToFetch}}"}},"_auto_id_":"8bb1e769-d175-4080-891e-8eacdde768b5","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Job Detail Endpoint - Returns:\n    { \n      \"jobdetail\"\n    }\n*/\n\n// Grab response\nvar jobDetails = cti.store.jobs.jobDetails;\nvar resp = cti.store.offlineApi.AccuServOffline.jobdetail;\nvar detailIndex = undefined;\n\n// Check response for failure\n// Package jobdetail in variable and discard selectedJobId before continuing\n// to TenantDetails if errorCode returns 0\nif(resp.bSuccess) {\n  for(var j in jobDetails) {\n    if(resp.sJobNo == jobDetails[j].sJobNo) {\n      detailIndex = j;\n      break;\n    }\n  }\n\n  var detailObj = JSON.parse(JSON.stringify(resp));\n  \n  if(detailIndex == undefined) {\n    jobDetails.push(detailObj);\n  } else {\n    jobDetails[detailIndex] = detailObj;\n  }\n  \n  // Re-set the jobDetail store\n  cti.store.jobs.jobDetails = jobDetails;\n  \n  // Reset pending job\n  delete cti.store.variables.pendingJobDetailToFetch;\n} else {\n  // Remove a retry attempt from the retrieveJobRetry variable on failed call\n  cti.store.jobs.retrieveJobRetry = cti.store.jobs.retrieveJobRetry - 1;\n}\n\n// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n\n// Delete API response package\ndelete cti.store.offlineApi.AccuServOffline.jobdetail;"},"_auto_id_":"09f2a883-b9f5-4801-81ce-db001523c8ea","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n// Remove a retry attempt from the retrieveJobRetry variable on failed call\ncti.store.jobs.retrieveJobRetry = cti.store.jobs.retrieveJobRetry - 1;"},"_auto_id_":"519407c3-b408-4c33-8366-ed6ec7f30665","actions":[]}]}]}],"name":"GetJobDetailOffline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\nif(!cti.store.variables.reSyncJobListAuto) {\n  if(cti.store.variables.reSyncJobList) {\n    cti.fnOpenSpinner('Job List Updated: Syncing new Job List...');\n  } else {\n    cti.fnOpenSpinner('Fetching Job List...');\n  }\n}\n\n// Fetch the jobListHeaders to supply to the joblist request\ncti.store.variables.jobListHeaders = window.appManager.newHeaderData();\n\n// Fetch the current jobList from the store to send back to AccuServ\ncti.store.payloads.jobList = window.accuServFunctions.fnMapExportJobList(cti.store.jobs.jobList);\n\n$success();"},"_auto_id_":"ad54680b-26d7-4881-bec8-1feffea55fdf","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"joblist","params":{"applicationkey":"{{$store.variables.jobListHeaders.applicationkey}}","authtoken":"{{$store.variables.jobListHeaders.authtoken}}","messageid":"{{$store.variables.jobListHeaders.messageid}}","messagedate":"{{$store.variables.jobListHeaders.messagedate}}","data":"{{$store.payloads.jobList}}"}},"_auto_id_":"39533e60-b51f-4923-b19b-b4fc962ac6fc","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* JobList Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success \n      \"sStatus\": \"\", -- Success message\n      \"dAssignedDate\": \"\", -- Date jobs were assigned to the operative\n      \"aAccuServJobsSummaryList\": [], -- Job summary list\n      \"messageid\": \"\" -- Unique message ID supplied from API\n    }\n*/\n\n// Sort function\nfunction compare(a,b) {\n  if (a.iDisplayOrder > b.iDisplayOrder) return 1;\n  if (a.iDisplayOrder < b.iDisplayOrder) return -1;\n  return 0;\n}\n\n// On the fly HTTP request to get the lat/long from address supplied\nfunction httpGetLatLong(theUrl, callback) {\n  var geocodeRequest = new XMLHttpRequest();\n  geocodeRequest.onreadystatechange = function() { \n    if (geocodeRequest.readyState == 4 && geocodeRequest.status == 200)\n      callback(geocodeRequest.responseText);\n  }\n  geocodeRequest.open(\"GET\", theUrl, true);\n  geocodeRequest.send(null);\n}\n\n// Fetchs the array index of a job from the jobList\nfunction findSummaryEntry(jobid, jobList) {\n  for (var k in jobList) {\n    var thisJob = jobList[k];\n    if (thisJob.aAccuServJobID.iJobEventNoKey == jobid) {\n      return k;\n    }\n  }\n  return undefined;\n}\n\n// Grab response\nvar resp = cti.store.api.AccuServ.joblist;\n\n// TODO Compare for entries in API resp jobList vs jobs.jobList\n// 1 If jobs.jobList is currently empty, no comparison to do\n// 2 If a job exists in jobs.jobList but not in resp.jobList we have lost a job. Inform the user that a job has been removed\n// 3 Overwrite jobs.jobList\n// 4 Clear the API results\n\n// Check response for failure \n// Proceed to JobList page if errorCode returns 0\nif(resp.bSuccess) {\n  var currentJobDetails = cti.store.jobs.jobDetails;\n  var jobListResponse = JSON.parse(JSON.stringify(resp.aAccuServJobsSummaryList));\n  cti.store.jobs.jobList = jobListResponse;\n\n  cti.store.jobs.mapLocations = [];\n  cti.store.jobs.jobListShort = [];\n\n  var jobListShort = cti.store.jobs.jobListShort;\n  var jobListOnDevice = cti.store.jobs.jobList;\n  \n  jobListResponse.sort(compare);\n  \n  for(var i in jobListOnDevice) {\n    var thisJob = jobListOnDevice[i];\n    var geocodeApi = \"https://maps.googleapis.com/maps/api/geocode/json?address=\" + thisJob.sPostcode + \"&key=AIzaSyD7SEAfX-pd_mRgCJW6LHYWBlmwVMBVBF0\";\n    var date = moment(jobListOnDevice[i].dAttendOnDate);\n    var index;\n\n    thisJob.sDay = date.format('Do');\n    thisJob.sMonth = date.format('MMM');\n\n    httpGetLatLong(geocodeApi, function(response) {\n      // On success response push results into a store array\n      var resp = JSON.parse(response);\n      var latlong = resp.results[0].geometry.location;\n\n      cti.store.jobs.mapLocations.push(latlong);\n    });\n\n    if(i == \"0\" || i == \"1\") {\n      jobListShort.push(thisJob);\n    }\n\n    if(thisJob.sProblemDetail.length >= 50) {\n      thisJob.sProblemDetailDisplay = thisJob.sProblemDetail.substring(0,50) + \"...\";\n    } else {\n      thisJob.sProblemDetailDisplay = thisJob.sProblemDetail;\n    }\n  }\n  \n  for (var k in currentJobDetails) {\n    var thisJob = currentJobDetails[k];\n    var summaryIndex = findSummaryEntry(thisJob.aAccuServJobID.iJobEventNoKey, jobListOnDevice);\n    if (summaryIndex === undefined) {\n      currentJobDetails.splice(k, 1);\n    }\n  }\n\n  if(cti.store.variables.reSyncJobListAuto) {\n    cti.store.variables.reSyncJobListAuto = undefined;\n  } else {\n    cti.store.variables.reSyncJobList = false;\n    // Navigate to the Job List page\n    cti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n  }\n\n  // Check to see if we have any jobs, and if so call the GetJobDetailOffline workflow\n  if(jobListOnDevice.length > 0) {\n    cti.store.variables.showFullJobs = false;\n    cti.store.jobs.retrieveJobRetry = 10;\n  } else {\n    cti.store.variables.showFullJobs = undefined;\n  } \n} else {\n  cti.store.variables.reSyncJobListAuto = undefined;\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Error Retrieving Job List\",\n      \"text\" : resp.sStatus || \"A problem occured when trying to retrieve the Job List\"\n    }\n  );\n  cti.store.variables.showFullJobs = undefined;\n}\n\n// Delete jobListHeaders payload object\ndelete cti.store.variables.jobListHeaders;\n\n// Delete API response package\ndelete cti.store.api.AccuServ.joblist;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"3ced467d-aa6c-4105-b673-ce21d3a32420","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Job List Request to API Failed\",\n    \"text\": \"The request to fetch the Job List failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete jobListHeaders payload object\ndelete cti.store.variables.jobListHeaders;\n\nif(cti.store.variables.reSyncJobListAuto) {\n  cti.store.variables.reSyncJobListAuto = undefined;\n} else {\n  // Navigate to the Job List page\n  cti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n}\n\n// Close Spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"83666086-56c7-4bbe-9992-ac6dc7e8cdac","actions":[]}]}]}],"name":"GetJobList"},{"content":[{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* VanStock API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateVanStock) {\n  // Fetch the vanStockHeaders to supply to the vanstock request\n  cti.store.variables.vanStockHeaders = window.appManager.newHeaderData();\n  $success();\n} "},"_auto_id_":"a5511e36-bf61-40b3-af1d-b4a64c2b9d4f","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"vanstock","params":{"applicationkey":"{{$store.variables.vanStockHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.vanStockHeaders.authtoken}}","messagedate":"{{$store.variables.vanStockHeaders.messagedate}}","messageid":"{{$store.variables.vanStockHeaders.messageid}}"}},"_auto_id_":"f2b54f6d-75db-4b1c-82b9-57cdc55684d6","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* VanStock Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aOperativeVanStock\": [] -- Array of operative van stock\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.vanstock;\n\n// Check response for failure \n// Notify user with popup warning if the Van Stock failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(resp.bSuccess) {\n  cti.store.staticData.updateStatus.updateVanStock = false;\n} else {\n  cti.store.staticData.updateStatus.updateVanStock = false;\n  window.appManager.logEvent('Failed to retrieve Van Stock. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;"},"_auto_id_":"2e66ccb8-6993-4ded-8dd1-c0d7f1b6b195"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"cti.store.staticData.updateStatus.updateVanStock = true;\nwindow.appManager.logEvent('Failed to retrieve Van Stock data (API connection).', 'warning');\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;"},"_auto_id_":"bbd9fc8b-d51f-4dfb-94c2-708e7fd9d870"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* OrderCatalogue API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateCatalogue) {\n  // Fetch the otcHeaders to supply to the catalogue request\n  cti.store.variables.otcHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"f02a63bc-97da-4fbb-9c2e-5465f0cb1a2a","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"ordercatalogue","params":{"applicationkey":"{{$store.variables.otcHeaders.applicationkey}}","messageid":"{{$store.variables.otcHeaders.messageid}}","messagedate":"{{$store.variables.otcHeaders.messagedate}}","authtoken":"{{$store.variables.otcHeaders.authtoken}}"}},"_auto_id_":"e9ed687c-89d2-4c24-a42b-b864a0133dd5","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* ordercatalogue Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aStockItemsFull\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar response = cti.store.offlineApi.AccuServOffline.ordercatalogue;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(response.bSuccess) {\n  // On success add the OTC data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"otcdatafull\", \n    response.aStockItemsFull, function(rev) {\n      // OTC data stored successfully\n      window.appManager.logEvent('Saved OTC Stock data, revision: ' + rev);\n      delete cti.store.offlineApi.AccuServOffline.ordercatalogue;\n      $success();\n    }, function(reason, e) {\n      // Failed to store, but makes no difference to workflow\n      delete cti.store.offlineApi.AccuServOffline.ordercatalogue;\n      window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n      $success();\n  });\n\n  cti.store.staticData.updateStatus.updateCatalogue = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve OTC data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;"},"_auto_id_":"3d4ca3e1-8fa3-47f6-b219-22e9906406b1","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve OTC data (API connection).', 'warning');\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;"},"_auto_id_":"94b4f8db-365d-47cd-937d-1136914ef0ae"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* JobLocations API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateJobLocations) {\n  // Fetch the jobLocationsHeaders to supply to the vanstock request\n  cti.store.variables.jobLocationsHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"9c89f869-25c7-422b-89a6-492b7a3c9cf6","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"joblocations","params":{"applicationkey":"{{$store.variables.jobLocationsHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.jobLocationsHeaders.authtoken}}","messagedate":"{{$store.variables.jobLocationsHeaders.messagedate}}","messageid":"{{$store.variables.jobLocationsHeaders.messageid}}"}},"_auto_id_":"ade11e5d-cc70-43b5-ba7d-53da07225117","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* joblocations Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"aJobLocationDetail\": [],\n      \"messageid\": \"\"\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.joblocations;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var jobLocationsObj = JSON.parse(JSON.stringify(resp.aJobLocationDetail));\n  cti.store.staticData.jobLocations = jobLocationsObj;\n  cti.store.staticData.updateStatus.updateJobLocations = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Locations static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete jobLocationsHeaders payload object\ndelete cti.store.variables.jobLocationsHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.joblocations;"},"_auto_id_":"2f7065a8-2c1d-4aba-bfe7-e7b5b787e20d"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Locations static data (API connection).', 'warning');\n\ndelete cti.store.variables.jobLocationsHeaders;"},"_auto_id_":"b48fa929-8ef4-410a-aff8-57b64af114d1"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* TradesList API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateTrades) {\n  // Fetch the tradesListHeaders to supply to the vanstock request\n  cti.store.variables.tradesListHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"8c725836-8f25-4c04-ab32-a8f64d6a6e73","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"tradeslist","params":{"applicationkey":"{{$store.variables.tradesListHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.tradesListHeaders.authtoken}}","messagedate":"{{$store.variables.tradesListHeaders.messagedate}}","messageid":"{{$store.variables.tradesListHeaders.messageid}}"}},"_auto_id_":"136c0af1-5706-4551-aa0d-bde34efcac8e","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* tradeslist Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"sStatus\": string\n      \"aAccuServTrades\": array,\n      \"messageid\": string\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.tradeslist;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var tradesList = JSON.parse(JSON.stringify(resp.aAccuServTrades));\n  \n  cti.store.staticData.tradesList = tradesList;\n  cti.store.staticData.updateStatus.updateTrades = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Trades List static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete tradesListHeaders payload object\ndelete cti.store.variables.tradesListHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.tradeslist;"},"_auto_id_":"cad094c3-0cd5-43df-90a8-1e0f28ba6a3f"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Locations static data (API connection).', 'warning');\n\ndelete cti.store.variables.tradesListHeaders;"},"_auto_id_":"975b6d50-ba3f-461e-82ae-9f8619ee0020"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* ResultSummaries API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateSummaries) {\n  // Fetch the resultSummaryHeaders to supply to the vanstock request\n  cti.store.variables.resultSummaryHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"36d566af-b04c-48d9-bcdf-fe640117e953","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"resultsummaries","params":{"applicationkey":"{{$store.variables.resultSummaryHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.resultSummaryHeaders.authtoken}}","messagedate":"{{$store.variables.resultSummaryHeaders.messagedate}}","messageid":"{{$store.variables.resultSummaryHeaders.messageid}}"}},"_auto_id_":"2e32a04f-7cee-4021-ac3c-04a1aa3d994e","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* resultsummaries Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"sStatus\": string\n      \"aAccuServResultSummaries\": array,\n      \"messageid\": string\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.resultsummaries;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var resultSummaries = JSON.parse(JSON.stringify(resp.aAccuServResultSummaries));\n  \n  if(resultSummaries.length > 0) {\n    for(var i in resultSummaries) {\n      if(resultSummaries[i].sResultSummary == \"ABANDON JOB\") {\n        cti.store.staticData.abandonJobList = resultSummaries[i].aAccuServSubResultSummary;\n      }\n      if(resultSummaries[i].sResultSummary == \"NO ACCESS\") {\n        cti.store.staticData.noAccessList = resultSummaries[i].aAccuServSubResultSummary;\n      }\n      if(resultSummaries[i].sResultSummary == \"FOLLOW ON REQUIRED\") {\n        cti.store.staticData.followOnList = resultSummaries[i].aAccuServSubResultSummary;\n      }\n    }\n  } else {\n    if(cti.store.staticData.abandonJobList === undefined) {\n      cti.store.staticData.abandonJobList = [\n        {\"sSubResultSummary\":\"ABUSIVE/VIOLENT TENANT\"},\n        {\"sSubResultSummary\":\"FAILED RISK ASSESSMENT\"},\n        {\"sSubResultSummary\":\"MINORS ONLY IN PROPERTY - NO ADULTS\"},\n        {\"sSubResultSummary\":\"UNSAFE ENVIRONMENT\"},\n        {\"sSubResultSummary\":\"WRONG TRADE\"}\n      ];\n    }\n    if(cti.store.staticData.noAccessList === undefined) {\n      cti.store.staticData.noAccessList = [\n        {\"sSubResultSummary\":\"DEMOLISHED PROPERTY\"},\n        {\"sSubResultSummary\":\"NO ANSWER AT DOOR\"},\n        {\"sSubResultSummary\":\"TENANT REFUSED ENTRY\"}\n      ];\n    }\n    if(cti.store.staticData.followOnList === undefined) {\n      cti.store.staticData.followOnList = [\n        {\"sSubResultSummary\":\"FURTHER VISIT (ME)\"},\n        {\"sSubResultSummary\":\"FURTHER VISIT (OTHER)\"},\n        {\"sSubResultSummary\":\"MATERIALS REQUIRED\"},\n        {\"sSubResultSummary\":\"OTHER TRADE REQUIRED\"},\n        {\"sSubResultSummary\":\"TENANT STOP WORK REQUEST\"}\n      ];\n    }\n  }\n  \n  cti.store.staticData.updateStatus.updateSummaries = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Result Summaries static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete resultSummaryHeaders payload object\ndelete cti.store.variables.resultSummaryHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.resultsummaries;"},"_auto_id_":"33a8eafc-1ced-4e95-a0a0-d30f91b75201"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Result Summaries static data (API connection).', 'warning');\n\ndelete cti.store.variables.resultSummaryHeaders;"},"_auto_id_":"6fbd924b-3bea-4e14-a0af-ece7d4c732c9"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* SupplierList API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateSupplier) {\n  // Fetch the stockSuppliersHeaders to supply to the vanstock request\n  cti.store.variables.stockSuppliersHeaders = window.appManager.newHeaderData();\n  $success(true);\n}"},"_auto_id_":"df58c3c6-c91a-4e91-a17a-aba0ba5b41b3","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"stocksuppliers","params":{"applicationkey":"{{$store.variables.stockSuppliersHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.stockSuppliersHeaders.authtoken}}","messagedate":"{{$store.variables.stockSuppliersHeaders.messagedate}}","messageid":"{{$store.variables.stockSuppliersHeaders.messageid}}"}},"_auto_id_":"c9d1a652-0b41-4c35-8258-29deb5ef2cfe","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* stocksuppliers Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"sStatus\": string\n      \"aSupplierDetail\": array,\n      \"messageid\": string\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.stocksuppliers;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var stockSuppliers = JSON.parse(JSON.stringify(resp.aSupplierDetail));\n  cti.store.staticData.stockSuppliers = stockSuppliers;\n  cti.store.staticData.updateStatus.updateSupplier = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Stock Suppliers static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete stockSuppliersHeaders payload object\ndelete cti.store.variables.stockSuppliersHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.stocksuppliers;"},"_auto_id_":"fcb17c2e-b3eb-47d8-91bf-577de3bd30c6"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Result Summaries static data (API connection).', 'warning');\n\ndelete cti.store.variables.resultSummaryHeaders;"},"_auto_id_":"dd61fade-2710-48fe-ac89-6ae74f314b6e"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* SORCode API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateSORCodes) {\n  // Fetch the sorHeaders to supply to the sordata request\n  cti.store.variables.sorHeaders = window.appManager.newHeaderData();\n  $success(true);\n}"},"_auto_id_":"bb9f4461-b2af-4945-b05b-e7aa0cad585c","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"sordata","params":{"applicationkey":"{{$store.variables.sorHeaders.applicationkey}}","messageid":"{{$store.variables.sorHeaders.messageid}}","messagedate":"{{$store.variables.sorHeaders.messagedate}}","authtoken":"{{$store.variables.sorHeaders.authtoken}}"}},"_auto_id_":"4f6aa680-3afc-4c96-8f85-ae129d51ffa4","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* SORCodes Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aSORCodesDetail\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar response = cti.store.offlineApi.AccuServOffline.sordata;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(response.bSuccess) {\n  // On success add the SOR data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"sordata\", \n    response.aSORCodesDetail, function(rev) {\n      // SOR data stored successfully\n      window.appManager.logEvent('Saved SOR data, revision: ' + rev);\n      delete cti.store.offlineApi.AccuServOffline.sordata;\n      cti.store.staticData.updateStatus.updateSORCodes = false;\n      $success();\n    }, function(reason, e) {\n      // Failed to store, but makes no difference to workflow\n      delete cti.store.offlineApi.AccuServOffline.sordata;\n      window.appManager.logError('Failed to save SOR data - ' + reason, e);\n      $success();\n    });\n} else {\n  window.appManager.logEvent('Failed to retrieve SOR data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;"},"_auto_id_":"6435380f-ba24-4b16-bf30-e1fa124262bf","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve SOR data (API connection).', 'warning');\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;"},"_auto_id_":"fea94a94-45ad-47f7-b1a3-c47c3ce99a9b"}]}]}],"name":"StaticData"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* StartOfDay API Request Package Function */\n\n// Fetch the startOfDayHeaders to supply to the startofday request\ncti.store.variables.startOfDayHeaders = window.appManager.newHeaderData();\n\n// Form the start of day request payload. Done inline here because it's the only place we need it\nvar tyresCheckOk= false,\n    oilCheckOk = false,\n    waterCheckOk = false,\n    lightsCheckOk = false,\n    rdoDrivingCheck = false;\n\ncti.store.pages.VehicleChecks.tyresCheckOk == \"1\" ? tyresCheckOk = true : tyresCheckOk = false;\ncti.store.pages.VehicleChecks.oilCheckOk == \"1\" ? oilCheckOk = true : oilCheckOk = false;\ncti.store.pages.VehicleChecks.waterCheckOk == \"1\" ? waterCheckOk = true : waterCheckOk = false;\ncti.store.pages.VehicleChecks.lightsCheckOk == \"1\" ? lightsCheckOk = true : lightsCheckOk = false;\ncti.store.pages.VehicleChecks.rdoDrivingCheck == \"1\" ? rdoDrivingCheck = true : rdoDrivingCheck = false;\n\nif(rdoDrivingCheck) {\n  cti.store.payloads.startOfDay = {\n    \"sOperativeID\": cti.store.currentProfile.username,\n    \"sVanReg\": cti.store.pages.VehicleChecks.vehicleRegistration,\n    \"nVanMileage\": cti.store.pages.VehicleChecks.vehicleOdometer,\n    \"bTyresOK\": tyresCheckOk,\n    \"bOilOK\": oilCheckOk,\n    \"bWaterOk\": waterCheckOk,\n    \"bLightsOk\": lightsCheckOk,\n    \"bDrivingToday\": true\n  }\n} else {\n  cti.store.payloads.startOfDay = {\n    \"sOperativeID\": cti.store.currentProfile.username,\n    \"sVanReg\": cti.store.pages.VehicleChecks.vehicleRegistration,\n    \"bDrivingToday\": false\n  }\n}\ndebugger;\n$success();"},"_auto_id_":"5f87a1a3-d687-4ebf-87d7-df3f168671c7","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"startofday","params":{"applicationkey":"{{$store.variables.startOfDayHeaders.applicationkey}}","authtoken":"{{$store.variables.startOfDayHeaders.authtoken}}","messageid":"{{$store.variables.startOfDayHeaders.messageid}}","messagedate":"{{$store.variables.startOfDayHeaders.messagedate}}","data":"{{$store.payloads.startOfDay}}"}},"_auto_id_":"d7163e42-fdb2-4bb3-9ae9-f7e3a4a678d4","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* StartOfDay API Success Response */\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.startofday;\n\n// Check response for failure \n// Notify user with popup warning if the Start of Day failed to send\n// Will retry with a TTL of 60 minutes\nif(!resp.bSuccess) {\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Start of Day Checks Failed to Send\",\n      \"text\" : resp.sStatus || \"A problem occurred when trying to send Start of Day checks\"\n    }\n  );\n  window.appManager.logEvent('Problem submitting start of day checks: ' + resp.sStatus, 'warning');\n}\n\n// Delete startOfDayHeaders payload object\ndelete cti.store.variables.startOfDayHeaders;"},"_auto_id_":"dfdd0fc1-5036-40a8-82e5-3707b67784ec","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* StartOfDay API Fail Response */\n\n// Delete startOfDayHeaders payload object\ndelete cti.store.variables.startOfDayHeaders;\n\n// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to submit Start of Day\",\n    \"text\": \"We couldn't reach the AccuServ server to supply your Start of Day checks. Please contact support\"\n  }\n);\nwindow.appManager.logEvent('Failed to submit start of day request (API connection).', 'error');\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"ce2d4758-730a-4eb9-a456-8aab6ed3c26a","actions":[]}]}]}],"name":"StartOfDay"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Initialise API Request Package Function */\n\n// Fetch the initialiseHeaders to supply to the initialise request\ncti.store.variables.initialiseHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"75a2a73b-7039-4365-9c57-18f67dae683d","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"initialise","params":{"messageid":"{{$store.variables.initialiseHeaders.messageid}}","applicationkey":"{{$store.variables.initialiseHeaders.applicationkey}}","messagedate":"{{$store.variables.initialiseHeaders.messagedate}}","authtoken":"{{$store.variables.initialiseHeaders.authtoken}}"}},"_auto_id_":"25ca1bb7-5599-4a78-abd5-a1410d44ab99","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Initialise API Success Response */\n\n// Grab response\nvar resp = cti.store.api.AccuServ.initialise;\n\n// Check response for failure \n// Proceed through workflow to VehicleChecks if errorCode returns 0\nif(resp.bSuccess) {\n  // Set StaticData update booleans\n  cti.store.staticData.updateStatus = {};\n  cti.store.staticData.updateStatus.updateSORCodes = resp.bSORDownloadRequired;\n  cti.store.staticData.updateStatus.updateVanStock = resp.bVanDownloadRequired;\n  cti.store.staticData.updateStatus.updateSupplier = resp.bSuppliersDownLoadRequired;\n  cti.store.staticData.updateStatus.updateJobLocations = resp.bJobLocationsRequired;\n  cti.store.staticData.updateStatus.updateCatalogue = resp.bCatalogDownLoadRequired;\n\n  cti.utils.callAction('go-to-page', { \"name\": \"VehicleChecks\" });\n} else {\n  // Set StaticData update booleans\n  cti.store.staticData.updateStatus = {};\n  cti.store.staticData.updateStatus.updateSORCodes = true;\n  cti.store.staticData.updateStatus.updateVanStock = true;\n  cti.store.staticData.updateStatus.updateSupplier = true;\n  cti.store.staticData.updateStatus.updateJobLocations = true;\n  cti.store.staticData.updateStatus.updateCatalogue = true;\n  \n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Initialisation failed\",\n      \"text\": resp.sStatus || \"AccuServ was unable to Initialise your Start of Day. Please contact support.\"\n    }\n  );\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\n  cti.utils.callAction('call-actionflow', { \"name\": \"StartOfDay\" });\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n  \n  window.appManager.logEvent('Failed response from initialisation request. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Store away Vehicle and stock specific data for future use\ncti.store.pages.VehicleChecks.vehicleRegistration = resp.sVanReg;\ncti.store.pages.VehicleChecks.vehicleOdometer = resp.nlastRecordedMileage;\ncti.store.currentProfile.managerTelephone = resp.sLineManagerMobile;\ncti.store.currentProfile.managerName = resp.sLineManager;\n\n// TODO - Dynamically driven\ncti.store.staticData.vehicleMileageMaxEntry = resp.nVehicleMileageMaxEntry || 1000;\n\ncti.store.staticData.updateStatus.updateSummaries = true;\ncti.store.staticData.updateStatus.updateTrades = true;\n\n// Delete initialiseHeaders payload object\ndelete cti.store.variables.initialiseHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"cb7f9924-06d6-48f8-9f5c-5a3626d00ed1"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* Initialise API Fail Response */\n\n// Delete initialiseHeaders payload object\ndelete cti.store.variables.initialiseHeaders;\n\n// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Initialisation failed\",\n    \"text\": \"We couldn't reach the AccuServ server to get your information. Please contact support\"\n  }\n);\nwindow.appManager.logEvent('Failed to process initialisation request (API connection).', 'error');\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"705775a0-a53d-4f03-92be-4bf88d0454f4"}]}]}],"name":"Initialise"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Login API Request Package Function */\nvar settings = true;\n\nif(cti.store.pages.AppSettings === undefined || cti.store.pages.AppSettings.accuservAPIAddress === undefined || cti.store.pages.AppSettings.accuservAPIAddress == '') {\n  if(cti.store.schema.metadata.accuservurl === undefined) {\n    // Notify operative that API not configured\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"api_failure_error\",\n        \"title\": \"Configuration Needed\",\n        \"text\": \"The app is not configured to communicate with AccuServ. Please do this in Settings (consult support if required).\"\n      }\n    );\n\n    settings = false;\n  } else {\n    if(cti.store.pages.AppSettings == undefined) {\n      cti.store.pages.AppSettings = {};\n    }\n    \n    cti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;\n  }\n}\n\nif(settings) {\n  // Load Spinner\n  cti.fnOpenSpinner('Attempting to log in...');\n\n  // Fetch the loginHeaders to supply to the login request\n  cti.store.variables.loginHeaders = window.appManager.newHeaderData();\n\n  // Check and defined the payloads store\n  if(cti.store.payloads == undefined) cti.store.payloads = {};\n\n  // Create a login payload of the username and password to send to the login request\n  cti.store.payloads.login = {\n    \"username\": cti.store.pages.Login.Username,\n    \"password\": cti.store.pages.Login.Password\n  };\n\n  $success();\n}"},"_auto_id_":"b29f6bab-39ec-401b-a99d-bf5f99b62c60","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"login","params":{"data":"{{$store.payloads.login}}","applicationkey":"{{$store.variables.loginHeaders.applicationkey}}","messageid":"{{$store.variables.loginHeaders.messageid}}","messagedate":"{{$store.variables.loginHeaders.messagedate}}"}},"_auto_id_":"bb005f75-da03-4cc0-8f6e-e2ab7144756e","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Login API Success Response Function */\n\n// Create link to API for Google Maps\nvar google = document.getElementById('google');\n\n// Check if we haven't already added the script tag\nif(google == undefined) {\n  window.appManager.logEvent('Google Maps API not loaded,  initialising...', 'info');\n  var googleMaps = document.createElement('script');\n  googleMaps.id = 'google';\n  googleMaps.src = 'https://maps.googleapis.com/maps/api/js?key=' + cti.store.schema.metadata.googleapikey;\n  document.body.appendChild(googleMaps);\n  window.appManager.logEvent('Google Maps API initialised successfully.', 'info');\n} else {\n  window.appManager.logEvent('Google Maps API initialised', 'info');\n}\n\n// Hide variable set to hide elements not wanted yet in this version: Example vehicle reg\ncti.store.hide = false;\n\n// Just encoded at the mo, but we'll ultimately use an encrypted hash for an offline login check later. We'll only store this if the login succeeds\nvar username = cti.store.pages.Login.Username.toLowerCase();\nvar credentialHash = btoa(username + '==' + cti.store.pages.Login.Password);\nvar dt = new Date();\n\n// Make certain the password is cleared\ndelete cti.store.pages.Login.Password;\n\n// Grab the result so we can check if our login request was actually accepted\n// We'll put it in a holding object so we can delete the API store response\nvar loginResult = {\n  \"errorCode\": cti.store.api.AccuServ.login.errorCode,\n  \"errorMessage\": cti.store.api.AccuServ.login.errorMessage,\n  \"token\": cti.store.api.AccuServ.login.token,\n  \"startOfDayRequired\": cti.store.api.AccuServ.login.startOfDayRequired,\n  \"expiresIn\": cti.store.api.AccuServ.login.expiresIn,\n  \"jobsRequired\": cti.store.api.AccuServ.login.jobsRequired,\n  \"messageid\": cti.store.api.AccuServ.login.messageid,\n  \"maxLoginDuration\": cti.store.api.AccuServ.login.maxLoginDuration || (60 * 14)\n}\n\n// Delete API store response for Login\ndelete cti.store.api.AccuServ.login;\n\n// Check response for failure \n//\n// Proceed through workflow to Initialise if errorCode returns 0 \n// and startOfDayRequired == true\n// Proceed straight to JobList otherwise\nif(loginResult.errorCode == 0) {\n  window.accuServFunctions.fnInitialiseModel();\n  cti.store.variables.successLogin = true;\n \n  // Is the user the same as the last logged in user?\n  if(cti.store.lastLogin !== undefined) {\n    // Different user - van stock is redundant\n    if(username != cti.store.lastLogin.username) {\n      window.appManager.logEvent('Different user logging in: ' + username, 'info');\n      delete cti.store.offlineApi.AccuServOffline.vanstock;\n      delete cti.store.staticData.vanStockLastRetrievedDate;\n    }\n    else if (window.appManager.areDatesEqual(cti.store.lastLogin.dateTime, dt)) {\n      window.appManager.logEvent('Logging back in: ' + username, 'info');\n      var previousUser = true;\n    }\n    else {\n      window.appManager.logEvent('First login today: ' + username, 'info');\n    }\n  }\n  else  {\n    window.appManager.logEvent('New user logging in: ' + username, 'info');\n  }\n\n  // Store the user as the last user to login\n  cti.store.lastLogin = {\n    \"userHash\": credentialHash,\n    \"username\": username,\n    \"dateTime\": dt\n  };\n  \n  // PW I've pre-emptively supported the ability for the login method to tell us the maximum length of our\n  // session, during which we may keep re-acquiring a token to keep the session running. Once we reach this\n  // threshhold (maxLoginDuration; defaults to 14 hours from login), the user must fully login again.\n  var maxLoginDurationExpiry = new Date();\n  maxLoginDurationExpiry.setMinutes(maxLoginDurationExpiry.getMinutes() + loginResult.maxLoginDuration);\n\n  // Create a current profile for the user\n  cti.store.currentProfile = {\n    \"username\": username,\n    \"token\": loginResult.token,\n    \"dateTime\": dt,\n    \"maxLoginDurationExpiry\": maxLoginDurationExpiry,\n    \"jobsRequired\": loginResult.jobsRequired\n  };\n  \n  window.accuServFunctions.fnUpdateAuthToken(loginResult.token, loginResult.expiresIn);\n\n  if(loginResult.startOfDayRequired) {\n    window.accuServFunctions.fnDataDestroy();\n    cti.utils.callAction('call-actionflow', { \"name\": \"Initialise\" });\n  } else {\n    if(cti.store.staticData.updateStatus === undefined) {\n      cti.store.staticData.updateStatus = {\n        \"updateSORCodes\": true,\n        \"updateVanStock\": true,\n        \"updateSupplier\": true,\n        \"updateJobLocations\": true,\n        \"updateCatalogue\": true,\n        \"updateSummaries\" : true,\n        \"updateTrades\" : true\n      }\n    } else {\n      cti.store.staticData.updateStatus.updateSummaries = true;\n      cti.store.staticData.updateStatus.updateTrades = true;\n    } \n    \n    if(previousUser) {\n      if(cti.store.variables.timedOut) {\n        cti.store.variables.timedOut = false;\n        cti.utils.callAction('go-to-page', { \"name\": cti.store.variables.lastPage });\n      } else {\n        cti.fnCloseSpinner();\n        cti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\n        cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n      }\n    } else {\n      cti.fnCloseSpinner();\n      cti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\n      cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n    }\n  }\n} else {\n  // We have failed to login, display returned error message\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Login Failed\",\n      \"text\": loginResult.errorMessage || \"Please provide a valid Username and Password\"\n    }\n  );\n}\n\n// Delete loginHeaders payload object\ndelete cti.store.variables.loginHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"3dd2e4e1-91ca-41a2-8068-e793871a79ad","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* Login API Fail Response Function */\n\n// Make certain the password is cleared\ndelete cti.store.pages.Login.Password;\n\n// TODO Depending on the nature of the failure, we can allow the user to log in using cached credentials\n\n// Delete loginHeaders payload object\ndelete cti.store.variables.loginHeaders;\n\n// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Login failed\",\n    \"text\": \"We couldn't reach the AccuServ server to log you in. Please contact support\"\n  }\n);\n\nwindow.appManager.logEvent('Failed to process login request (API connection).', 'error');\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"881fa0d6-66ed-409d-a793-1f30c0e8732d","actions":[]}]}]}],"name":"Login"}],"dataflows":[],"config":[{"name":"Moment","type":"scripting","item-type":"js-asset","_auto_id_":"d075d71d-a0e7-42bc-b5ab-4cd2154ead9c","fileName":"moment.js"},{"name":"jsAppManager","type":"scripting","item-type":"js-asset","_auto_id_":"ae2f40bb-16ba-4cc2-a024-32a547e55a4c","fileName":"appManager.js"},{"name":"jsAccuServFunctions","type":"scripting","item-type":"js-asset","_auto_id_":"52f3d8ee-2c1a-43fd-8e89-778d0af513ba","fileName":"accuServGlobalFunctions.js"},{"name":"cssMain","type":"style","item-type":"css","_auto_id_":"6cb32db0-9840-4d16-a8b2-87cc9e66c718","content":"section.scrollable-item {\n    overflow-y: auto;\n}\n.md-list .scrollable {\n    overflow-y: hidden;\n}\n\n.h3-header { \n  text-align: center; \n}\n\n.p-text { \n  text-align: center; \n}\n\n.btn.disabled, .btn[disabled], fieldset[disabled] .btn {\n  pointer-events: none;\n  cursor: not-allowed;\n  filter: alpha(opacity=25);\n  -webkit-box-shadow: none;\n  box-shadow: none;\n  opacity: 0.25;\n  color: black;\n}\n.required-asterix.fa-star { \n  color: transparent; \n}\n\n.fa-circle-o:before, .fa-dot-circle-o:before { \n  padding-right: 2vw; \n}\n\n.has-success .form-control {\n  border-color: #8E8A87!important;\n}\n\n.flexbox-container .navbar-default.row-item:last-child { \n  background-color: #fff; \n}\n\n.form-group.item-date .input-group-addon, .form-group.item-time .input-group-addon { \n  background-color: #dc4f10!important; \n}\n\n.md-checkbox { \n  font-size:1.4em; \n}\n\ndiv.cb-bias-last > div > div > div:first-child div.md-checkbox,\ndiv.cb-bias-first > div > div > div:nth-child(2) div.md-checkbox { \n  color:green !important; \n}\n\ndiv.cb-bias-first > div > div > div:first-child div.md-checkbox,\ndiv.cb-bias-last > div > div > div:nth-child(2) div.md-checkbox { \n  color:red !important; \n}\n\n.form-input-error { \n  color: #fff; \n}\n\n#toast-container { \n  position: fixed; z-index: 999999; margin-top: 200px; \n}\n\n#toast-container>div { \n  width: 94vw!important; margin-left: 4vw; \n}\n\n.container, .container-fluid {\n  font-size: 12pt!important;\n  padding-right: 0px;\n  padding-left: 0px;\n  margin-right: 14px;\n}\n\n.signature-frame .canvas-frame { \n  width: 330px; \n  border: 2px dotted #0072C6; \n}\n\n.completeheader { \n  text-align: center; \n  color: #228B22; \n}\n\n.abandonheader { \n  text-align: center; \n  color: #ff0000; \n}\n\n.check-fail-header { \n  text-align: center; \n  color: #ff0000; \n}\n\n.complete { \n  color: #228B22; \n}\n\n.has-error .control-label { \n  color: #000; \n}\n\n/* Generic list styling */\n\nul {\n  list-style:none;\n  padding:0;\n}\n.list-item-container {\n  width: 100%;\n  min-height:30px;\n}\n.list-item-head {\n  width:98%;\n}\n.list-item-head span {\n  /*font-size:0.8em;*/\n  font-style: italic;\n  font-variant: small-caps;\n  float:right;\n}\n.list-item-detail {\n  font-size:0.8em;\n  color:darkgrey;\n}\n\n.read-more {\n  margin-top: 5px;\n  color: #0072C6;\n  font-weight: bold;\n}\n\n/* Log display */\n.log-error {\n  color:red;\n}\n.log-warning {\n  color:orange;\n}\n.log-debug {\n  color:gray;\n}\n\n.md-list>.top>.search-area .search-box { \n  max-width: 100%; \n}\n\n.centered-max {\n  width:100%;\n  text-align:center;\n}\n.centered-text {\n  text-align:center;\n}\n\n.list-display-block {\n  display:inline-block;\n  width:100%;\n}"},{"name":"cssButtons","type":"style","item-type":"css","_auto_id_":"13fb8411-0d5b-4f7f-8dcb-7f80d6247a1b","content":".abandon-bar-btn, .abandon-bar-btn[disabled] {\n  background-color: #0072C6!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.deletephoto-btn {\n  background-color: #cc0000!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.button-bar-btn, .button-bar-btn[disabled] {\n  background-color: #dc4f10!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.confirm-bar-btn {\n  background-color: #0072C6!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.login-button {\n  background-color: #dc4f10!important;\n  color: #fff!important;\n  width: 300px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n  margin-bottom: 20px;\n  margin-top: 20px;\n}\n.travel-btn {\n  display: inline-block;\n  background-color: #0072C6!important;\n  color: #fff!important;\n  margin-bottom: 3vh;\n  width: 250px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.startjob-btn {\n  display: inline-block;\n  background-color: #0072C6!important;\n  color: #fff!important;\n  margin-bottom: 3vh;\n  width: 60vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.startjob-btn, .startjob-btn[disabled] {\n  color: #fff!important;\n  background-color: #0072C6;\n}\n.getmethere-btn {\n  color: #fff!important;\n  background-color: #0072C6!important;\n  margin-bottom: 5vh;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.takephoto-btn {\n  color: #0072C6!important;\n  background-color: #fff!important;\n  margin-top: -50px;\n  width: 60vw;\n  height: 48px;\n  font-size: 2.2em;\n  border: none;\n}\n.selecttime-btn, .selecttime-btn[disabled] {\n  color: #fff!important;\n  background-color: #0072C6!important;\n  margin-bottom: 20px;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.bookappointment-btn {\n  color: #fff!important;\n  background-color: #0072C6!important;\n  width: 300px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.fetchtime-btn {\n  color: #fff!important;\n  background-color: #228B22!important;\n  margin-bottom: 20px;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.showlist-btn {\n  color: #0072C6!important;\n  background-color: #fff!important;\n  border: none;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}"},{"name":"cssJobMap","type":"style","item-type":"css","_auto_id_":"88ae5d6a-aaa6-4c16-b356-1626b792df43","content":"#map {\n  position: absolute;\n  left: 0;\n  top: 0;\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n}\n\n#JobMap section#scrollable {\n    position: absolute;\n    top: 520px;\n    width: 100vw;\n    /* height: 32vh; */\n    padding: 0;\n}\n\n#JobMap section#staticMap {\n    position: absolute;\n    left: 5vw;\n    top: 100px;\n    height: 400px;\n    width: 90vw;\n    padding: 0;\n}\n\n#JobMap section#scrollable div.scrollable {\n  margin: 0;\n  overflow-y: auto !important;\n}"},{"name":"cssFontAwesomeOverrides","type":"style","item-type":"css","_auto_id_":"f39b89d9-ce3e-4e83-8438-de32bc671814","content":"/* Vehicle Checks */\n.supervisor:before { content: \"\\f095\"; font-size: 30pt; }\n\n/* Jobs List */\n.high:before { content: \"\\f071\"; font-size: 20pt; }\n.med:before { content: \"\\f071\"; font-size: 20pt; }\n.low:before { content: \"\\f071\"; font-size: 20pt; }\n\n/* Tenant Details */\n.home:before { content: \"\\f095\"; font-size: 30pt; }\n.mobile:before { content: \"\\f10b\"; font-size: 32pt; }\n.booked:before { content: \"\\f271\"; font-size: 30pt; }\n\n/* Warnings */\n.checked-warning:before { content: \"\\f046\"; font-size: 20pt; }\n.unchecked-warning:before { content: \"\\f096\"; font-size: 20pt; }\n.all-checked-warning:before { content: \"\\f046\"; font-size: 20pt; }\n.all-unchecked-warning:before { content: \"\\f096\"; font-size: 20pt; }\n\n/* Start Travel */\n.getmethere:before { content: \"\\f018\"; font-size: 50pt; }\n.started-ticked:before { content: \"\\f087\"; font-size: 35pt; }\n\n/* Arrived On Site */\n.checked-lone:before { content: \"\\f046\"; font-size: 15pt; }\n.unchecked-lone:before { content: \"\\f096\"; font-size: 15pt; }\n.arrived-ticked:before { content: \"\\f087\"; font-size: 35pt; }\n\n/* Risk Assessment */\n.racomplete:before { content: \"\\f087\"; font-size: 35pt; }\n.raabandon:before { content: \"\\f05e\"; font-size: 35pt; }\n\n/* Start Job */\n.startjob:before { content: \"\\f0ad\"; font-size: 35pt; }\n.complete:before { content: \"\\f087\"; font-size: 35pt; }\n\n/* SOR Code Selection */\n.required-sorcode:before { content: \"\\f071\"; font-size: 20pt; }\n.added-sorcode:before { content: \"\\f087\"; font-size: 20pt; }\n\n/* Purchase Order */\n.purchase-order-icon:before { content: \"\\f07a\"; font-size: 50pt; }"},{"name":"cssSpinner","type":"style","item-type":"css","_auto_id_":"f62a14c1-3b98-474c-b54b-a0e901140b25","content":"load-spinner {\n    display:block;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.7);\n    z-index:10000;\n    display: none;\n}\n\nload-spinner.active {\n  display: block !important;\n}\n\nload-spinner .spinner {\n    height:40px;\n    width:40px;\n    top:20%;\n    margin:auto;\n    animation: rotation 1.2s infinite linear;\n    border-left:6px solid rgba(255,255,255,.8);\n    border-right:6px solid rgba(255,255,255,.8);\n    border-bottom:6px solid rgba(255,255,255,.8);\n    border-top:6px solid rgba(220,79,16,.8);\n    border-radius:100%;\n}  \n\nload-spinner .header {\n    height:25%;\n}\n\nload-spinner .loading-message {\n    padding:10px 20px;\n    text-align:center;\n    font-size:20px;\n    color:white;\n}\n\n@keyframes rotation {\n    from {transform: rotate(0deg);}\n    to {transform: rotate(359deg);}\n}"},{"name":"cssContextMenu","type":"style","item-type":"css","_auto_id_":"3f90f652-ba18-4bdd-9350-6afd0b69111f","content":".context-menu {\n  display:inline-block;\n  width: 90vw;\n  padding-top: 2vh;\n}\n\n#title_bar.navbar-default {\n  background-color: #fff !important; \n  background: url('user-assets/logo.png') no-repeat;\n  max-height: 80px!important;\n  background-size: contain;\n  flex: inherit;\n  border-bottom: 1px solid #dc4f10;\n}\n\n#title_bar.navbar-default md-content[item-type=\"html\"] {\n  width:100%;\n  text-indent:60px;\n  font-size:16pt;\n  margin-top:8pt;\n  color: #dc4f10;  \n}\n\n.header-button {\n  color:#dc4f10 !important;\n  background-color: #fff !important;\n  margin-right:6px;\n  margin-top:6px;\n  border: none;\n}\n.header-button .fa {\n  font-size: 32px !important;\n}\n\n.title {\n  line-height: 16px;\n  padding-left: 12px;\n}\n\n.contextMenuBG {\n    position: absolute;\n    width: 100vw;\n    height: 100vh;\n    top: 0;\n    left: 0;\n    background-color: rgba(0, 0, 0, 0.3);\n    z-index: 999\n}\ncontext-menu .contextMenuBG .contextMenu {\n    position: absolute;\n    width: 60vw;\n    height: 100vh;\n    top: 0;\n    right: -60vw;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 1000;\n    -webkit-animation: slide .5s forwards\n}\n@-webkit-keyframes slide {\n    100% {\n        right: 0\n    }\n}\n@keyframes slide {\n    100% {\n        right: 0\n    }\n}\ncontext-menu .contextMenuBG .contextMenu div {\n    margin: 0;\n    border-bottom: 1px solid white\n}\ncontext-menu .contextMenuBG .contextMenu div a,\ncontext-menu .contextMenuBG .contextMenu div a:hover {\n    color: white !important;\n    border: none;\n    background-color: transparent !important;\n    width: 100%;\n    padding: 3vh 0;\n    text-align: left;\n    margin-left: 3vw\n}\ncontext-menu .contextMenuBG .contextMenu div a span span:before {\n    margin-right: 3vw;\n    width: 8vw;\n    display: inline-block;\n    text-align: center\n}\ncontext-menu[popup=\"true\"] .contextMenuBG {\n    background-color: transparent\n}\ncontext-menu[popup=\"true\"] .contextMenu {\n    position: absolute;\n    z-index: 1000;\n    background-color: white;\n    border: 1px solid #d3d3d3;\n    height: initial;\n    -webkit-animation: none\n}\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div {\n    border-top: 1px solid #d3d3d3\n}\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div:first-child {\n    border-top: none\n}\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div a,\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div a:hover {\n    color: black !important;\n    margin-left: 0;\n    text-align: center;\n    padding: 2vh 0\n}\n\ncontext-menu .btn .fa { padding-right: 1vw; }\n\n#btnLogout  {\n  position: fixed;\n  bottom: 0;\n  border-top: 1px solid #fff;\n  margin: 0;\n  padding-left: 0px;\n  border-bottom: none!important;\n}\n\n#btnLogout > .btn .fa {\n  margin-left: 3vw!important;\n}"},{"name":"cssPhotoManager","type":"style","item-type":"css","_auto_id_":"893f58d4-9c99-4016-9955-077004768da5","content":"#photoArea {\n    margin: 8px 4px;\n    min-height: 20px;\n}\n.photo-row {\n  min-height: 120px;\n  border: 1px solid silver;\n  margin-top: 6px;\n  border-radius:12px;\n  overflow:hidden\n}\n.photo-container {\n  box-sizing:border-box;\n  float:left;\n  width: 25%;\n}\n.photo-container > img {\n    width: 100%;\n    height: auto;\n}\n.photo-info-container {\n  box-sizing:border-box;\n  margin-left:25%;\n  display: block;\n}\n.photo-info-banner {\n  background-color:#dc4f10;\n  min-height:10%;\n  width:100%;\n  text-align:right;\n}\n.photo-info-banner span {\n  position:relative;\n  display:inline-block;\n  color:white;\n  top:25px;\n  height:40px; \n  font-size:0.8em;\n  width:66px;\n  text-align:center;\n}\n.photo-info-banner span:before {\n  font-family: FontAwesome;\n  font-size:2.2em;\n  position:absolute;\n  white-space: pre;\n  top:0px;\n  left: 33px;\n  transform: translate(-12px, -27px);\n}\n.description-option:before {\n  content:\"\\f044\";\n}\n.delete-option:before {\n  content:\"\\f057\";\n}\n.photo-info {\n  float:none;\n  padding:2px;\n  font-size:0.9em;\n}\n.photo-info span {\n  font-size:0.75em;\n  font-weight:700;\n  padding-right:4px;\n}\n.photo-review-container {\n  width:98vw;\n}\n.photo-review {\n  max-width:90%;\n  border:none;\n  height:auto;\n}\n\n.take-photo-div {\n  text-align: center;\n  font-size: 50pt;\n  color: #0072C6!important;\n}\n.take-photo-fa:before {\n  content: \"\\f030\"; \n}"},{"name":"cssLogin","type":"style","item-type":"css","_auto_id_":"0ef0b09f-6573-48b9-845e-a168f7ed68d9","content":"#Login .credentials-input { text-align: center; }\n#Login .form-input-error { color: transparent; }\n#Login .form-control { border: none; border-bottom: 1px solid black; text-align: center; }\n#Login .flexbox-container .navbar-default { background-color: #fff; }\n\n.app-title {\n  padding:8px;\n  text-align:center;\n  width:100%;\n}\n.version {\n  display:block;\n  font-size:0.7em;\n  color:grey;\n}\n.header-image {\n  padding-top: 10vh;\n  padding-bottom: 10vh;\n  text-align: center;\n  padding-right: 6vw;\n}\n\na#btnSettings {\n    color: #dc4f10;\n    border: none;\n}\na#btnSettings span.fa.fa-gear {\n    font-size: 2.0em;\n}"},{"name":"cssVehicleChecks","type":"style","item-type":"css","_auto_id_":"026527ec-bbf7-48e9-aa56-829e91970f6b","content":"#VehicleChecks .has-success .checkbox, .has-success .checkbox-inline, .has-success .control-label, .has-success .help-block, .has-success .radio, .has-success .radio-inline, .has-success.checkbox label, .has-success.checkbox-inline label, .has-success.radio label, .has-success.radio-inline label {\n    color: #000000;\n}\n#VehicleChecks .form-input-error { color: transparent; }\n\n.supervisor { color: #ff0000; padding-top: 3vh; }"},{"name":"cssJobsList","type":"style","item-type":"css","_auto_id_":"36631ecc-e771-4272-b824-b3f90e73da38","content":".info { display: inline-block; width: 100%; padding-top: 30px; }\n.details { display: inline-block; width: 100%; }\n.floatright { display: inline-block; float: right; }\n.description { display: inline-block; font-weight: bold; max-width: 75%; }\n.address { display: inline-block; max-width: 75%; }\n\n#list_joblistfull .list-group-item {\n    padding: 20px 0px;\n    margin-bottom: 10px;\n    border: none;\n    border-radius: 20px;\n    background-color: #f1f1f1;\n}\n\n#list_joblistshort .list-group-item {\n    padding: 20px 0px;\n    margin-bottom: 10px;\n    border: none;\n    border-radius: 20px;\n    background-color: #f1f1f1;\n}\n\n#JobList .content-block {\n    margin-bottom: 0px;\n}\n\n.high {\n  color: #ff0000;\n  display: inline-block;\n  float: right;\n}\n.med {\n  color: #FFC200;\n  display: inline-block;\n  float: right;\n}\n.low {\n  color: #008000;\n  display: inline-block;\n  float: right;\n}\n\n.retry-job {\n  color:#0072C6;\n  text-align:center;\n  font-size:30pt;\n  width:100%;\n}\n\n.joblist-container {\n    display: flex;\n    margin: 0px 0px 0px 5px;\n    position: relative;\n}\n\n.joblist-column-1 {\n    flex: 0 0 35px;    \n}\n\n.joblist-column-2 {\n    flex: 2;\n    margin-left: 12px;\n}\n.joblist-column-3 {\n    display: flex;\n    flex: 0 0 20px;\n    align-items: center;\n    justify-content: flex-end;\n\n}\n.joblist-column-3:after {\n    font-family: 'FontAwesome';\n    content: \"\\f105\";\n    margin-right: 10px;\n    font-size: 20px;\n    float:right;\n    color:#333;    \n}\n\n.joblist-status {\n    border-right: 3px solid #8BC34A;\n    padding: 0px 10px 5px 5px;\n}\n.joblist-contract {\n    font-size: 14px;\n}\n\n.joblist-priority, .joblist-address {\n    font-size: 12px;\n    font-weight: 200;\n}\n\n.joblist-slot {\n  font-size: 12px;\n  text-align: center;\n}\n\n.joblist-day {\n  font-size: 16px;\n  text-align: center;\n}\n\n.joblist-month {\n  font-size: 14px;\n  text-transform: uppercase;\n  text-align: center;\n}\n\n.hide-job {\n  display: none;\n}"},{"name":"cssTenantDetails","type":"style","item-type":"css","_auto_id_":"0a4d9761-3849-4051-865a-dafbb6fe662e","content":"#TenantDetails .form-input-error { color: transparent; }\n#TenantDetails .form-group.item-date .input-group, .form-group.item-time .input-group {padding-top: 4vh;}\n#TenantDetails .form-control {text-align: left;}\n#TenantDetails .form-group.item-date .form-control, .form-group.item-time .form-control {border: none;}\n#TenantDetails .checkbox-element { margin: 0px 0 0;  padding: 5px 13px; }\n#TenantDetails .md-checkbox-container { text-align: left; }\n#TenantDetails .md-checkbox { padding: 0px 0px 0px 0px; }\n#TenantDetails .vehiclecheck-reg { padding-top: 5vh; }\n.inlineblock-default { display:inline-block;width: 100%; }\n\n#TenantDetails .container, .container-fluid { \n  padding-right: 0px; \n  padding-left: 0px; \n  margin-right: 0px; \n  margin-left: 0px; \n}\n\n.home {\n  color: #0072C6;\n  display: inline-block;\n  float: left;\n  margin-left: 30px;\n}\n.mobile {\n  color: #0072C6;\n  display: inline-block;\n  margin: 0 auto;\n}\n.booked {\n  color: #0072C6;\n  display: inline-block;\n  float: right;\n  margin-right: 30px;\n}\n\n.no-home {\n  color: grey!important;\n}\n.no-mobile {\n  color: grey!important;\n}\n.no-booked {\n  color: grey!important;\n}\n\n.home-text {\n  color: #0072C6;\n  display: inline-block;\n  float: left;\n  margin-left: 6px;\n}\n.mobile-text {\n  color: #0072C6;\n  display: inline-block;\n  margin: 0px auto;\n  margin-right: 16px;\n}\n.booked-text {\n  color: #0072C6;\n  display: inline-block;\n  float: right;\n  margin-right: 16px;\n}\n\n.tenant-contacts {\n  font-weight:bold;\n  margin-bottom: 3vh;\n  margin-top:1vh;\n  text-align: left;\n}"},{"name":"cssJobAccessDetails","type":"style","item-type":"css","_auto_id_":"3b8e66f6-914c-4a11-93c9-7591c06de780","content":"#order_summary textarea.form-control { height: 20vh; }"},{"name":"cssJobHistory","type":"style","item-type":"css","_auto_id_":"0ccb73d0-6808-4fdb-80ec-8a5b6cd15de9","content":"#list_jobhistory .list-group-item {\n    padding: 20px 0px;\n    margin-bottom: 10px;\n    border: none;\n    border-radius: 20px;\n    background-color: #f1f1f1;\n}\n\n#JobHistory .content-block {\n    margin-bottom: 0px;\n}\n\n.left-list-header {\n  font-weight: bold;\n  display: inline-block;\n  float: left;\n}\n.center-list-header {\n  font-weight: bold;\n  display: inline-block;\n  margin: 0px auto;\n}\n.right-list-header {\n  font-weight: bold;\n  display: inline-block;\n  float: right;\n}"},{"name":"cssWarnings","type":"style","item-type":"css","_auto_id_":"33373965-0602-4a23-a607-1e96aa12a35b","content":"#Warnings .list-group-item {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#Warnings .list-group-item:first-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#Warnings .list-group-item:last-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n\n.warning-short {\n  display:inline-block;\n  font-weight:bold;\n  margin-bottom: 20px;\n  margin-left: 10px;\n}\n\n.checked-warning {\n  color: #228B22;\n  display: inline-block;\n  float: right;\n}\n.unchecked-warning {\n  color: #ff0000;\n  display: inline-block;\n  float: right;\n}\n\n.all-checked-warning {\n  color: #228B22;\n  display: inline-block;\n  float: right;\n}\n.all-unchecked-warning {\n  color: #ff0000;\n  display: inline-block;\n  float: right;\n}\n\n.property-icon { \n  color: #000000;\n  display: inline-block;\n  float: left; \n  font-size: 20pt;\n} \n.two-person-icon { \n  color: #FF0000; \n  display: inline-block; \n  float: left;\n  font-size: 20pt;\n}\n.disability-icon { \n  color: #0072C6;\n  display: inline-block;\n  float: left; \n  font-size: 20pt;\n}\n.vulnerability-icon { \n  color: #0072C6;\n  display: inline-block;\n  float: left; \n  font-size: 20pt;\n}\n.asbestos-icon { \n  color: #FFC200; \n  display: inline-block; \n  float: left; \n  font-size: 20pt;\n}\n.other-icon { \n  color: #228B22; \n  display: inline-block; \n  float: left; \n  font-size: 20pt;\n}"},{"name":"cssStartTravel","type":"style","item-type":"css","_auto_id_":"40b76148-acce-4175-9793-f44167f33f9e","content":".started-ticked { color: #228B22; }\n.starting { color: #228B22; text-align: center; }\n.getmethere {  color: #0072C6; margin-bottom: 0vh; }\n.buttonDisabled:hover{ color: #0072C6; background-color: #fff; text-decoration: none; }"},{"name":"cssArrivedOnSite","type":"style","item-type":"css","_auto_id_":"3d297281-85b5-4759-aa26-61471591386f","content":".arrived-ticked { color: #228B22; }\n.arriving { color: #228B22; text-align: center; }\n\n.lone-device-warning {\n  display: inline-block;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n  width: 325px;\n  line-height: 71px;\n  height: 76px;\n}\n\n.checked-lone {\n  color: #228B22;\n  display: inline-block;\n}\n.unchecked-lone {\n  color: #ff0000;\n  display: inline-block;\n}"},{"name":"cssRiskAssessment","type":"style","item-type":"css","_auto_id_":"c84c8593-4669-4819-80e5-3c8f8bde4b63","content":".racomplete { color: #228B22; padding-top: 3vh; }\n.raabandon { color: #ff0000; padding-top: 3vh; }"},{"name":"cssStartingWork","type":"style","item-type":"css","_auto_id_":"e4c98bad-05ef-4f76-b0d0-eab76189b3ce","content":".startjob { color: #0072C6; }\n\n.job-info-hide { display: none; }\n.job-info {\n  display: inline-block;\n  width: 100%;\n  margin-bottom: 10px;\n  padding: 19px;\n  background-color: lightgray;\n}\n\n.job-info-header {\n  display:inline-block;\n  font-weight:bold;\n  margin-bottom: 20px;\n}"},{"name":"cssFollowOnAppointment","type":"style","item-type":"css","_auto_id_":"7ee46c2c-1365-4269-a911-273c5952cf4f","content":".timeslot-item-selected {\n  border: 1px solid #dc4f10;\n  font-weight: bold;\n  border-radius: 30px;\n  margin-left: -10px;\n  padding: 8px;\n}\n\n#FollowOnContinued .list-group-item { padding: 20px 20px; margin-bottom: 0px; border-bottom: 1px solid #ddd!important; border: none; }"},{"name":"cssSORLocationSelect","type":"style","item-type":"css","_auto_id_":"fba9e7d3-1795-4f09-93b6-9bfe4dbdd44a","content":"#SORLocationSelect  .list-group-item {\n  padding: 10px 10px;\n  margin-bottom: 0px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n}\n\n#SORLocationSelect .list-item-container {\n  text-align: center;\n  font-size: 1.4em;\n  display: inline-block;\n  width: 100%;\n}\n\n#SORLocationSelect .list-location {\n  display: inline-block;\n}\n\n#SORLocationSelect .content-block {\n  margin-bottom: 0px;\n}\n\n#SORLocationSelect .list-group {\n  margin-bottom: 0px!important;\n}\n\n.required-sorcode { \n  color: #FFC200;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}\n.added-sorcode { \n  color: #008000;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}\n\n.codes-icon {\n  text-align: center;\n  font-size: 30pt;\n  margin-bottom: -10px;\n  margin-top: -10px;\n}\n\n.codes-icon-header {\n  text-align: center;\n  margin-bottom: 20px;\n}"},{"name":"cssSORCodes","type":"style","item-type":"css","_auto_id_":"c83387d7-c4b6-41b7-939a-2a96c371a507","content":".sor-schedules-panel {\n  width: 100%;\n  display: inline-block;\n  min-height: 30px;\n  padding: 10px 10px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n  background: linear-gradient( to right, #dc4f10 0%, #dc4f10 50%, #fff 50%, #fff 100% );\n}\n\n.sor-schedules-schedules {\n  color: #fff;\n  width: 50%;\n  display: inline-block;\n  text-align: center;\n}\n.sor-schedules-search {\n  color: #dc4f10;\n  width: 40%;\n  display: inline-block;\n  text-align: center;\n}\n\n.sor-search-panel {\n  width: 100%;\n  display: inline-block;\n  min-height: 30px;\n  padding: 10px 10px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n  background: linear-gradient( to right, #fff 0%, #fff 50%, #dc4f10 50%, #dc4f10 100% );\n}\n\n.sor-search-schedules {\n  color: #dc4f10;\n  width: 50%;\n  display: inline-block;\n  text-align: center;\n}\n.sor-search-search {\n  color: #fff;\n  width: 40%;\n  display: inline-block;\n  text-align: center;\n}\n\n#list_sorsummary .list-group-item {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_sorsummary .list-group-item:first-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_sorsummary .list-group-item:last-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n\n#list_sorcodes .list-group-item {\n  padding: 10px 20px 20px 20px;\n  margin-bottom: 0px;\n  border-bottom: 1px solid #dc4f10!important;\n  height: 100px;\n  border: none;\n}\n\n#list_sorsummary .content-block {\n  margin-bottom: 0px;\n}\n\n#list_sorcodes { \n  margin-top: 20px;\n}\n\n#list_sorsummary .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n  font-size: 20pt;\n  border: none;\n}\n#list_sorsummary .btn-default {\n  border: none;\n}\n\n#SORCodes .flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal) {\n  background-color: #fff;\n  border: 0;\n}\n\n.sor-value {\n  line-height: 55px;\n}\n\n.sor-list-header {\n  font-weight: bold;\n  font-size: 12pt;\n  text-align: center;\n}\n\n.fa-minus-circle:before {\n  color: #0072C6;\n  font-size: 20pt;\n}\n.fa-plus-circle:before {\n  color: #0072C6;\n  font-size: 20pt;\n}\n\n.sor-header { display:inline-block; font-weight:bold; margin-bottom: 20px; padding: 5px; font-size: 14pt; }\n.estimated { color: #0072C6; display: inline-block; float: right; margin-left: 6px; padding: 5px; }\n.qty-text { color: #0072C6; display: inline-block; float: left; margin-left: 40px; }\n.remaining-text { color: #0072C6; display: inline-block; float: right; margin-right: 40px; }\n.minus { color: #0072C6; display: inline-block; }\n.plus { color: #0072C6; display: inline-block; }\n.plus:before { content: \"\\f196\"; font-size: 20pt; }\n.minus:before { content: \"\\f147\"; font-size: 20pt; }\n.qty { color: #0072C6; display: inline-block; width: 30px; text-align: center; font-size: 20pt;}\n.remaining { color: #0072C6;display: inline-block;width: 30px;font-size: 20pt; }\n.qty-block { display: inline-block;float: left;margin-left: 31px; }\n.remaining-block { display: inline-block;float: right;margin-right:  38px; }\n.inlineblock-toggle { text-align:center;width:100%; }\n.inlineblock-outer { display:inline-block;width:100%; }\n.not-available { color: silver!important; }\n\n#list_sorcodes .pagination>.disabled>a, \n.pagination>.disabled>a:focus, \n.pagination>.disabled>a:hover, \n.pagination>.disabled>span, \n.pagination>.disabled>span:focus, \n.pagination>.disabled>span:hover {\n    color: #D3D3D3;\n    background-color: #fff;\n    border-color: #dc4f10;\n}\n\n#list_sorcodes .pagination>.active>a, \n.pagination>.active>a:focus, \n.pagination>.active>a:hover, \n.pagination>.active>span, \n.pagination>.active>span:focus, \n.pagination>.active>span:hover {\n    color: #fff;\n    background-color: #dc4f10;\n    border-color: #dc4f10;\n}\n\n#list_sorcodes .pagination>li>a, \n.pagination>li>span {\n    color: #dc4f10;\n    border: 1px solid #dc4f10;\n}"},{"name":"cssVanLocationSelect","type":"style","item-type":"css","_auto_id_":"ef5f7d69-1610-4fad-96d2-af434aaf4bcb","content":"#VanLocationSelect  .list-group-item {\n  padding: 10px 10px;\n  margin-bottom: 0px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n}\n\n#VanLocationSelect .list-item-container {\n  text-align: center;\n  font-size: 1.4em;\n  display: inline-block;\n  width: 100%;\n}\n\n#VanLocationSelect .list-location {\n  display: inline-block;\n}\n\n#VanLocationSelect .content-block {\n  margin-bottom: 0px;\n}\n\n#VanLocationSelect .list-group {\n  margin-bottom: 0px!important;\n}\n\n.required-sorcode { \n  color: #FFC200;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}\n.added-sorcode { \n  color: #008000;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}"},{"name":"cssVanStock","type":"style","item-type":"css","_auto_id_":"af8bcdb7-acf8-4628-b7fd-32aae30e437f","content":"#list_vanstocksummary .list-group-item {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_vanstocksummary .list-group-item:first-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_vanstocksummary .list-group-item:last-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n\n#list_vanstock .list-group-item {\n  padding: 10px 20px 20px 20px;\n  margin-bottom: 0px;\n  border-bottom: 1px solid #dc4f10!important;\n  height: 100px;\n  border: none;\n}\n\n#list_vanstock { \n  margin-top: 20px;\n}\n\n#list_vanstocksummary .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n  font-size: 20pt;\n  border: none;\n}\n\n#list_vanstocksummary .content-block {\n  margin-bottom: 0px;\n}\n\n#VanStockCodes .btn-default {\n  border: none;\n}\n\n#VanStockCodes .flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal) {\n  background-color: #fff;\n  border: 0;\n}\n\n#list_vanstock .pagination>.disabled>a, \n.pagination>.disabled>a:focus, \n.pagination>.disabled>a:hover, \n.pagination>.disabled>span, \n.pagination>.disabled>span:focus, \n.pagination>.disabled>span:hover {\n    color: #D3D3D3;\n    background-color: #fff;\n    border-color: #dc4f10;\n}\n\n#list_vanstock .pagination>.active>a, \n.pagination>.active>a:focus, \n.pagination>.active>a:hover, \n.pagination>.active>span, \n.pagination>.active>span:focus, \n.pagination>.active>span:hover {\n    color: #fff;\n    background-color: #dc4f10;\n    border-color: #dc4f10;\n}\n\n#list_vanstock .pagination>li>a, \n.pagination>li>span {\n    color: #dc4f10;\n    border: 1px solid #dc4f10;\n}"},{"name":"cssOTCLocationSelect","type":"style","item-type":"css","_auto_id_":"b884120e-b68f-4c23-a065-2da15528d344","content":"#OTCLocationSelect  .list-group-item {\n  padding: 10px 10px;\n  margin-bottom: 0px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n}\n\n#OTCLocationSelect .list-item-container {\n  text-align: center;\n  font-size: 1.4em;\n  display: inline-block;\n  width: 100%;\n}\n\n#OTCLocationSelect .list-location {\n  display: inline-block;\n}\n\n#OTCLocationSelect .content-block {\n  margin-bottom: 0px;\n}\n\n#OTCLocationSelect .list-group {\n  margin-bottom: 0px!important;\n}\n\n.hide-location {\n  display: none;\n}"},{"name":"cssOTCCodes","type":"style","item-type":"css","_auto_id_":"c5640fac-7a9d-44d2-96ce-fa826f9e9929","content":"#list_otcstocksummary .list-group-item {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#list_otcstocksummary .list-group-item:first-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#list_otcstocksummary .list-group-item:last-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n\n#list_otcstock .list-group-item {\n  padding: 10px 20px 20px 20px;\n  margin-bottom: 0px;\n  border-bottom: 1px solid #dc4f10!important;\n  border: none;\n}\n#list_otcstock { \n  margin-top: 20px;\n}\n\n#list_otcstocksummary .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n  font-size: 20pt;\n  border: none;\n}\n#OTCCodes .btn-default {\n  border: none;\n}\n\n#OTCCodes .flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal) {\n  background-color: #fff;\n  border: 0;\n}\n\n\n#list_otcstock .pagination>.disabled>a, \n.pagination>.disabled>a:focus, \n.pagination>.disabled>a:hover, \n.pagination>.disabled>span, \n.pagination>.disabled>span:focus, \n.pagination>.disabled>span:hover {\n    color: #D3D3D3;\n    background-color: #fff;\n    border-color: #dc4f10;\n}\n\n#list_otcstock .pagination>.active>a, \n.pagination>.active>a:focus, \n.pagination>.active>a:hover, \n.pagination>.active>span, \n.pagination>.active>span:focus, \n.pagination>.active>span:hover {\n    color: #fff;\n    background-color: #dc4f10;\n    border-color: #dc4f10;\n}\n\n#list_otcstock .pagination>li>a, \n.pagination>li>span {\n    color: #dc4f10;\n    border: 1px solid #dc4f10;\n}"},{"name":"cssPauseTask","type":"style","item-type":"css","_auto_id_":"cbf2768c-ff1a-4d4d-979d-2267fe60c888","content":".pauseicon { \n  text-align: center; \n  color: #dc4f10; \n  font-size: 60pt;\n}\n.pauseheader { \n  text-align: center; \n  color: #dc4f10; \n}"},{"name":"cssPurchaseOrder","type":"style","item-type":"css","_auto_id_":"d551f171-e48a-4762-9b1f-0bd7a341d910","content":".purchase-order {\n  text-align: center;\n}\n\n.purchase-order-icon { \n  color: #0072C6; \n}\n\n.purchase-order-header { \n  text-align: center; \n  color: #0072C6; \n  margin-bottom: 40px;\n}\n\n.purchases-area {\n  margin-top: 15px;\n  margin-bottom: 15px;\n}\n\n#OTCPurchases .navbar-default {\n  background-color: #FFF!important;\n}"},{"name":"image_asset_mainlogo","type":"style","item-type":"image-asset","_auto_id_":"72fb5ccd-201e-4f48-9036-4f82a7621098","fileName":"accuserv-logo.png"},{"name":"image_asset_thumblogo","type":"style","item-type":"image-asset","_auto_id_":"b4be5ea9-1bb3-4bdc-90dc-7df4bf8332a4","fileName":"logo.png"},{"name":"tmFetchMapData","type":"scripting","item-type":"timer","_auto_id_":"ee877bc9-27e3-4b55-b581-4f39c1db1a5c","timer-type":"delay","time":500,"actions":[{"event":"click","type":"call-api","data":{"sync":true,"name":"GoogleMapsAPI","operation":"initMap"},"_auto_id_":"e553bbe2-18a7-439d-b6dd-acc1513e286f","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"debugger;\nfunction initMap(positions) {\n  var currentLocation = {lat: positions[0].lat, lng: positions[0].lng};\n  \n  var map = new google.maps.Map(document.getElementById('map'), {\n    zoom: 8,\n    center: currentLocation\n  });\n  \n  var infoWindow = new google.maps.InfoWindow({map: map});\n  \n  if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(function(position) {\n      var pos = {\n        lat: position.coords.latitude,\n        lng: position.coords.longitude\n      };\n\n      infoWindow.setPosition(pos);\n      infoWindow.setContent('Location found.');\n      map.setCenter(pos);\n    }, function() {\n      handleLocationError(true, infoWindow, map.getCenter());\n    });\n  } else {\n    // Browser doesn't support Geolocation\n    handleLocationError(false, infoWindow, map.getCenter());\n  }\n  \n  var marker = new google.maps.Marker({\n    icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',\n    position: currentLocation,\n    map: map\n  });\n  \n  for(var i in positions) {\n    var marker = new google.maps.Marker({\n      position: positions[i],\n      map: map\n    });\n  }\n}\n\nfunction handleLocationError(browserHasGeolocation, infoWindow, pos) {\n  infoWindow.setPosition(pos);\n  infoWindow.setContent(browserHasGeolocation ?\n                        'Error: The Geolocation service failed.' :\n                        'Error: Your browser doesn\\'t support geolocation.');\n}\n\nvar mapLocations = cti.store.jobs.mapLocations;\n\nif(mapLocations.length > 0) {\n  initMap(mapLocations);\n}\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"474c9490-f22c-470b-8d78-35429dba4d22"},{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"api_failure_error","title":"Error Connecting to Google","text":"No connection could be made to the Google API to download the map information. Please check your connection and try again, alternatively please contact support if the issue continues."},"_auto_id_":"21133d12-a28f-4233-8251-d72ef9825209"},{"event":"success","type":"stop-timer","data":{"name":"tmFetchMapData"},"_auto_id_":"fa2a45aa-321e-4315-af0f-98b48ce88e85"},{"event":"fail","type":"stop-timer","data":{"name":"tmFetchMapData"},"_auto_id_":"501887ae-b35c-4505-b96e-9258c79fb742"}]}]},{"name":"fnClearPhotos","type":"scripting","item-type":"function","_auto_id_":"d723d798-dbbb-4108-a2b7-fb80781b03ff","sync":true,"params":[{"name":"photosObject","description":"Container object with photo details"},{"name":"online","description":"Boolean to see if we're resubmitting a photo that failed or not"}],"content":"if(online) {\n  var photos = photosObject || cti.store.jobs.selectedJob.photos || [];\n  cti.store.jobs.photoAssociatedJobPhotos = photos;\n} else {\n  var photos = photosObject || cti.store.jobs.failedPhotosToSend.photos || [];\n  cti.store.jobs.photoAssociatedJobPhotos = photos;\n}\n\nvar l = photos.length;\nvar instance = this;\nvar thisPhoto = undefined;\nvar failCount = 0;\n\nif (l == 0) { \n  completeEvent(); \n  return true; \n}\n\n//window.appManager.logEvent('Deleting photos', 'info');\n\nif (!window.cordova) {\n  for (var i = l; i>=0; i--) {\n    photos.splice(i, 1);\n  }\n  completeEvent(); \n  return true; \n}\n\n// Start at the last photo and work our way back\nvar photoIndex = l;\n  \nfunction completeEvent() {\n  delete cti.store.jobs.photoAssociatedJobPhotos;\n  \n  if (failCount > 0) { \n    if (typeof this.$fail === \"function\") { this.$fail(); } else { return false; }\n  } else { \n    if (typeof this.$success === \"function\") { this.$success(); } else { return true; }\n  }\n}\n  \nfunction processNextPhoto() {\n  var requireDelete = false;\n  photoIndex--;\n  if (photoIndex >= 0) {\n    var startIndex = photoIndex;\n    for (var i = startIndex; i >= 0; i--) {\n      photoIndex = i;\n      // TODO Only delete if uploaded??\n      requireDelete = true;\n      break;\n    }\n  }\n  if (requireDelete) {\n    window.resolveLocalFileSystemURI(cti.store.jobs.photoAssociatedJobPhotos[photoIndex].src, function(entry) {\n      entry.remove(function(){\n        photos.splice(photoIndex, 1);\n        processNextPhoto();\n      },function(e1){\n        failCount++;\n        window.appManager.logError('Unable to remove file when deleting photo', e1);\n        processNextPhoto();\n      },function(){\n        window.appManager.logError('Unable to remove file when deleting photo');\n        photos.splice(photoIndex, 1);\n        processNextPhoto();\n      });\n    }, function(e2) {\n      failCount++;\n      window.appManager.logError('Unable to resolve file URL when deleting photo', e2);\n      // See if we can delete others\n      processNextPhoto();\n    });            \n  }\n  else {\n    // No more photos to be deleted, fire the completion event\n    completeEvent();\n  }\n}\n  \nwindow.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSys) { \n  instance.fileSys = fileSys;\n  // Start the process once we know we have the file system etc\n  processNextPhoto();\n}, function(e) {\n  failCount++;\n  //window.appManager.logError('Unable to retrieve file system for deleting photos', e);\n  completeEvent();\n});"},{"name":"fnDeleteSelectedPhoto","type":"scripting","item-type":"function","_auto_id_":"43b71e21-b797-4dde-8a9c-5e5af226b427","sync":true,"params":[],"content":"// Delete the currently selected photo - ie the one we are viewing in the PhotoDetail page\n// Find it's location in the source array\nvar index = undefined;\nfor (var k in cti.store.variables.selectedPhotoList) {\n  if (cti.store.variables.selectedPhotoList[k].id == cti.store.variables.selectedPhoto.id) {\n    index = k;\n    break;\n  }\n}\n          \nif (index === undefined) {\n  //console.log(\"debug:: Photo id \" + id + \" not found for deletion\");\n  return false;\n}\n\nif(!window.cordova) {\n  cti.fnCloseSpinner();\n  cti.store.variables.selectedPhotoList.splice(index, 1);\n  delete cti.store.variables.selectedPhoto;\n  \n  cti.store.variables.fromPhotoDetail = true;\n  cti.utils.updatePage();\n  \n  var lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastPhotoDetailPage));\n  cti.utils.callAction(\"go-to-page\", { \"name\" : lastPage });\n  delete cti.store.variables.lastPhotoDetailPage;\n} else {      \n  window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSys) { \n    window.resolveLocalFileSystemURL(cti.store.variables.selectedPhotoList[index].src, function(entry) {\n      entry.remove(function(){\n        cti.fnCloseSpinner();\n        cti.store.variables.selectedPhotoList.splice(index, 1);\n        delete cti.store.variables.selectedPhoto;\n        \n        cti.store.variables.fromPhotoDetail = true;\n        cti.utils.updatePage();\n\n        var lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastPhotoDetailPage));\n        cti.utils.callAction(\"go-to-page\", { \"name\" : lastPage });\n        delete cti.store.variables.lastPhotoDetailPage;\n      },function(e1){\n        cti.fnCloseSpinner();\n        window.appManager.logEvent(\"error:: Problem removing file - \" + JSON.stringify(e1), 'error');\n        cti.utils.callAction(\n          \"show-notification\", {\n            \"name\": \"api_failure_error\",\n            \"title\": \"Delete failed\",\n            \"text\": \"Problem removing file - \" + JSON.stringify(e1)\n          }\n        );\n      },function(){\n        cti.fnCloseSpinner();\n        window.appManager.logEvent(\"error:: Problem removing file - probably does not exist\", 'error');\n        cti.utils.callAction(\n          \"show-notification\", {\n            \"name\": \"api_failure_error\",\n            \"title\": \"Delete failed\",\n            \"text\": \"Problem removing file - file does not exist.\"\n          }\n        );\n      });\n    }, function(e2) {\n      cti.fnCloseSpinner();\n      window.appManager.logEvent(\"error:: Problem resolving file URL - \" + JSON.stringify(e2), 'error');\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\": \"api_failure_error\",\n          \"title\": \"Delete failed\",\n          \"text\": \"Problem resolving file URL - \" + JSON.stringify(e2)\n        }\n      );\n    });\n  }, function(e3) {\n    cti.fnCloseSpinner();\n    window.appManager.logEvent(\"error:: Problem getting file system - \" + JSON.stringify(e3), 'error');\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"api_failure_error\",\n        \"title\": \"Delete failed\",\n        \"text\": \"Problem getting file system - \" + JSON.stringify(e3)\n      }\n    );\n  });\n}"},{"name":"fnUploadPhotos","type":"scripting","item-type":"function","_auto_id_":"b5978ad0-2c97-4853-87e2-982ac1931e28","sync":false,"params":[{"name":"photosObject","description":"Container object with details of all of the photos for the job","required":true},{"name":"baseUrl","description":"API host address (same as used in API integration)","required":true},{"name":"callbackEvent","description":"Callback on success or fail - object takes  bool param"},{"name":"online","description":"Boolean to determine whether we are submitting a new photo or re-submitting a photo that failed"}],"content":"// fnUploadPhotos v 0.3.0.120\n\n/*\n\nSignatures upload\n\nLocations of signatures:\n\n// Operator sign off for job completion\ncti.store.pages.Completion.operativeSignature\n\n// Customer signature\ncti.store.pages.CustomerSignature.customerSignature\n\n// RA Sign-off\ncti.store.pages.RiskAssessment.confirmRASignature\n*/\n\nif(online) {\n  var photos = photosObject || cti.store.jobs.selectedJob.photos || [];\n  cti.store.jobs.photoAssociatedJob = cti.store.jobs.selectedJob;\n  cti.store.jobs.signaturesAssociatedJob = undefined;\n} else {\n  var photos = photosObject.photos || cti.store.jobs.failedPhotosToSend.photos || [];\n  cti.store.jobs.photoAssociatedJob = cti.store.jobs.failedPhotosToSend.job;\n  cti.store.jobs.signaturesAssociatedJob = cti.store.jobs.failedPhotosToSend.signatures;\n}\n\nvar thisPhoto = undefined;\nvar photosToBeUploaded = 0;\nvar failCount = 0;\nvar successCount = 0;\n\nvar signatures = [];\nvar thisSignature = undefined;\nvar signatureFailCount = 0;\nvar signatureSuccessCount = 0;\n\nvar instance = this;\nvar currentItemIndex = -1;\n\nfunction allCompleteEvent() {\n  delete cti.store.jobs.photoAssociatedJob;\n\n  // If any uploads fail, fire the fail event, else fire the success event\n  if (failCount > 0 || signatureFailCount > 0) { \n    if (callbackEvent !== undefined) { callbackEvent(false); } else if (typeof this.$fail === \"function\") { this.$fail(); } else { return false; }\n  } else { \n    if (callbackEvent !== undefined) { callbackEvent(true); } else if (typeof this.$success === \"function\") { this.$success(); } else { return true; }\n  }\n}\nfunction photosCompleteEvent() {\n  // Photos have completed - do the signatures\n  // Reset the index\n  currentItemIndex = -1;\n  // Assign what signatures we have. Object needs to look like this:\n  // { \"content\": \"--base64 image--\", \"category\": \"Signature\", \"description\": \"Type of signature\" }\n  \n  if(cti.store.jobs.signaturesAssociatedJob) {\n    for(var i in cti.store.jobs.signaturesAssociatedJob) {\n      signatures.push(cti.store.jobs.signaturesAssociatedJob[i]);\n    }\n  } else {\n    if (cti.store.pages.Completion !== undefined && cti.store.pages.Completion.operativeSignature !== undefined) {\n      signatures.push({ \n        \"docType\": \"Signature\", \n        \"docNote\": cti.store.pages.Completion.operativeComments || \"\", \n        \"description\":\"\", \n        \"docSubType\": \"Operative job completion\", \n        \"content\": cti.store.pages.Completion.operativeSignature \n      });\n    }\n    if (cti.store.pages.RiskAssessment !== undefined && cti.store.pages.RiskAssessment.confirmRASignature !== undefined) {\n      signatures.push({ \n        \"docType\": \"Signature\", \n        \"docNote\": \"\", \n        \"description\":\"\", \n        \"docSubType\": \"Risk assessment sign-off\", \n        \"content\": cti.store.pages.RiskAssessment.confirmRASignature \n      });\n    }\n    if (cti.store.pages.CustomerSignature !== undefined && cti.store.pages.CustomerSignature.customerSignature !== undefined) {\n      signatures.push({ \n        \"docType\": \"Signature\", \n        \"docNote\": \"\", \n        \"description\":\"\", \n        \"docSubType\": \"Tenant sign-off\", \n        \"content\": cti.store.pages.CustomerSignature.customerSignature \n      });\n    }\n  }\n  \n  if (signatures.length > 0) {\n    cti.store.variables.signatures = signatures;\n    processNextSignature();\n  }\n  else {\n    allCompleteEvent();\n  }\n}\n\nfunction signatureResultCallback(success) {\n  if (success) { \n    signatureSuccessCount++; \n    thisSignature.uploaded = true; \n  } else { \n    signatureFailCount++; \n  }\n  \n  //window.appManager.logEvent('Upload: ' + success, 'info');\n  processNextSignature();\n}\n\nfunction processNextSignature() {\n  var requireUpload = false;\n  currentItemIndex++;\n  if (currentItemIndex < signatures.length) {\n    var startIndex = currentItemIndex;\n    for (var i = startIndex; i < signatures.length; i++) {\n      currentItemIndex = i;\n      thisSignature = signatures[currentItemIndex];\n      // If the photo needs uploading, attempt to do so\n      if (!thisSignature.uploaded) {\n        requireUpload = true;\n        break;\n      }\n    }\n  }\n  if (requireUpload) {\n    // function (serverBaseUri, uploadEndpoint, associateEndpoint, sourceObject, jobObject, callback)\n    //window.appManager.logEvent('Found signature to upload at index ' + currentItemIndex, 'info');\n    window.appManager.uploadBase64AndAssociateWithJob(\n      baseUrl, \n      \"PostImage\", \n      \"AttachImageToJobEvent\", \n      thisSignature,\n      cti.store.jobs.photoAssociatedJob,\n      \"signature\",\n      signatureResultCallback\n    );\n  }\n  else {\n    // No more signatures to be uploaded, fire the completion event\n    allCompleteEvent();\n  }\n}\n\n\nfunction photoResultCallback(success) {\n  if (success) { \n    successCount++; \n    thisPhoto.uploaded = true; \n  } else { \n    failCount++; \n  }\n  \n  //window.appManager.logEvent('Upload: ' + success, 'info');\n  processNextPhoto();\n}\n\nfunction processNextPhoto() {\n  var requireUpload = false;\n  currentItemIndex++;\n  if (currentItemIndex < photos.length) {\n    var startIndex = currentItemIndex;\n    for (var i = startIndex; i < photos.length; i++) {\n      currentItemIndex = i;\n      thisPhoto = photos[currentItemIndex];\n      // If the photo needs uploading, attempt to do so\n      if (!thisPhoto.uploaded) {\n        requireUpload = true;\n        break;\n      }\n    }\n  }\n  if (requireUpload) {\n    photosToBeUploaded++;\n    //window.appManager.logEvent('Found photo to upload at index ' + currentItemIndex, 'info');\n\n    window.appManager.uploadBase64AndAssociateWithJob(\n      baseUrl, \n      \"PostImage\", \n      \"AttachImageToJobEvent\", \n      thisPhoto,\n      cti.store.jobs.photoAssociatedJob,\n      \"photo\",\n      photoResultCallback\n    );\n    //window.appManager.uploadFile(serverUri, thisPhoto.src, resultCallback);\n    //window.appManager.uploadFileAsBase64(serverUri, thisPhoto.src, resultCallback);\n  }\n  else {\n    // No more photos to be uploaded, fire the completion event\n    photosCompleteEvent();\n  }\n}\n\n//window.appManager.logEvent('Uploading photos', 'info');\nif (photos.length > 0) {\n  processNextPhoto();\n} else {\n  photosCompleteEvent();\n}"},{"name":"fnStashPhotos","type":"scripting","item-type":"function","_auto_id_":"9937f492-cc6c-4c56-bf0f-527e4b233cdd","sync":true,"params":[],"content":"var failedPhotoObj = JSON.parse(JSON.stringify(cti.store.payloads.failedPhotos));\n\nif(failedPhotoObj == undefined) {\n  failedPhotoObj = {\n    \"photos\" : [],\n    \"signatures\" : [],\n    \"job\" : cti.store.jobs.selectedJob\n  };\n}\n\ncti.store.jobs.failedPhotos.push(failedPhotoObj);\n\ndelete cti.store.jobs.selectedJob.photos;\ndelete cti.store.variables.jobCompleteHeaders;\ndelete cti.store.payloads.jobComplete;\ndelete cti.store.payloads.failedPhotos;\n\nwindow.appManager.logEvent('Failed to send PHOTOS to server for Job ID: ' + failedPhotoObj.job.aAccuServJobID.sJobNo + '. Re-submitting...', 'warning');\n\ncti.utils.callAction('call-actionflow', { \"name\": \"JobComplete\" });","actions":[]},{"name":"fnStashJob","type":"scripting","item-type":"function","_auto_id_":"c674f6e5-f062-4682-859f-feba432ffc3b","sync":true,"params":[{"name":"job"}],"content":"var offlineJob = JSON.parse(JSON.stringify(job));\nvar jobList = cti.store.jobs.jobList;\nvar jobDetails = cti.store.jobs.jobDetails;\nvar failedJobs = cti.store.jobs.failedJobs;\n\nfor(var i in jobList) {\n  var thisJob = jobList[i];\n  if(thisJob.aAccuServJobID.iJobEventNoKey === offlineJob.aAccuServJobID.iJobEventNoKey) {\n    jobList.splice(i, 1);\n    break;\n  }\n}\n\nfor(var i in jobDetails) {\n  var thisJob = jobDetails[i];\n  if(thisJob.aAccuServJobID.iJobEventNoKey === offlineJob.aAccuServJobID.iJobEventNoKey) {\n    jobDetails.splice(i, 1);\n    break;\n  }\n}\n\nfor(var i in failedJobs) {\n  var thisJob = failedJobs[i];\n  if(thisJob.aAccuServJobID.iJobEventNoKey === offlineJob.aAccuServJobID.iJobEventNoKey) {\n    failedJobs.splice(i, 1);\n    break;\n  }\n}\n\nif(cti.store.jobs.failedJobs === undefined) cti.store.jobs.failedJobs = [];\ncti.store.jobs.failedJobs.push(offlineJob);\n\ncti.store.jobs.lastJobEvent = {\n  \"aAccuServJobID\" : offlineJob.aAccuServJobID,\n  \"sPropertyID\" : offlineJob.aPropertyDetail.sPropertyID,\n  \"sOperativeID\" : offlineJob.aOperativeDetail.sOperativeID\n};\n\nwindow.appManager.logEvent('Failed to send JOB DETAIL to server for Job ID: ' + offlineJob.aAccuServJobID.sJobNo + '.Re-submitting...', 'error');\n\nwindow.accuServFunctions.fnClearJobData();\n\n// Close spinner\ncti.fnCloseSpinner(1000);\n\ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_response_error\",\n    \"title\": \"Job Failed to Send to Server\",\n    \"text\": \"You are currently either offline or there is not a strong enough internet connection to send the data back to the server. Job stored for re-submission.\"\n  }\n);"},{"name":"fnOpenSpinner","type":"scripting","item-type":"function","_auto_id_":"56bcb30c-60df-45e2-a910-0e75a8f76e76","sync":true,"params":[{"name":"message","description":"Message for the spinner to display","required":false}],"content":"var spinner = document.querySelectorAll('load-spinner');\n\nif(spinner && spinner.length > 0) {\n  spinner[0].setAttribute(\"message\", message);\n  spinner[0].show();\n}","actions":[]},{"name":"fnCloseSpinner","type":"scripting","item-type":"function","_auto_id_":"de4179bc-8b31-4d14-ac9c-12bf4b4ff609","sync":true,"params":[{"name":"timeout"}],"actions":[],"content":"var time = 0;\n\nif(timeout) {\n\ttime = timeout;\n}\n\nsetTimeout(function(){\n  var spinner = document.querySelectorAll('load-spinner');\n\n  if(spinner && spinner.length > 0) {\n    spinner[0].close();\n  }\n}, time);"},{"name":"fnSelectJob","type":"scripting","item-type":"function","_auto_id_":"0537b0b1-ec5d-47af-a7bd-b437e97d2c28","sync":true,"params":[{"name":"jobid","description":"Element id for the job"}],"content":"cti.fnOpenSpinner('Loading Job Details...');\n\nvar jobDetails = cti.store.jobs.jobDetails;\nvar jobFound = false;\n\nfor (var i = 0; i < jobDetails.length; i++) {\n  if (jobid == jobDetails[i].aAccuServJobID.iJobEventNoKey) {\n    var detailObj = JSON.parse(JSON.stringify(jobDetails[i]));\n    var items = [];\n\n    for(var i in detailObj.aItemGroups) {\n      var thisItem = detailObj.aItemGroups[i]; \n      var str = JSON.stringify(thisItem);\n      \n      str = str.replace(/sLongDescription/g, 'sLongDescr');\n      str = str.replace(/sDescription/g, 'sShortDescr');\n      \n      thisItem = JSON.parse(str);\n      \n      delete thisItem.nQtyDoneToDate;\n      delete thisItem.sID;\n      delete thisItem.sPriceBook;\n      delete thisItem.sSpecialInstruction;\n      delete thisItem.sUnitOfMeasure;\n      \n      if(thisItem.sLongDescr == \"\" || thisItem.sLongDescr == undefined) thisItem.sLongDescr = thisItem.sShortDescr;\n      if(thisItem.nSMVs == \"\" || thisItem.nSMVs == undefined) thisItem.nSMVs = 0;\n      if(thisItem.nSellPrice == \"\" || thisItem.nSellPrice == undefined) thisItem.nSellPrice = 0;\n      \n      if(thisItem.sAttrib1 == undefined) thisItem.sAttrib1 = \"\";\n      if(thisItem.sAttrib2 == undefined) thisItem.sAttrib2 = \"\";\n      if(thisItem.sAttrib3 == undefined) thisItem.sAttrib3 = \"\";\n      if(thisItem.sAttrib4 == undefined) thisItem.sAttrib4 = \"\";\n      if(thisItem.sStockUnit == undefined) thisItem.sStockUnit = \"\";\n      if(thisItem.sTrade == undefined) thisItem.sTrade = \"\";\n\n      thisItem.nQtyRemaining = thisItem.nQtyRequired;\n      thisItem.bAccuServCode = true;\n      \n      items.push(thisItem);\n    }\n    \n    detailObj.aItemGroups = items;\n    \n    cti.store.jobs.selectedJob = JSON.parse(JSON.stringify(detailObj));\n    \n    if(cti.store.jobs.selectedJob.aInJobDataCollectionResponse === undefined) {\n      cti.store.jobs.selectedJob.aInJobDataCollectionResponse = [];\n    }\n    if(cti.store.jobs.selectedJob.aInJobEventStatus === undefined) {\n      cti.store.jobs.selectedJob.aInJobEventStatus = [];\n    }\n    \n    jobFound = true;\n    break;\n  }\n}\n\nif(jobFound) {\n  if(cti.store.staticData.jobLocations != undefined) {\n    if(cti.store.staticData.jobLocations.length > 0) {\n      cti.fnOrderSORLocations();\n      cti.fnOrderVanLocations();\n      cti.fnOrderOTCLocations();\n    }\n  }\n  \n  cti.utils.callAction('go-to-page', { \"name\": \"TenantDetails\" });\n  cti.fnSendEventStatus(\"30\");\n  \n  // Close spinner\n  cti.fnCloseSpinner(1500);\n} else {\n  cti.store.variables.selectedJobId = jobid;\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobDetailOnline\" });\n}"},{"name":"fnPhoneCall","type":"scripting","item-type":"function","_auto_id_":"09fdd0cc-06cf-49f8-80a4-26fa27d108c3","sync":true,"params":[{"name":"type"}],"content":"if(type == \"tenanthome\") {\n  window.open('tel:'+cti.store.jobs.selectedJob.aPropertyDetail.sHome_No);\n} else if(type == \"tenantmob\") {\n  window.open('tel:'+cti.store.jobs.selectedJob.aPropertyDetail.sMobile_No);\n} else if(type == \"user\") {\n  window.open('tel:'+cti.store.jobs.selectedJob.aPropertyDetail.sWork_No);\n} else if(type == \"manager\") {\n  window.open('tel:'+cti.store.currentProfile.managerTelephone);\n}"},{"name":"fnBuildPayload","type":"scripting","item-type":"function","_auto_id_":"ebc1b4c4-59bf-46f6-836a-0c6fc1191342","sync":true,"params":[{"name":"pageName"},{"name":"payloadObject"}],"content":"var schema = cti.store.schema;\n\nfunction getObjects(obj, key, val) {\n    var objects = [];\n    for (var i in obj) {\n          if (!obj.hasOwnProperty(i))\n              continue;\n        if (typeof obj[i] === 'object') {\n            objects = objects.concat(getObjects(obj[i], key, val));\n        }\n        else {\n            if (i == key && obj[i] == val || i == key && val == '') {\n                objects.push(obj);\n            }\n            else if (obj[i] == val && key == '') {\n                if (objects.lastIndexOf(obj) == -1) {\n                    objects.push(obj);\n                }\n            }\n        }\n    }\n    return objects;\n}\n\nfunction sanitiseAnswer(answer) {\n    if (answer === undefined || answer == '') { return undefined; }\n    if (typeof answer === 'object' && answer.hasOwnProperty('value')) {\n      return answer.value;\n    }\n      return answer;\n}\n\nfor (var i = 0; i < schema.pages.length; i++) {\n  if (schema.pages[i].name.toLowerCase() == pageName.toLowerCase()) {    \n    var userInput = getObjects(schema.pages[i].content, 'type', 'user-input');\n    var choice = getObjects(schema.pages[i].content, 'type', 'choice');\n    \n    var questions = userInput.concat(choice);\n    \n    for (var p in questions) {\n      var questionName = questions[p].name;\n      var answer = sanitiseAnswer(cti.store.pages[pageName][questionName]);\n      if (answer !== undefined) {\n        payloadObject[questionName] = answer;\n      }\n    }\n  }\n}"},{"name":"fnPreparePayload","type":"scripting","item-type":"function","_auto_id_":"5cdfb818-e92b-4a13-af33-789caf9e9a44","sync":true,"params":[{"name":"pages"}],"content":"var payload = {};\n\nfor(var i in pages) {\n  cti.fnBuildPayload(pages[i], payload);\n}\n\ncti.store.saveActionPayload = payload;"},{"name":"GoogleMapping","type":"integration","item-type":"url","_auto_id_":"e4d29672-a754-4ca1-a16a-a22c24875dcc","params":{},"target":"_system","url":"http://maps.google.com/maps/dir/"},{"name":"GoogleMapsAPI","type":"integration","item-type":"api","_auto_id_":"158cba53-43ad-49b4-98b0-82ca2927c650","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"initMap","summary":"initMap","path":"initMap","method":"GET","content-type":"application/json","$open":false}],"url":"https://maps.googleapis.com/maps/api/js?key=AIzaSyBLm-X17nxieJiS66S0wxHqHqDcZ38_Qww&callback"},{"name":"AccuServ","type":"integration","item-type":"api","_auto_id_":"4ac218fb-a78b-476b-b5a6-fc98c76f4fae","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"login","summary":"Authentication call","path":"login","method":"POST","content-type":"application/json","$open":false,"params":[{"name":"data","description":"Post payload of username and password","type":"string","typeConfig":{},"in":"body"},{"name":"applicationkey","type":"string","typeConfig":{},"in":"header","description":"App key"},{"name":"messageid","description":"Unique identifies the request","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"joblist","summary":"Job list","path":"joblist","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Current Job List","type":"string","typeConfig":{},"in":"body"}],"$open":false},{"ttlMinutes":60,"name":"jobdetail","summary":"Fetches individual job detail for selected job from job list","path":"jobdetail","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Job ID data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messageid","description":"Unique message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"initialise","summary":"Fetches vehicle information, stock and manager phone number","path":"initialise","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Unique request id","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Date of the request","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Authentication token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobhistory","summary":"Returns specific Job's history","path":"jobhistory","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Data object to send as parameter","type":"string","typeConfig":{},"in":"body"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App Key","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"followonappointment","summary":"Books a follow on appointment","path":"followonappointment","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobcompletion","summary":"Job complete event","path":"jobcompletion","method":"POST","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"followonavailability","summary":"Fetches follow on appointments per trade","path":"followonavailability","method":"POST","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}],"$open":false},{"ttlMinutes":60,"name":"joblocations","summary":"Job locations list","path":"joblocations","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"sordata","summary":"SOR data","path":"sordata","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"vanstock","summary":"Van Stock","path":"vanstock","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"ordercatalogue","summary":"Order catalogue","path":"ordercatalogue","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"purchaseorder","summary":"Send purchase order for stock from device","path":"purchaseorder","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"requestoutofhoursjob","summary":"Sends a request for an OOH job on the fly","path":"requestoutofhoursjob","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"raiseincident","summary":"Raises an on-the-fly incident event","path":"raiseincident","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"validatejobstatus","summary":"Validates job before it's started","path":"validatejobstatus","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]}],"url":"{{$store.pages.AppSettings.accuservAPIAddress}}"},{"name":"api_failure_error","type":"notification","item-type":"app-notification","_auto_id_":"9f27a148-6ec9-4758-84e0-18a235f670f5","options":{"autoDismiss":true,"closeButton":true},"style":"error","actions":[]},{"name":"api_response_error","type":"notification","item-type":"app-notification","_auto_id_":"46a5bb71-e50e-43ce-b1f4-cd0f60333b09","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"app_logout","type":"notification","item-type":"app-notification","_auto_id_":"debe128d-198b-44b5-88b4-3c45c2750894","options":{"progressBar":false,"autoDismiss":true,"closeButton":true},"style":"warning"},{"name":"AccuServOffline","type":"integration","item-type":"offline-api","_auto_id_":"ff462273-908e-4bd7-b631-14537350d57c","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"startofday","summary":"Sends back vehicle check data","path":"startofday","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Unique id of the request","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Date time of the request","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Sends the Start of Day checks in a data payload to the server","type":"string","typeConfig":{},"in":"body"}],"$open":true},{"ttlMinutes":60,"name":"sordata","summary":"Fetches SOR codes for the user","path":"sordata","method":"GET","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"vanstock","summary":"Brings back Van Stock data","path":"vanstock","method":"GET","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":5,"name":"jobdetail","summary":"jobdetail","path":"jobdetail","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Job ID data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Unique id of the message","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"joblocations","summary":"Fetches locations for van and SOR codes","path":"joblocations","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":5,"name":"refreshtoken","summary":"Refresh our auth token","path":"refreshtoken","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Unique ref","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Date of the message","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Current token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"tradeslist","summary":"Fetches a list of trades for a job","path":"tradeslist","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"problemsummaries","summary":"Fetches a list of problem summaries for a job","path":"problemsummaries","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"resultsummaries","summary":"Fetches a list of result summaries for a job","path":"resultsummaries","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobdatacollection","summary":"Sends job data back to the server","path":"jobdatacollection","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobcompletion","summary":"Completes current job","path":"jobcompletion","method":"POST","content-type":"application/json","params":[{"name":"messageid","description":"Message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}],"$open":false},{"ttlMinutes":60,"name":"ordercatalogue","summary":"Order Catalogue","path":"ordercatalogue","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"stocksuppliers","summary":"Stock Suppliers List","path":"stocksuppliers","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App Key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth Token","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"jobstatus","summary":"Sends a status code back to Accu Serv for the status of the current job","path":"jobstatus","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]}],"url":"{{$store.pages.AppSettings.accuservAPIAddress}}"},{"name":"app_odometer","type":"notification","item-type":"app-notification","_auto_id_":"f8d2ee70-3feb-4061-b8bc-31ea77498370","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"app_nowarnings","type":"notification","item-type":"app-notification","_auto_id_":"01ec4eb8-9859-4581-a28b-9cc52e2dfa62","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"fnCheckWarning","type":"scripting","item-type":"function","_auto_id_":"321a023e-8bd1-4751-96ad-9b49903352a8","sync":true,"params":[{"name":"index"}],"actions":[],"content":"var jobwarnings = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\nvar element = document.getElementById('select-all');\nvar uncheckedWarnings = true;\n\nif(jobwarnings[index].checked === \"checked-warning\") {\n  jobwarnings[index].checked = \"unchecked-warning\";\n} else {\n  jobwarnings[index].checked = \"checked-warning\";\n}\n\nfor(var i in jobwarnings) {  \n  if(jobwarnings[i].checked === \"unchecked-warning\") {\n    uncheckedWarnings = false;\n  }\n}\n\nif(uncheckedWarnings) {\n  element.classList.remove('all-unchecked-warning');\n  element.classList.add('all-checked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = true;\n} else {\n  element.classList.remove('all-checked-warning');\n  element.classList.add('all-unchecked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = false;\n}\n\ncti.utils.updatePage();"},{"name":"fnCheckAllWarnings","type":"scripting","item-type":"function","_auto_id_":"daf8d385-89cb-40aa-bed2-9c0fa2757fd8","sync":true,"params":[],"actions":[],"content":"var jobwarnings = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\nvar element = document.getElementById('select-all');\nvar checkedAll = true;\n\nfor(var i in jobwarnings) {  \n  if(jobwarnings[i].checked === \"unchecked-warning\") {\n    checkedAll = false;\n  }\n}\n\nif(checkedAll) {\n  for(var i in jobwarnings) {  \n    jobwarnings[i].checked = \"unchecked-warning\";\n  }\n  element.classList.remove('all-checked-warning');\n  element.classList.add('all-unchecked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = false;\n} else {\n  for(var i in jobwarnings) {  \n    jobwarnings[i].checked = \"checked-warning\";\n  }\n  element.classList.remove('all-unchecked-warning');\n  element.classList.add('all-checked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = true;\n  \n  var objDiv = document.getElementById(\"scrollable\");\n  objDiv.scrollTop = objDiv.scrollHeight;\n}\n\ncti.utils.updatePage();"},{"name":"fnReturnIconClass","type":"scripting","item-type":"function","_auto_id_":"a317befd-3c30-4955-b71c-9066ed7dcfc0","sync":true,"params":[{"name":"typeOfWarning"}],"actions":[],"content":"if(typeOfWarning === \"2 PERSON CALL\") { \n  return { \n    \"outerClass\": \"two-person-icon\", \n    \"iconClass\": \"fa-user-plus\" \n  };\n} else if(typeOfWarning === \"PROPERTY\") { \n  return { \n    \"outerClass\": \"property-icon\", \n    \"iconClass\": \"fa-home\" \n  };\n} else if(typeOfWarning === \"ASBESTOS\") { \n  return { \n    \"outerClass\": \"asbestos-icon\", \n    \"iconClass\": \"fa-exclamation-triangle\" \n  };\n} else if(typeOfWarning === \"DISABILITY\") { \n  return { \n    \"outerClass\": \"disability-icon\", \n    \"iconClass\": \"fa-wheelchair\" \n  };\n} else if(typeOfWarning === \"VULNERABILITY\") { \n  return { \n    \"outerClass\": \"vulnerability-icon\", \n    \"iconClass\": \"fa-info-circle\" \n  };\n} else { \n  return { \n    \"outerClass\": \"other-icon\", \n    \"iconClass\": \"fa-file-text-o\" \n  };\n}"},{"name":"fnNavigateJobSummary","type":"scripting","item-type":"function","_auto_id_":"ac3ec751-4e6c-4c87-a413-80d3bc26fc66","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"cti.store.jobs.jobSummary = JSON.parse(JSON.stringify(cti.store.jobs.selectedJob));\nvar job = cti.store.jobs.jobSummary;\n\njob.iAttendOnHrs = (\"0\" + Number(job.iAttendOnHrs)).slice(-2);\njob.iAttendOnMins = (\"0\" + Number(job.iAttendOnMins)).slice(-2);\njob.dAttendOnDate = moment(job.dAttendOnDate).format('Do MMMM YYYY');\n\njob.iJobTargetMins = (\"0\" + Number(job.iJobTargetMins)).slice(-2);\njob.iJobTargetHrs = (\"0\" + Number(job.iJobTargetHrs)).slice(-2);\njob.dJobTargetDate = moment(job.dJobTargetDate).format('Do MMMM YYYY');\n\nif(lastPage !== \"JobMap\") {\n  cti.store.variables.jobSummaryLastPage = lastPage;\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"JobSummary\" });"},{"name":"fnNavigateJobHistory","type":"scripting","item-type":"function","_auto_id_":"e99317cc-b2a3-45d2-8778-662fac59bd32","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"// Load the spinner\ncti.fnOpenSpinner('Fetching Job History...');\n\ncti.store.variables.lastJobHistoryPage = lastPage;\nvar jobHistory = cti.store.jobs.jobHistory;\n\nif(jobHistory != undefined) {\n  if(jobHistory.length > 0) {\n    cti.utils.callAction('go-to-page', { \"name\": \"JobHistory\" });\n  } else {\n    cti.utils.callAction('call-actionflow', { \"name\": \"GetJobHistory\" });\n  }\n} else {\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobHistory\" });\n}"},{"name":"fnNavigateSORCodes","type":"scripting","item-type":"function","_auto_id_":"e5940e13-b6df-4821-9050-ad9980b62437","sync":true,"params":[{"name":"lastPage","description":"Current page to retain as historic page stack"},{"name":"customerDetails","description":"Boolean to notifiy if the operative has filled in the customers details correctly"}],"actions":[],"content":"var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\ncti.store.variables.lastJobCost = jobCost;\n\nif(customerDetails === undefined) {\n  customerDetails = false;\n}\n\nif(cti.store.variables.showFullLocations === true) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(lastPage == \"CustomerSignature\" || lastPage == \"VanLocationSelect\") {\n  if(customerDetails) {\n  \tcti.store.variables.sorNav = true;\n  } else {\n    cti.store.variables.sorNav = false;\n  }\n} else {\n  cti.store.variables.sorNav = false;\n}\n\ncti.store.variables.lastSORPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"SORLocationSelect\" });"},{"name":"fnNavigateVanStock","type":"scripting","item-type":"function","_auto_id_":"bdc05a3b-5790-4bd0-b00d-e0995a751671","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"if(cti.store.variables.showFullLocations === true) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(lastPage == \"SORLocationSelect\" || lastPage == \"OTCPurchases\") {\n  cti.store.variables.vanNav = true;\n} else {\n  cti.store.variables.vanNav = false;\n}\n\nvar vanStockResponse = cti.store.offlineApi.AccuServOffline.vanstock;\n\nif(vanStockResponse != undefined) {\n  if(vanStockResponse.bSuccess === false) {\n    if(vanStockResponse.aOperativeVanStock.length === 0) {\n      cti.store.variables.noVanStock = vanStockResponse.sStatus;\n    } else {\n      cti.store.variables.noVanStock = \"Van Stock failed to download for current Operative. Contact Support.\";\n    }\n  } else {\n    cti.store.variables.noVanStock = undefined;\n  }\n} else {\n  cti.store.variables.noVanStock = \"Van Stock failed to download for current Operative. Contact Support.\";\n}\n\ncti.store.variables.lastVanStockPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"VanLocationSelect\" });"},{"name":"fnNavigatePO","type":"scripting","item-type":"function","_auto_id_":"98e5ab66-0e9b-44c8-93d3-c03f2893b06f","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"if(lastPage == \"Completion\" || lastPage == \"VanLocationSelect\") {\n  cti.store.variables.poNav = true;\n} else {\n  cti.store.variables.poNav = false;\n}\n\ncti.store.variables.lastPOPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"OTCPurchases\" });"},{"name":"fnNavigateJobMap","type":"scripting","item-type":"function","_auto_id_":"f20fa7aa-b7f9-4124-8fca-2dcccdd16876","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"// Load the spinner\ncti.fnOpenSpinner('Loading Job Map...');\n\nif(cti.store.jobs.selectedJob == undefined) {\n  cti.store.variables.jobStarted = false;\n} else {\n  if(cti.store.jobs.selectedJob.bJobTravelStarted) {\n    cti.store.variables.jobStarted = true;\n  } else {\n    cti.store.variables.jobStarted = false;\n  }\n}\n\nif(lastPage !== \"JobSummary\") {\n  cti.store.variables.lastJobMapPage = lastPage;\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"JobMap\" });"},{"name":"fnNavigateSupportInfo","type":"scripting","item-type":"function","_auto_id_":"992f3a11-0fed-4d6d-adbd-ebe7b8eaa88e","sync":true,"params":[],"content":"if(cti.store.jobs.selectedJob == undefined) {\n  cti.store.variables.jobStarted = false;\n} else {\n  if(cti.store.jobs.selectedJob.bJobTravelStarted) {\n    cti.store.variables.jobStarted = true;\n  } else {\n    cti.store.variables.jobStarted = false;\n  }\n}\n\ncti.store.variables.supportInfo = {\n  \"tokenExpiry\": \"n/a\",\n  \"sessionExpiry\": \"n/a\"\n}\n\nif(cti.store.currentProfile.expiryTime) {\n  cti.store.variables.supportInfo.tokenExpiry = window.accuServFunctions.fnLocaleTimeString(cti.store.currentProfile.expiryTime);\n}\nif(cti.store.currentProfile.maxLoginDurationExpiry) {\n  cti.store.variables.supportInfo.sessionExpiry = window.accuServFunctions.fnLocaleTimeString(cti.store.currentProfile.maxLoginDurationExpiry);\n}\n\ncti.store.variables.supportInfoLastPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { \"name\": \"SupportInfo\" });"},{"name":"fnNavigatePhotoDetail","type":"scripting","item-type":"function","_auto_id_":"1a82d2b0-3323-4afc-8d94-7672ebbcd099","sync":true,"params":[{"name":"request","description":"Id of the photo to show the details for","required":true}],"content":"if (cti.store.variables.selectedPhoto !== undefined) {\n  delete cti.store.variables.selectedPhoto;\n}\n\ncti.store.variables.selectedPhotoList = request.photosContainer;\n\nfor (var k in request.photosContainer) {\n  if (request.photosContainer[k].id == request.id) {\n    cti.store.variables.selectedPhoto = {\n      \"id\": request.id,\n      \"description\": request.photosContainer[k].description,\n\t  \"src\": request.photosContainer[k].src,\n\t  \"category\": request.photosContainer[k].category,\n\t  \"date\": window.accuServFunctions.fnLocaleTimeString(request.photosContainer[k].date),\n\t  \"internalName\": request.photosContainer[k].internalName\n    }\n\tif (cti.store.pages.PhotoDetail === undefined) {\n      cti.store.pages.PhotoDetail = {};\n    }\n    cti.store.pages.PhotoDetail.Description = cti.store.variables.selectedPhoto.description;\n    \n    break;\n  }\n}\n\ncti.store.variables.lastPhotoDetailPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { \"name\": \"PhotoDetail\" });"},{"name":"fnNavigateTakePhoto","type":"scripting","item-type":"function","_auto_id_":"9b7e6e3c-a6b4-4692-9e36-31b25caeb443","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"if(lastPage == \"SORLocationSelect\" || lastPage == \"VanLocationSelect\") {\n  cti.store.variables.sorNav = true;\n} else {\n  cti.store.variables.sorNav = false;\n}\n\ncti.store.variables.lastPhotoPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"AdHocPhotos\" });"},{"name":"fnStartTravel","type":"scripting","item-type":"function","_auto_id_":"85f0e00d-3147-43dc-84df-9dfd743d403d","sync":true,"params":[],"content":"var d = new Date();\nvar h = (d.getHours()<10?'0':'') + d.getHours();\nvar m = (d.getMinutes()<10?'0':'') + d.getMinutes();\nvar time = h + ':' + m;\n\ncti.store.jobs.selectedJob.sJobTravelStartedText = \"En-Route Time\";\ncti.store.jobs.selectedJob.dtJobTravelStartedDateTime = moment().format();\ncti.store.jobs.selectedJob.iJobStartedTravelTime = time;\ncti.store.jobs.selectedJob.iJobStartedTravelHrs = h;\ncti.store.jobs.selectedJob.iJobStartedTravelMins = m;\ncti.store.jobs.selectedJob.bJobTravelStarted = true;\n\n// Send job status\ncti.fnSendEventStatus(\"40\");\n\ncti.utils.updatePage();"},{"name":"app_startedtravel","type":"notification","item-type":"app-notification","_auto_id_":"c2abb0bc-02c8-45bc-96e5-1367dbdb1087","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnEndTravel","type":"scripting","item-type":"function","_auto_id_":"abc85645-5fb9-46ae-89b4-6dc42579183a","sync":true,"params":[],"content":"var d = new Date();\nvar h = (d.getHours()<10?'0':'') + d.getHours();\nvar m = (d.getMinutes()<10?'0':'') + d.getMinutes();\nvar time = h + ':' + m;\n\nvar spinner = document.getElementById('arriving-spinner');\nspinner.classList.remove('fa-fw');\nspinner.classList.remove('fa-3x');\nspinner.classList.remove('fa-spin');\nspinner.classList.remove('fa-spinner');\nspinner.classList.add('arrived-ticked');\n\ncti.store.jobs.selectedJob.sJobTravelEndedText = \"Arrived Time\";\ncti.store.jobs.selectedJob.dtJobTravelEndedDateTime = moment().format();\ncti.store.jobs.selectedJob.iJobEndedTravelTime = time;\ncti.store.jobs.selectedJob.iJobEndedTravelHrs = h;\ncti.store.jobs.selectedJob.iJobEndedTravelMins = m;\ncti.store.jobs.selectedJob.bJobTravelEnded = true;\n\n// Send job status\ncti.fnSendEventStatus(\"60\");\n\ncti.utils.updatePage();","actions":[]},{"name":"app_noaccessphoto","type":"notification","item-type":"app-notification","_auto_id_":"78a68ce9-c57c-4ce9-a677-2c848e8bcd4e","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnStartJob","type":"scripting","item-type":"function","_auto_id_":"cca9a827-fcf5-4e27-aaf3-26f8eccd2a32","sync":true,"params":[],"content":"var job = cti.store.jobs.selectedJob;\nvar d = new Date();\nvar h = (d.getHours()<10?'0':'') + d.getHours();\nvar m = (d.getMinutes()<10?'0':'') + d.getMinutes();\nvar time = h + ':' + m;\n\njob.sJobStartWorkText = \"Job Started Time\";\njob.iJobStartWorkTime = time;\njob.iJobStartWorkHrs = h;\njob.iJobStartWorkMins = m;\njob.bJobStartWork = true;\n\nif(cti.store.pages.CustomerSignature == undefined) cti.store.pages.CustomerSignature = {};\n\ncti.store.pages.CustomerSignature.tenantHomeNumber = job.aPropertyDetail.sHome_No;\ncti.store.pages.CustomerSignature.tenantMobileNumber = job.aPropertyDetail.sMobile_No;\n\nif(cti.store.variables.estimatedOverride) {\n  job.sExpected_Duration = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n} else {\n  if(job.sExpected_Duration == undefined || job.sExpected_Duration == \"\") {\n    job.sExpected_Duration = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n  }\n}\n\njob.iJobStartWorkEst = job.sExpected_Duration;\n\ncti.store.variables.jobCollectionType = \"initialvisit\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n\n// Send job status\ncti.fnSendEventStatus(\"65\");\n\n// Capture original estimatedDuration slot\nif(cti.store.pages.StartingWork.estimatedDuration.value === undefined) {\n  cti.store.jobs.selectedJob.originalEstimatedValue = job.sExpected_Duration;\n} else {\n  cti.store.jobs.selectedJob.originalEstimatedValue = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n}\n\ncti.utils.updatePage();"},{"name":"app_timeslot","type":"notification","item-type":"app-notification","_auto_id_":"9c61360a-7a6d-429a-a726-f52c92bbde20","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnShowMoreInfo","type":"scripting","item-type":"function","_auto_id_":"1e3f9c4b-54f8-4e8e-8795-9017b134e5ce","sync":true,"params":[{"name":"elementId"}],"content":"var short = document.getElementById('job-info-short');\nvar full = document.getElementById('job-info-full');\n\nif(elementId == \"short\") {\n  short.classList.remove('job-info-hide');\n  full.classList.add('job-info-hide');\n} else {\n  full.classList.remove('job-info-hide');\n  short.classList.add('job-info-hide');\n}\n\ncti.utils.updatePage();","actions":[]},{"name":"app_sorcodematch","type":"notification","item-type":"app-notification","_auto_id_":"4045cae7-ac88-4f49-b93e-b1594f825420","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnSearchPanel","type":"scripting","item-type":"function","_auto_id_":"1fe356f2-0cc3-45fa-8e81-0c826da8ad8f","sync":true,"params":[{"name":"menuOption"}],"content":"var panel = document.getElementById('panel');\nvar schedules = document.getElementById('schedules');\nvar search = document.getElementById('search');\n\nif(menuOption == \"schedules\") {\n  panel.classList.remove('sor-search-panel');\n  schedules.classList.remove('sor-search-schedules');\n  search.classList.remove('sor-search-search');\n  \n  panel.classList.add('sor-schedules-panel');\n  schedules.classList.add('sor-schedules-schedules');\n  search.classList.add('sor-schedules-search');\n} else {\n  panel.classList.remove('sor-schedules-panel');\n  schedules.classList.remove('sor-schedules-schedules');\n  search.classList.remove('sor-schedules-search');\n  \n  panel.classList.add('sor-search-panel');\n  schedules.classList.add('sor-search-schedules');\n  search.classList.add('sor-search-search');\n}\n\ncti.store.variables.menuOption = menuOption;\ncti.utils.updatePage();","actions":[]},{"name":"fnOrderSORLocations","type":"scripting","item-type":"function","_auto_id_":"274a3be3-9088-4487-9b55-8f12ee423fee","sync":true,"params":[],"actions":[],"content":"var locations = cti.store.staticData.jobLocations;\nvar listOfLocations = [];\n\nif(cti.store.variables.showFullLocations === undefined) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(locations == undefined) locations = [];\n\nif(locations.length != 0) {\n  cti.store.variables.jobLocations = true;\n  \n  var orderIdIncrementer = 7;\n  var sorLocations = JSON.parse(JSON.stringify(locations));\n  var sorCodesOnJob = cti.store.jobs.selectedJob.aItemGroups;\n\n  for(var i in sorLocations) {\n    var requiredInLocation = false;\n    var sorCodesQuantity = 0;\n    var currentLocation = sorLocations[i];\n\n    if(currentLocation.sSORCodesQuantity == undefined) currentLocation.sSORCodesQuantity = {};\n\n    for(var k in sorCodesOnJob) {\n      if(sorCodesOnJob[k].sLocation == \"\") {\n        sorCodesOnJob[k].sLocation = \"NOLOCATION\";\n      }\n      \n      if(currentLocation.sLocation == sorCodesOnJob[k].sLocation) {\n        sorCodesQuantity++;\n\n        if(sorCodesOnJob[k].nQtyRemaining != 0) {\n          requiredInLocation = true;\n        }\n      }\n    }\n\n    currentLocation.nSORQuantity = sorCodesQuantity;\n\n    if(sorCodesQuantity > 0) {\n      if(requiredInLocation) {\n        currentLocation.sLocationClass = \"fa required-sorcode\";\n      } else {\n        currentLocation.sLocationClass = \"fa added-sorcode\";\n      }\n\n      currentLocation.sSORCodesQuantity = '(' + sorCodesQuantity + ')';\n    } else {\n      currentLocation.sSORCodesQuantity = \"\";\n      currentLocation.sLocationClass = \"\";\n    }\n    \n    var location = currentLocation.sLocation.toLowerCase();\n       \n    if(location.indexOf(\"kitchen\") != -1) {\n      currentLocation.nOrderId = 1;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bathroom\") != -1) {\n      currentLocation.nOrderId = 2;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"lounge\") != -1 || location.indexOf(\"living\") != -1) {\n      currentLocation.nOrderId = 3;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"1\") != -1) {\n      currentLocation.nOrderId = 4;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"2\") != -1) {\n      currentLocation.nOrderId = 5;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"3\") != -1) {\n      currentLocation.nOrderId = 6;\n      if(sorCodesQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    } else {\n      currentLocation.nOrderId = orderIdIncrementer;\n      orderIdIncrementer++;\n      if(sorCodesQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    }\n  }\n  \n  if(cti.store.variables.showFullLocations) {\n    for(var i in sorLocations) {\n      if(sorLocations[i].nSORQuantity != 0) {\n        sorLocations[i].nOrderId = 0;\n      }\n    }\n    \n    sorLocations.sort(compare);\n    cti.store.jobs.jobSORLocations = sorLocations;\n  } else {\n    cti.store.variables.showFullLocations = false;\n    for(var i in listOfLocations) {\n      if(listOfLocations[i].nSORQuantity != 0) {\n        listOfLocations[i].nOrderId = 0;\n      }\n    }\n    \n    listOfLocations.sort(compare);\n    cti.store.jobs.jobSORLocations = listOfLocations;\n  }\n} else {\n  delete cti.store.jobs.jobSORLocations;\n  cti.store.variables.jobLocations = false;\n}\n\nfunction compare(a,b) {\n  if (a.nOrderId > b.nOrderId) return 1;\n  if (a.nOrderId < b.nOrderId) return -1;\n  return 0;\n}"},{"name":"app_sorcodesfailed","type":"notification","item-type":"app-notification","_auto_id_":"e21f34c6-5df2-455c-b78d-1b484e3b5eea","options":{"autoDismiss":true,"closeButton":true},"style":"warning"},{"name":"app_sorcodeadded","type":"notification","item-type":"app-notification","_auto_id_":"8e42f603-7450-4e1e-8527-d1ea63edbae6","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"app_specialordersent","type":"notification","item-type":"app-notification","_auto_id_":"5febab90-2064-4fd6-91c6-30a4b33c439b","options":{"autoDismiss":true,"closeButton":true},"style":"info"},{"name":"app_jobcomplete","type":"notification","item-type":"app-notification","_auto_id_":"f71225b5-4113-4b69-b076-b17a8233d5e2","options":{"autoDismiss":true,"closeButton":true},"style":"info"},{"name":"app_genericwarning","type":"notification","item-type":"app-notification","_auto_id_":"4428ce54-9022-408f-aa59-ac62f3e8ee3a","options":{"autoDismiss":true,"closeButton":true},"style":"warning","title":"Warning"},{"name":"app_riskassessmentsent","type":"notification","item-type":"app-notification","_auto_id_":"0b0ffd81-1e4a-4167-97aa-115c40aab748","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"fnOrderVanLocations","type":"scripting","item-type":"function","_auto_id_":"da51420a-6f02-49ad-832d-5011f0cf11ea","sync":true,"params":[],"actions":[],"content":"var locations = cti.store.staticData.jobLocations;\nvar listOfLocations = [];\n\nif(cti.store.variables.showFullLocations === undefined) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(locations == undefined) locations = [];\n\nif(locations.length != 0) {\n  cti.store.variables.jobLocations = true;\n  \n  var orderIdIncrementer = 7;\n  var vanLocations = JSON.parse(JSON.stringify(locations));\n  var vanStockOnJob = cti.store.jobs.selectedJob.aVanStock;\n\n  if(cti.store.jobs.selectedJob.aVanStock == undefined) cti.store.jobs.selectedJob.aVanStock = [];\n\n  for(var i in vanLocations) {\n    var vanStockQuantity = 0;\n    var currentLocation = vanLocations[i];\n\n    if(currentLocation.sVanStockQuantity == undefined) currentLocation.sVanStockQuantity = {};\n\n    for(var k in vanStockOnJob) {\n      if(currentLocation.sLocation == vanStockOnJob[k].sLocation) {\n        vanStockQuantity++;\n      }\n    }\n\n    currentLocation.nVanQuantity = vanStockQuantity;\n\n    if(vanStockQuantity > 0) {\n      currentLocation.sLocationClass = \"fa added-sorcode\";\n      currentLocation.sVanStockQuantity = '(' + vanStockQuantity + ')';\n    } else {\n      currentLocation.sVanStockQuantity = \"\";\n      currentLocation.sLocationClass = \"\";\n    }\n    \n    var location = currentLocation.sLocation.toLowerCase();\n       \n    if(location.indexOf(\"kitchen\") != -1) {\n      currentLocation.nOrderId = 1;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bathroom\") != -1) {\n      currentLocation.nOrderId = 2;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"lounge\") != -1 || location.indexOf(\"living\") != -1) {\n      currentLocation.nOrderId = 3;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"1\") != -1) {\n      currentLocation.nOrderId = 4;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"2\") != -1) {\n      currentLocation.nOrderId = 5;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"3\") != -1) {\n      currentLocation.nOrderId = 6;\n      if(vanStockQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    } else {\n      currentLocation.nOrderId = orderIdIncrementer;\n      orderIdIncrementer++;\n      if(vanStockQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    }\n  }\n\n  if(cti.store.variables.showFullLocations) {\n    for(var i in vanLocations) {\n      if(vanLocations[i].nVanQuantity != 0) {\n        vanLocations[i].nOrderId = 0;\n      }\n    }\n    \n    vanLocations.sort(compare);\n    cti.store.jobs.locationsVanStock = vanLocations;\n  } else {\n    cti.store.variables.showFullLocations = false;\n    for(var i in listOfLocations) {\n      if(listOfLocations[i].nVanQuantity != 0) {\n        listOfLocations[i].nOrderId = 0;\n      }\n    }\n    \n    listOfLocations.sort(compare);\n    cti.store.jobs.locationsVanStock = listOfLocations;\n  }\n} else {\n  delete cti.store.jobs.locationsVanStock;\n  cti.store.variables.jobLocations = false;\n}\n\nfunction compare(a,b) {\n  if (a.nOrderId > b.nOrderId) return 1;\n  if (a.nOrderId < b.nOrderId) return -1;\n  return 0;\n}"},{"name":"fnOrderOTCLocations","type":"scripting","item-type":"function","_auto_id_":"7c2d1904-4b90-419f-8a12-ff09f144144c","sync":true,"params":[],"actions":[],"content":"var locations = cti.store.staticData.jobLocations;\nvar listOfLocations = [];\n\nif(cti.store.variables.showFullLocations === undefined) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(locations == undefined) locations = [];\n\nif(locations.length != 0) {\n  cti.store.variables.jobLocations = true;\n\n  var orderIdIncrementer = 7;\n  var otcLocations = JSON.parse(JSON.stringify(locations));\n  var otcStockOnJob = cti.store.jobs.selectedJob.aOTCStock;\n\n  if(cti.store.jobs.selectedJob.aOTCStock == undefined) cti.store.jobs.selectedJob.aOTCStock = [];\n\n  for(var i in otcLocations) {\n    var otcStockQuantity = 0;\n    var currentLocation = otcLocations[i];\n\n    if(currentLocation.sOTCStockQuantity == undefined) currentLocation.sOTCStockQuantity = {};\n\n    for(var k in otcStockOnJob) {\n      if(currentLocation.sLocation == otcStockOnJob[k].sLocation) {\n        otcStockQuantity++;\n      }\n    }\n\n    currentLocation.nOTCQuantity = otcStockQuantity;\n\n    if(otcStockQuantity > 0) {\n      currentLocation.sLocationClass = \"fa added-sorcode\";\n      currentLocation.sOTCStockQuantity = '(' + otcStockQuantity + ')';\n    } else {\n      currentLocation.sOTCStockQuantity = \"\";\n      currentLocation.sLocationClass = \"\";\n    }\n\n    var location = currentLocation.sLocation.toLowerCase();\n\n    if(location.indexOf(\"kitchen\") != -1) {\n      currentLocation.nOrderId = 1;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bathroom\") != -1) {\n      currentLocation.nOrderId = 2;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"lounge\") != -1 || location.indexOf(\"living\") != -1) {\n      currentLocation.nOrderId = 3;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"1\") != -1) {\n      currentLocation.nOrderId = 4;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"2\") != -1) {\n      currentLocation.nOrderId = 5;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"3\") != -1) {\n      currentLocation.nOrderId = 6;\n      if(otcStockQuantity > 0) {\n        listOfLocations.push(currentLocation);\n      }\n    } else {\n      currentLocation.nOrderId = orderIdIncrementer;\n      orderIdIncrementer++;\n      if(otcStockQuantity > 0) {\n        listOfLocations.push(currentLocation);\n      }\n    }\n  }\n\n  if(cti.store.variables.showFullLocations) {\n    for(var i in otcLocations) {\n      if(otcLocations[i].nOTCQuantity != 0) {\n        otcLocations[i].nOrderId = 0;\n      }\n    }\n\n    otcLocations.sort(compare);\n    cti.store.jobs.locationsOTCStock = otcLocations;\n  } else {\n    cti.store.variables.showFullLocations = false;\n    for(var i in listOfLocations) {\n      if(listOfLocations[i].nOTCQuantity != 0) {\n        listOfLocations[i].nOrderId = 0;\n      }\n    }\n\n    listOfLocations.sort(compare);\n    cti.store.jobs.locationsOTCStock = listOfLocations;\n  }\n} else {\n  delete cti.store.jobs.locationsOTCStock;\n  cti.store.variables.jobLocations = false;\n}\n\nfunction compare(a,b) {\n  if (a.nOrderId > b.nOrderId) return 1;\n  if (a.nOrderId < b.nOrderId) return -1;\n  return 0;\n}"},{"name":"fnCheckPouchDB","type":"scripting","item-type":"function","_auto_id_":"71df4799-2793-4010-b089-e3f85bca9bc1","sync":true,"params":[{"name":"pouchDB"}],"content":"// Load Spinner\ncti.fnOpenSpinner('Loading Stock Codes...');\n\nwindow.appManager.loadFromDatabase(pouchDB, function (doc) {\n  return true;\n  cti.fnCloseSpinner();\n}, function (reason, err) {\n  cti.fnCloseSpinner();\n  return false;\n});"},{"name":"app_sorpouchfailed","type":"notification","item-type":"app-notification","_auto_id_":"1adfa13d-c0c4-44a5-8b6a-479ccf2fe977","options":{"autoDismiss":true,"closeButton":true},"style":"warning"},{"name":"app_followon","type":"notification","item-type":"app-notification","_auto_id_":"8f038df4-7d44-4283-8f32-e1b2ca4e5b7b","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"fnSendEventStatus","type":"scripting","item-type":"function","_auto_id_":"a691c07c-739a-4fe4-9298-a27385f5d820","sync":true,"params":[{"name":"statusCode"}],"content":"var job = cti.store.jobs.selectedJob;\n\nvar statusObj = {\n  \"sStatus\": statusCode,\n  \"aJobID\" : job.aAccuServJobID,\n  \"dtStatusDT\" : moment().format()\n};\n\ncti.store.payloads.eventStatusPayload = statusObj;\ncti.store.jobs.eventStatusLimit = 10;\n\ncti.utils.callAction('call-actionflow', { \"name\": \"SendEventStatus\" });"},{"name":"fnLoadCamera","type":"scripting","item-type":"function","_auto_id_":"4fffdb44-786f-4873-a632-4a31f032dc35","sync":true,"params":[{"name":"page"},{"name":"componentInstanceId"}],"content":"if(!cti.store.variables.fromPhotoDetail) {\n  cti.utils.callAction(\"call-component-function\", { \n    \"page\" : page,\n    \"componentInstanceId\": componentInstanceId,\n    \"function\":\"takePhoto\"\n  });\n}","actions":[]},{"name":"fnCalcSMVChange","type":"scripting","item-type":"function","_auto_id_":"22217351-c405-4578-a122-c77ae36d1f21","sync":true,"params":[{"name":"sorMins","description":"Expected duration of job in mins from the SORs"}],"content":"if(cti.store.variables.estimatedOverride) {\n  if(cti.store.jobs.selectedJob.bJobStartWork) {\n    cti.store.variables.jobCollectionType = \"updatevisit\";\n    cti.store.jobs.selectedJob.sExpected_Duration = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n\n    cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n  }\n} else {\n  cti.store.jobs.selectedJob.sExpected_Duration = sorMins\n\n  if(cti.store.jobs.selectedJob.bJobStartWork) {\n    if(cti.store.jobs.expectedDurationData != undefined) {\n      if(cti.store.jobs.expectedDurationData.tPairs != undefined) {\n        if(cti.store.jobs.expectedDurationData.tPairs.asValues != undefined) {\n          var lastTimeSent = cti.store.jobs.expectedDurationData.tPairs.asValues[0];\n          var latestTime = sorMins;\n\n          if(lastTimeSent != latestTime) {\n            cti.store.variables.jobCollectionType = \"updatevisit\";\n            cti.store.jobs.selectedJob.sExpected_Duration = latestTime;\n            cti.store.jobs.selectedJob.originalEstimatedValue = latestTime;\n\n            cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n          }\n        }\n      }\n    }\n  }\n}","actions":[]},{"name":"app_costbanding_a","type":"notification","item-type":"app-notification","_auto_id_":"965c4602-d7bf-49ad-b0da-342b01691860","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"app_costbanding_b","type":"notification","item-type":"app-notification","_auto_id_":"da150eb2-5054-4d8b-8f30-6b5d75978a55","options":{"autoDismiss":false,"closeButton":false},"style":"warning","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnPhoneCall('manager');"},"_auto_id_":"3b99f472-cf7f-4a9c-8d35-a16fd1564355","actions":[]}]},{"name":"app_costbanding_c","type":"notification","item-type":"app-notification","_auto_id_":"8f25e952-b6ba-49df-a61e-b9f127b1dd28","options":{"autoDismiss":false,"closeButton":true},"style":"error","actions":[]},{"name":"app_nopreviousjob","type":"notification","item-type":"app-notification","_auto_id_":"eef435fe-a317-42c5-9fcc-dcc20f5436cc","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnSORAlgorithms","type":"scripting","item-type":"function","_auto_id_":"f5f03553-6977-4f20-90be-9cf8f4b4818a","sync":true,"params":[{"name":"startingWork","description":"Boolean to check if we are calculating the SMV from the Start Work page"},{"name":"minusQty","description":"Whether we are removing a quanitity value from the job cost"}],"content":"function fnCalcEstimatedTime(sors) {\n  var estimated = 0;\n\n  if(sors.length > 0) {\n    for(var i in sors) {\n      var sor = sors[i];\n      var timeSpentOnCode = parseInt(sor.nQtyDoneThisVisit * sor.nSMVs);\n      var timeToSpendOnCode = parseInt(sor.nQtyRemaining * sor.nSMVs);\n\n      estimated += timeSpentOnCode + timeToSpendOnCode;\n    }\n  }\n\n  if(estimated === 0) {\n    if(cti.store.jobs.selectedJob.bJobStartWork) {\n      estimated = cti.store.jobs.expectedDurationData.tPairs.asValues[0];\n    } else {\n      estimated = cti.store.jobs.selectedJob.sExpected_Duration;\n    }\n  }\n\n  return estimated.toString();\n}\n\nfunction fnCalcCostBanding(jobCost, notifications) {\n  var variations = cti.store.jobs.selectedJob.aJobVariationBands;\n  var sBandName;\n  var sBandOverLimitAction;\n  var bandALower;\n  var bandAUpper;\n  var bandAHeader;\n  var bandAAction;\n  \n  var bandBLower;\n  var bandBUpper;\n  var bandBHeader;\n  var bandBAction;\n  \n  var bandCLower;\n  var bandCUpper;\n  var bandCHeader;\n  var bandCAction;\n\n  for(var i in variations) {\n    var thisVariation = variations[i];\n\n    if(thisVariation.sBandName == \"Band A\") {\n      bandALower = thisVariation.nBandLowerLimit;\n      bandAUpper = thisVariation.nBandUpperLimit;\n      bandAHeader = thisVariation.sBandName;\n      bandAAction = thisVariation.sBandOverLimitAction;\n    } else if(thisVariation.sBandName == \"Band B\") {\n      bandBLower = thisVariation.nBandLowerLimit;\n      bandBUpper = thisVariation.nBandUpperLimit;\n      bandBHeader = thisVariation.sBandName;\n      bandBAction = thisVariation.sBandOverLimitAction;\n    } else if(thisVariation.sBandName == \"Band C\") {\n      bandCLower = thisVariation.nBandLowerLimit;\n      bandCUpper = thisVariation.nBandUpperLimit;\n      bandCHeader = thisVariation.sBandName;\n      bandCAction = thisVariation.sBandOverLimitAction;\n    }\n  }\n\n  if(bandALower == undefined) bandALower = 0;\n  if(bandAUpper == undefined) bandAUpper = 200;\n  if(bandAHeader == undefined) bandAHeader = \"Band A\";\n  if(bandAAction == undefined) bandAAction = \"Progress with Job\";\n  if(bandBLower == undefined) bandBLower = 200.01;\n  if(bandBUpper == undefined) bandBUpper = 500;\n  if(bandBHeader == undefined) bandBHeader = \"Band B\";\n  if(bandBAction == undefined) bandBAction = \"Contact Supervisor\";\n  if(bandCLower == undefined) bandCLower = 500;\n  if(bandCUpper == undefined) bandCUpper = 50000;\n  if(bandCHeader == undefined) bandCHeader = \"Band C\";\n  if(bandCAction == undefined) bandCAction = \"Stop Work\";\n\n  var exceededBand = false;\n\n  if(jobCost <= bandAUpper) {\n    var title = bandAHeader + ': ' + bandAAction;\n    var text = \"You are within Band A. Cost Variation Bands for Band A are between \" + bandALower + \" and \" + bandAUpper + \".\\n\\nCurrent Cost on Job: \" + jobCost + \".\\n\\nYou may progress through the job as standard.\";\n\n    if(notifications) {\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\" : \"app_costbanding_a\",\n          \"item-type\" : \"app-notification\",\n          \"style\" : \"success\",\n          \"title\" : title,\n          \"text\" : text\n        }\n      );\n    }\n  } else if(jobCost > bandBLower && jobCost <= bandBUpper) {\n    var title = bandBHeader + ': ' + bandBAction;\n    var text = \"You are within Band B. Cost Variation Bands for Band B are between \" + bandBLower + \" and \" + bandBUpper + \".\\n\\nCurrent Cost on Job: \" + jobCost + \".\\n\\nPlease contact your supervisor before progressing through the job.\";\n\n    if(notifications) {\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\" : \"app_costbanding_b\",\n          \"item-type\" : \"app-notification\",\n          \"style\" : \"warning\",\n          \"title\" : title,\n          \"text\" : text\n        }\n      );\n    }\n  } else if(jobCost > bandCLower) {\n    exceededBand = true;\n    var title = bandCHeader + ': ' + bandCAction;\n    var text = \"You are within Band C. Cost Variation Bands for Band C are above \" + bandCLower + \".\\n\\nCurrent Cost on Job: \" + jobCost + \".\\n\\nYou may progress through the job, but further addition of SOR Codes or quantity increases to current SOR Codes will now be restricted. Please discuss with Tenant and contact supervisor if required.\";\n\n    if(notifications) {\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\" : \"app_costbanding_c\",\n          \"item-type\" : \"app-notification\",\n          \"style\" : \"Error\",\n          \"title\" : title,\n          \"text\" : text\n        }\n      );\n    }\n  }\n\n  return exceededBand;\n}\n\nif(startingWork === undefined) { startingWork = false; }\nif(minusQty === undefined) { minusQty = false; }\n  \nif(cti.store.variables.estimatedOverride === false || cti.store.variables.estimatedOverride === undefined) {\n  var sorMins = fnCalcEstimatedTime(cti.store.jobs.selectedJob.aItemGroups);\n  cti.fnCalcSMVChange(sorMins);\n}\n\nif(minusQty) {\n  var minusJobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\n  cti.store.jobs.selectedJob.sPreviousJobCost = minusJobCost;\n} else {\n  var exceededBand = undefined;\n  var costChange = false;\n  var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\n\n  if(cti.store.variables.firstCostCalculation) {\n    exceededBand = fnCalcCostBanding(jobCost, startingWork);\n    delete cti.store.variables.firstCostCalculation;\n  } else {\n    if(cti.store.jobs.selectedJob.sPreviousJobCost != jobCost) {\n      cti.store.jobs.selectedJob.sPreviousJobCost = jobCost;\n    }\n\n    exceededBand = fnCalcCostBanding(jobCost, startingWork);\n  }\n\n  return exceededBand;\n}","actions":[]},{"name":"fnCalcJobCost","type":"scripting","item-type":"function","_auto_id_":"187500f9-9cca-4df9-9c22-0904fbb7f6a9","sync":true,"params":[{"name":"sors","description":"SORs on job"}],"content":"var jobCost = 0;\n\nfor(var i in sors) {\n  var sor = sors[i];\n  var jobCostOnCode = (parseFloat(sor.nSellPrice).toFixed(2) * sor.nQtyDoneThisVisit);\n  var jobCostToSpendOnCode = (parseFloat(sor.nSellPrice).toFixed(2) * sor.nQtyRemaining);\n  var thisSorCost = jobCostOnCode + jobCostToSpendOnCode;\n\n  jobCost += thisSorCost;\n}\n\njobCost = jobCost.toFixed(2);\n\nif(cti.store.jobs.selectedJob.sPreviousJobCost === undefined) {\n  cti.store.variables.firstCostCalculation = true;\n  cti.store.jobs.selectedJob.sPreviousJobCost = jobCost;\n}\n\nreturn jobCost;","actions":[]}],"components":[{"name":"ContextMenu","description":"","icon":"fa-puzzle-piece","_auto_id_":"563920b3-2105-4832-b9a0-4895c1d36eef","tagName":"context-menu","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"title","description":"An optional panel title","type":"string","enum":null,"required":false}],"functions":[{"name":"open","description":"Open the context menu","params":[],"returnType":"void","returnEnum":null},{"name":"close","description":"Close the context menu","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ContextMenu.js","transpiled":"ContextMenu.output.js"}},{"name":"ActivitySpinner","description":"","icon":"fa-puzzle-piece","_auto_id_":"be524bf2-bd4c-4d6c-9ca3-f656a2016e8d","tagName":"load-spinner","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"message","description":"A message to display whilst the spinner is showing","type":"string","enum":null,"required":false}],"functions":[{"name":"show","description":"Invoke the spinner","params":[],"returnType":"void","returnEnum":null},{"name":"close","description":"Remove/hide the spinner","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ActivitySpinner.js","transpiled":"ActivitySpinner.output.js"}},{"name":"ListSearcher","description":"Custom search control for lists","icon":"fa-puzzle-piece","_auto_id_":"9f86f925-f353-4618-9cda-68d2d9d1c109","tagName":"list-searcher","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"minCharacters","description":"Min number of characters to be entered before it will auto-search ahead","type":"number","enum":null,"required":false},{"name":"maxResults","description":"Maximum number of results to output (defaults to 30)","type":"number","enum":null,"required":false},{"name":"displayListIfNoSearch","description":"Governs display of results if a search is not active default to 0","type":"number","enum":["0","1"],"required":true},{"name":"sourceObjectArrayName","description":"Name of the source object array you want to search (eg. cti.model.customerList)","type":"string","enum":null,"required":true},{"name":"displayArrayName","description":"Name of the array to populate with search results, which you should then bind to a list (eg. cti.model.mySearchResults)","type":"string","enum":null,"required":true}],"events":[{"name":"searchComplete","description":"Fired when a search has finished actioning","type":"void","enum":null}]},"userConfig":{},"valid":true,"files":{"original":"ListSearcher.js","transpiled":"ListSearcher.output.js"}},{"name":"PhotoManager","description":"Manage photos, capture, delete, store and display","icon":"fa-puzzle-piece","_auto_id_":"f509b6fb-7881-4012-8019-6a75ad689441","tagName":"photo-manager","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"captureWidth","description":"Width restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureHeight","description":"Height restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureQuality","description":"QUality setting for captured photos","type":"number","enum":["50","75","90","100"],"required":false},{"name":"captureCategory","description":"Optional category identifier to assign to photos when captured.","type":"string","enum":null,"required":false},{"name":"displayCategory","description":"Optional category on which to filter display of photos","type":"string","enum":null,"required":false},{"name":"maxPhotos","description":"Maximum number of photos that can be captured in this category (default is 3)","type":"number","enum":null,"required":false}],"events":[{"name":"captureComplete","description":"Fired when a photo has been captured","type":"void","enum":null},{"name":"editPhoto","description":"Fired when user selects edit option","type":"void","enum":null},{"name":"maxPhotosTaken","description":"Fired when we have taken the maximum number of photos in this category","type":"void","enum":null}],"functions":[{"name":"takePhoto","description":"Take a photo","params":[{"name":"filename","description":"A filename to allocate to the capture photo","type":"string","enum":null,"required":false}],"returnType":"void","returnEnum":null},{"name":"deletePhoto","description":"Delete a photo","params":[{"name":"id","description":"The internal id of the photo to remove","type":"string","enum":null,"required":true}],"returnType":"void","returnEnum":null},{"name":"clearPhotos","description":"Clear photos","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"PhotoManager.js","transpiled":"PhotoManager.output.js"}},{"name":"SORSearcher","description":"","icon":"fa-puzzle-piece","_auto_id_":"c3341eb8-461e-4b21-89e2-0a4547054eea","tagName":"sor-searcher","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"minCharacters","description":"Min number of characters to be entered before it will auto-search ahead","type":"number","enum":null,"required":false},{"name":"maxResults","description":"Maximum number of results to output (defaults to 30)","type":"number","enum":null,"required":false},{"name":"displayListIfNoSearch","description":"Governs display of results if a search is not active default to 0","type":"number","enum":["0","1"],"required":true},{"name":"sourceObjectArrayName","description":"Name of the source object array you want to search (eg. cti.model.customerList). If not specified, sordata in pouchdb will be used as the source","type":"string","enum":null,"required":false},{"name":"displayArrayName","description":"Name of the array to populate with search results, which you should then bind to a list (eg. cti.model.mySearchResults)","type":"string","enum":null,"required":true},{"name":"locationFilter","description":"Location id filter by which to restrict result selection (empty value will be unfiltered)","type":"string","enum":null,"required":false},{"name":"pouchDB","description":"Select your pouch DB instance","type":"string","enum":null,"required":false}],"events":[{"name":"searchComplete","description":"Fired when a search has finished actioning","type":"void","enum":null}],"functions":[{"name":"bind","description":"Re-bind location filtered SOR codes to the model","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"SORSearcher.js","transpiled":"SORSearcher.output.js"}},{"name":"NumericToggler","description":"","icon":"fa-puzzle-piece","_auto_id_":"6df3a13a-c7f9-49bc-a662-f85a25875bf1","tagName":"numeric-toggler","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"initialQuantity","description":"Starting quantity value","type":"number","enum":null,"required":false},{"name":"canIncrement","description":"Are we able to increment the value","type":"boolean","enum":null,"required":false},{"name":"canDecrement","description":"Are we able to decrement the value","type":"boolean","enum":null,"required":false}],"events":[{"name":"changed","description":"Fired when held value changes","type":"void","enum":null}],"properties":[{"name":"quantity","getter":true,"setter":true,"modelConfig":{"store":false,"changeEvents":[]},"getterDescription":"Get the current quantity","returnType":"number","returnEnum":null,"setterDescription":"Set the quantity","valueType":"number","valueEnum":null},{"name":"canDecrement","getter":true,"setter":true,"modelConfig":{"store":false,"changeEvents":[]},"getterDescription":"Is the user allowed to dec the value?","returnType":"boolean","returnEnum":null,"setterDescription":"Set if the user is allowed to dec the value","valueType":"boolean","valueEnum":null},{"name":"canIncrement","getter":true,"setter":true,"modelConfig":{"store":false,"changeEvents":[]},"getterDescription":"Is the user allowed to inc the value?","returnType":"boolean","returnEnum":null,"setterDescription":"Set if the user is allowed to inc the value","valueType":"boolean","valueEnum":null}],"functions":[{"name":"decrement","description":"Decrement the value in the control","params":[],"returnType":"void","returnEnum":null},{"name":"increment","description":"Increment the current value","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{"properties":{"quantity":{"modelConfig":{"store":false,"changeEvents":[]}},"canDecrement":{"modelConfig":{"store":false,"changeEvents":[]}},"canIncrement":{"modelConfig":{"store":false,"changeEvents":[]}}}},"valid":true,"files":{"original":"NumericToggler.js","transpiled":"NumericToggler.output.js"}}],"icondata":"logo.png","lastSchemaUpgradeDate":"2017-04-20 07:25:24","jwt":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBfaWQiOiJlNTMxZGRlNi1hNDY3LTQ4ODItYTNkMS05NWM0YzU0ZjBhMWYiLCJhcHBfbmFtZSI6IkFjY3VTZXJ2X3YxMDJfTGl2ZSIsImJ1aWxkX2lkIjoiODhmMjI1ZmItZTUzMi00MTU2LWJlNDEtYjkwM2NlN2JmYWU5IiwiY2xpZW50X2lkIjoiYjM3ODUyNzEtN2U3ZS00ZTg4LTk1YmMtMjFiZjM0MWY2ZjNlIiwiY2xpZW50X3NlY3JldCI6ImVIWXhWMnRHVlhkNUsxaHFkQ3RqWlZrM2JtdFFkejA5IiwiZXhwIjoxNTM3MTQyNDAwLCJmcmVxdWVuY3kiOjIxNjAwMDAwMCwiaGFzaCI6ImE2MmM0YWE0Yjg3ZGM4NjE4ZDEwMDU1MTk4YjU2ZmI3MmMxZjRjZThmMGI0NDI3YjYzZWE5OTc1ZmFmYTk4MDUiLCJsaWNfZXhwIjoxNTM0NTUwNDAwLCJscF9pZCI6IjFlODIzNTc0LWUyNzAtNDAxZS1hNGYzLTc4ZDdmMzY5MGQyMyIsInBhY2thZ2VfaWQiOiJjb20uaW50ZXJuZXRhbGlhLmFjY3VzZXJ2LnloZ2xpdmUiLCJyZWZyZXNoX3Rva2VuIjoiYURCQlZHVjFXa2RtYkdSaVZFbFNSak4zY0hKRmVGTTFZVEpqZVdKd1NGaE1OMHRuT0ZSV05UbHdkejA9IiwidHlwZSI6ImZ1bGwiLCJpYXQiOjE1MjEwMjQ0Nzh9.Mtx4BhW87sJxuSxuO1ODHQBwXImlmvQHuN51WqvjRH_biTZJQqQnTwrCa38BzFy7JCsirnxY1jD4mdcSYMqLSa8fLm2GEvHenPXykO5hdGAMA0CHDa0bIDwPWybaz8wsY4bp9VvcS5nl-jO-BsNLddr3pjDBQe794DEdm0QeRjg2PG8NuZGhk83GyNR8ewUPdZbfhIOR8FFSQmEGTcbr6OqujBVbAF4mma_WMD3irictHFJNfigeWDpTO8HC4sHey_ilEHfHLr4Fd-TC6zh15qB0X3xZS9c1BASatWkteoVb0USLLh7UNMVcc4h67FM9ZIv-x1c5BEz9pCx3YHXnwA","buildId":"88f225fb-e532-4156-be41-b903ce7bfae9","hostContext":0}